# M12-ç¸½ç¶“èˆ‡ç”¢æ¥­åˆ†ææ¨¡çµ„æ•ˆèƒ½è€ƒé‡

> **æ–‡ä»¶ç·¨è™Ÿ**: PERF-M12
> **æ¨¡çµ„åç¨±**: ç¸½ç¶“èˆ‡ç”¢æ¥­åˆ†ææ¨¡çµ„
> **ç‰ˆæœ¬**: v1.0
> **æœ€å¾Œæ›´æ–°**: 2026-01-14
> **ç‹€æ…‹**: Draft

---

## 1. æ•ˆèƒ½ç›®æ¨™

| æŒ‡æ¨™ | ç›®æ¨™å€¼ | æ¸¬é‡æ–¹å¼ | èªªæ˜ |
|-----|-------|---------|------|
| ç”¢æ¥­ç¸¾æ•ˆæŸ¥è©¢ | P95 < 50ms | APM ç›£æ§ | å–®ä¸€ç”¢æ¥­ç¸¾æ•ˆ |
| ç”¢æ¥­ç¸½è¦½æŸ¥è©¢ | P95 < 100ms | APM ç›£æ§ | æ‰€æœ‰ç”¢æ¥­ç¸¾æ•ˆ |
| ç”¢æ¥­æ’è¡Œæ¦œæŸ¥è©¢ | P95 < 80ms | APM ç›£æ§ | Top N æ’å |
| ç¸½ç¶“æŒ‡æ¨™æŸ¥è©¢ | P95 < 30ms | APM ç›£æ§ | å–®ä¸€æŒ‡æ¨™æ­·å² |
| ç¶“æ¿Ÿé€±æœŸæŸ¥è©¢ | P95 < 20ms | APM ç›£æ§ | ç•¶å‰é€±æœŸåˆ¤æ–· |
| è¼ªå‹•åˆ†ææŸ¥è©¢ | P95 < 150ms | APM ç›£æ§ | å®Œæ•´è¼ªå‹•å ±å‘Š |
| æ¯æ—¥ç¸¾æ•ˆè¨ˆç®— | < 5 åˆ†é˜ | Job åŸ·è¡Œè¨˜éŒ„ | 30 å€‹ç”¢æ¥­ |
| æ¯é€±è¼ªå‹•åˆ†æ | < 3 åˆ†é˜ | Job åŸ·è¡Œè¨˜éŒ„ | 12 é€±åˆ†æ |
| å¿«å–å‘½ä¸­ç‡ | > 80% | Redis çµ±è¨ˆ | ç†±é–€æŸ¥è©¢ |
| è³‡æ–™åº«æŸ¥è©¢æ™‚é–“ | < 30ms | æ…¢æŸ¥è©¢æ—¥èªŒ | å–®è¡¨æŸ¥è©¢ |

---

## 2. æ•ˆèƒ½å„ªåŒ–ç­–ç•¥

### 2.1 ç”¢æ¥­ç¸¾æ•ˆè¨ˆç®—å„ªåŒ–

**æ‰¹æ¬¡è¨ˆç®—æ¶æ§‹**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¢æ¥­ç¸¾æ•ˆæ‰¹æ¬¡è¨ˆç®—æ¶æ§‹                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ç”¢æ¥­æ¸…å–®       â”‚
                    â”‚ (30 å€‹ç”¢æ¥­)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  æ‰¹æ¬¡è¼‰å…¥è‚¡åƒ¹    â”‚ â† ä¸€æ¬¡è¼‰å…¥æ‰€æœ‰è‚¡ç¥¨
                    â”‚ (ç´„ 2000 æª”)    â”‚     é¿å… N+1 æŸ¥è©¢
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ä¾ç”¢æ¥­åˆ†çµ„     â”‚
                    â”‚ (è¨˜æ†¶é«”ä¸­å®Œæˆ)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Thread 1   â”‚ â”‚  Thread 2   â”‚ â”‚  Thread N   â”‚
    â”‚  ç”¢æ¥­ 1-10  â”‚ â”‚  ç”¢æ¥­ 11-20 â”‚ â”‚  ç”¢æ¥­ 21-30 â”‚
    â”‚             â”‚ â”‚             â”‚ â”‚             â”‚
    â”‚ - è¨ˆç®—å ±é…¬  â”‚ â”‚ - è¨ˆç®—å ±é…¬  â”‚ â”‚ - è¨ˆç®—å ±é…¬  â”‚
    â”‚ - è¨ˆç®—å‹•èƒ½  â”‚ â”‚ - è¨ˆç®—å‹•èƒ½  â”‚ â”‚ - è¨ˆç®—å‹•èƒ½  â”‚
    â”‚ - è¨ˆç®—å»£åº¦  â”‚ â”‚ - è¨ˆç®—å»£åº¦  â”‚ â”‚ - è¨ˆç®—å»£åº¦  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚               â”‚               â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  æ‰¹æ¬¡å¯«å…¥çµæœ   â”‚
                    â”‚ (JPA saveAll)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŸ·è¡Œç·’æ± é…ç½®**:
```java
@Configuration
public class IndustryAnalysisConfig {

    @Bean("sectorCalculationExecutor")
    public ThreadPoolTaskExecutor sectorCalculationExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(4);           // CPU æ ¸å¿ƒæ•¸
        executor.setMaxPoolSize(8);            // æœ€å¤§åŸ·è¡Œç·’æ•¸
        executor.setQueueCapacity(50);         // ä»»å‹™ä½‡åˆ—
        executor.setKeepAliveSeconds(60);
        executor.setThreadNamePrefix("sector-calc-");
        executor.setRejectedExecutionHandler(new CallerRunsPolicy());
        return executor;
    }
}
```

**è‚¡åƒ¹è³‡æ–™é è¼‰å…¥**:
```java
// ä¸€æ¬¡è¼‰å…¥æ‰€æœ‰éœ€è¦çš„è‚¡åƒ¹è³‡æ–™ï¼Œé¿å… N+1 æŸ¥è©¢
public Map<String, List<StockPriceData>> preloadStockPrices(LocalDate tradeDate, int days) {
    List<StockPriceData> allPrices = stockPriceRepository
        .findByTradeDateBetween(tradeDate.minusDays(days), tradeDate);

    return allPrices.stream()
        .collect(Collectors.groupingBy(StockPriceData::getStockId));
}
```

---

### 2.2 è³‡æ–™åº«å„ªåŒ–

**ç´¢å¼•ç­–ç•¥**:

| è¡¨å | ç´¢å¼• | æŸ¥è©¢å ´æ™¯ |
|-----|------|---------|
| sector_performance | (sector_code, trade_date DESC) | å–®ç”¢æ¥­ç¸¾æ•ˆæ­·å² |
| sector_performance | (trade_date, return_rank) | æ’è¡Œæ¦œæŸ¥è©¢ |
| sector_performance | (trade_date, momentum_rank) | å‹•èƒ½æ’è¡Œ |
| sector_valuation | (sector_code, trade_date DESC) | ä¼°å€¼æ­·å² |
| sector_valuation | (trade_date, valuation_signal) | ä¼°å€¼ç•°å¸¸ç¯©é¸ |
| macro_indicator_values | (indicator_code, value_date DESC) | æŒ‡æ¨™æ­·å² |
| industry_signals | (signal_date, is_consumed) | M13 æ¶ˆè²»æŸ¥è©¢ |
| stock_classifications | (stock_id) WHERE end_date IS NULL | æœ‰æ•ˆåˆ†é¡ |

**æŸ¥è©¢å„ªåŒ–**:
```sql
-- ç”¢æ¥­ç¸¾æ•ˆæŸ¥è©¢ï¼šä½¿ç”¨è¦†è“‹ç´¢å¼•
CREATE INDEX idx_sector_perf_covering
ON sector_performance (sector_code, trade_date DESC)
INCLUDE (return_1d, return_5d, return_20d, momentum_20d, relative_strength);

-- æ’è¡Œæ¦œæŸ¥è©¢ï¼šç›´æ¥å¾ç´¢å¼•å–å¾—
SELECT sector_code, return_20d, return_rank
FROM sector_performance
WHERE trade_date = '2024-12-24'
ORDER BY return_rank
LIMIT 10;
```

**æ‰¹æ¬¡å¯«å…¥å„ªåŒ–**:
```java
@Repository
public interface SectorPerformanceRepository extends JpaRepository<SectorPerformance, Long> {

    // ä½¿ç”¨ @Modifying + åŸç”Ÿ SQL é€²è¡Œæ‰¹æ¬¡ UPSERT
    @Modifying
    @Query(value = """
        INSERT INTO sector_performance (sector_code, trade_date, return_1d, return_5d, ...)
        VALUES (:sectorCode, :tradeDate, :return1d, :return5d, ...)
        ON CONFLICT (sector_code, trade_date) DO UPDATE SET
            return_1d = EXCLUDED.return_1d,
            return_5d = EXCLUDED.return_5d,
            ...
        """, nativeQuery = true)
    void upsertPerformance(@Param("sectorCode") String sectorCode, ...);
}
```

**é€£ç·šæ± é…ç½®**:
```yaml
spring:
  datasource:
    hikari:
      minimum-idle: 5
      maximum-pool-size: 20
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
```

---

### 2.3 å¿«å–å„ªåŒ–

**å¤šå±¤å¿«å–æ¶æ§‹**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å¿«å–å±¤ç´š                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è«‹æ±‚
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  L1: æœ¬åœ°å¿«å–        â”‚ â† Caffeine Cache
â”‚  TTL: 5 åˆ†é˜        â”‚     ç”¢æ¥­å®šç¾©ã€ç•¶æ—¥ç¸¾æ•ˆ
â”‚  Size: 200 entries  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚ æœªå‘½ä¸­
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  L2: Redis å¿«å–     â”‚ â† åˆ†æ•£å¼å¿«å–
â”‚  TTL: 1-24 å°æ™‚     â”‚     ç¸¾æ•ˆæ­·å²ã€æ’è¡Œæ¦œã€è¼ªå‹•åˆ†æ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚ æœªå‘½ä¸­
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  L3: PostgreSQL     â”‚ â† æŒä¹…åŒ–å„²å­˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Redis å¿«å– Key è¨­è¨ˆ**:

| å¿«å–é¡å‹ | Key Pattern | TTL | èªªæ˜ |
|---------|-------------|-----|------|
| ç”¢æ¥­ç¸¾æ•ˆ | `m12:perf:{sectorCode}:{date}` | 6 å°æ™‚ | å–®ç”¢æ¥­ç•¶æ—¥ |
| ç¸¾æ•ˆç¸½è¦½ | `m12:perf:all:{date}` | 30 åˆ†é˜ | æ‰€æœ‰ç”¢æ¥­ |
| æ’è¡Œæ¦œ | `m12:rank:{type}:{date}` | 30 åˆ†é˜ | å„é¡æ’å |
| ç”¢æ¥­ä¼°å€¼ | `m12:val:{sectorCode}:{date}` | 6 å°æ™‚ | ä¼°å€¼è³‡æ–™ |
| è¼ªå‹•åˆ†æ | `m12:rotation:{date}` | 1 å°æ™‚ | é€±åº¦åˆ†æ |
| ç¶“æ¿Ÿé€±æœŸ | `m12:cycle:current` | 24 å°æ™‚ | ç•¶å‰é€±æœŸ |
| ç¸½ç¶“æŒ‡æ¨™ | `m12:macro:{code}` | 1 å°æ™‚ | æŒ‡æ¨™æ­·å² |

**å¿«å–é…ç½®**:
```java
@Configuration
@EnableCaching
public class CacheConfig {

    @Bean
    public CacheManager cacheManager(RedisConnectionFactory connectionFactory) {
        RedisCacheConfiguration defaultConfig = RedisCacheConfiguration.defaultCacheConfig()
            .entryTtl(Duration.ofMinutes(30))
            .serializeKeysWith(RedisSerializationContext.SerializationPair
                .fromSerializer(new StringRedisSerializer()))
            .serializeValuesWith(RedisSerializationContext.SerializationPair
                .fromSerializer(new GenericJackson2JsonRedisSerializer()));

        Map<String, RedisCacheConfiguration> cacheConfigs = Map.of(
            "sectorPerformance", defaultConfig.entryTtl(Duration.ofHours(6)),
            "sectorRanking", defaultConfig.entryTtl(Duration.ofMinutes(30)),
            "economicCycle", defaultConfig.entryTtl(Duration.ofHours(24)),
            "rotationAnalysis", defaultConfig.entryTtl(Duration.ofHours(1))
        );

        return RedisCacheManager.builder(connectionFactory)
            .cacheDefaults(defaultConfig)
            .withInitialCacheConfigurations(cacheConfigs)
            .build();
    }
}
```

**å¿«å–é ç†±**:
```java
@Component
public class IndustryCacheWarmer implements ApplicationRunner {

    @Override
    public void run(ApplicationArguments args) {
        LocalDate latestDate = tradingCalendarService.getLatestTradingDay();

        // 1. é è¼‰æ‰€æœ‰ç”¢æ¥­ç•¶æ—¥ç¸¾æ•ˆ
        sectorPerformanceService.getAllPerformance(latestDate);

        // 2. é è¼‰å„é¡æ’è¡Œæ¦œ
        for (RankingType type : RankingType.values()) {
            rankingService.getRanking(type, latestDate, 10);
        }

        // 3. é è¼‰ç¶“æ¿Ÿé€±æœŸ
        cycleService.getCurrentCycle();

        // 4. é è¼‰è¼ªå‹•åˆ†æ
        rotationService.getLatestAnalysis();
    }
}
```

**å¿«å–é˜²è­·ç­–ç•¥**:

| å•é¡Œ | è§£æ±ºæ–¹æ¡ˆ |
|-----|---------|
| å¿«å–ç©¿é€ | ç©ºå€¼å¿«å–ï¼ˆTTL 5åˆ†é˜ï¼‰ |
| å¿«å–é›ªå´© | TTL éš¨æ©ŸåŒ–ï¼ˆÂ±10%ï¼‰ |
| å¿«å–æ“Šç©¿ | äº’æ–¥é–ï¼ˆRedissonï¼‰ |
| è³‡æ–™ä¸€è‡´ | Job å®Œæˆå¾Œä¸»å‹•åˆ·æ–°å¿«å– |

---

### 2.4 è¼ªå‹•åˆ†æå„ªåŒ–

**è³‡æ–™é è™•ç†**:
```java
// é€±åº¦ç¸¾æ•ˆè³‡æ–™é è¨ˆç®—ä¸¦å„²å­˜
// é¿å…è¼ªå‹•åˆ†ææ™‚é‡è¤‡è¨ˆç®—

@Scheduled(cron = "0 0 18 * * FRI")  // æ¯é€±äº” 18:00
public void precomputeWeeklyPerformance() {
    LocalDate fridayDate = LocalDate.now();
    List<SectorPerformance> weeklyData = calculateWeeklyAggregates(fridayDate);

    // å„²å­˜åˆ°å¿«å–ï¼Œä¾›è¼ªå‹•åˆ†æä½¿ç”¨
    String cacheKey = "m12:weekly:" + fridayDate;
    redisTemplate.opsForValue().set(cacheKey, weeklyData, Duration.ofDays(14));
}
```

**è¼ªå‹•åˆ†æå¿«å–**:
```java
@Cacheable(value = "rotationAnalysis", key = "#analysisDate")
public RotationAnalysisResult analyzeRotation(LocalDate analysisDate, int weeks) {
    // å¾å¿«å–å–å¾—é€±åº¦è³‡æ–™
    List<WeeklyPerformance> weeklyData = getWeeklyDataFromCache(analysisDate, weeks);

    // åŸ·è¡Œè¼ªå‹•åˆ†æ
    return doAnalyzeRotation(weeklyData);
}
```

---

## 3. å®¹é‡è¦åŠƒ

### 3.1 è³‡æ–™é‡ä¼°ç®—

**sector_performance è¡¨**:
```
æ¯æ—¥æ–°å¢: 30 å€‹ç”¢æ¥­ Ã— 1 ç­† = 30 ç­†/æ—¥
æ¯å¹´æ–°å¢: 30 Ã— 250 äº¤æ˜“æ—¥ = 7,500 ç­†/å¹´
5 å¹´ç´¯ç©: 37,500 ç­†

å–®ç­†å¤§å°ä¼°ç®—:
- å›ºå®šæ¬„ä½: ~200 bytes
- æ•¸å€¼æ¬„ä½: ~100 bytes
- ç¸½è¨ˆ: ~300 bytes/ç­†

5 å¹´ç¸½å®¹é‡: 37,500 Ã— 300 bytes â‰ˆ 11 MB
å«ç´¢å¼•: ç´„ 30-40 MB
```

**sector_valuation è¡¨**:
```
æ¯æ—¥æ–°å¢: 30 ç­†/æ—¥
æ¯å¹´: 7,500 ç­†/å¹´
5 å¹´: 37,500 ç­†

å–®ç­†å¤§å°: ~250 bytes
5 å¹´ç¸½å®¹é‡: ç´„ 10 MB
å«ç´¢å¼•: ç´„ 25-30 MB
```

**macro_indicator_values è¡¨**:
```
æ¯æ—¥æ–°å¢: ~10 ç­†ï¼ˆæ—¥é »æŒ‡æ¨™ï¼‰
æ¯æœˆæ–°å¢: ~15 ç­†ï¼ˆæœˆé »æŒ‡æ¨™ï¼‰
æ¯å¹´: ~3,000 ç­†

å–®ç­†å¤§å°: ~100 bytes
5 å¹´ç¸½å®¹é‡: ç´„ 1.5 MB
```

**industry_signals è¡¨**:
```
æ¯æ—¥ç”¢ç”Ÿ: ~5-10 ç­†
æ¯å¹´: ~2,000 ç­†
ä¿ç•™ 90 å¤©: ~450 ç­†

å–®ç­†å¤§å°ï¼ˆå« JSONBï¼‰: ~500 bytes
ç¸½å®¹é‡: < 1 MB
```

### 3.2 Redis è¨˜æ†¶é«”ä¼°ç®—

```
å¿«å–é …ç›®:
- ç”¢æ¥­ç¸¾æ•ˆ (30 ç”¢æ¥­): 30 Ã— 1 KB = 30 KB
- æ’è¡Œæ¦œ (8 ç¨®): 8 Ã— 5 KB = 40 KB
- è¼ªå‹•åˆ†æ: 1 Ã— 50 KB = 50 KB
- ç¶“æ¿Ÿé€±æœŸ: 1 Ã— 2 KB = 2 KB
- ç¸½ç¶“æŒ‡æ¨™ (30 å€‹): 30 Ã— 5 KB = 150 KB

ç¸½è¨ˆ:
- å¸¸é§: ç´„ 1-2 MB
- å«æ­·å²å¿«å–: ç´„ 10-20 MB
å»ºè­°åˆ†é…: 50-100 MB
```

### 3.3 ç¡¬é«”éœ€æ±‚

**é–‹ç™¼/æ¸¬è©¦ç’°å¢ƒ**:
- CPU: 2 æ ¸
- RAM: 4 GB
- Disk: 10 GB SSD
- Redis: 128 MB

**ç”Ÿç”¢ç’°å¢ƒï¼ˆå–®æ©Ÿï¼‰**:
- CPU: 4 æ ¸
- RAM: 8 GB
- Disk: 50 GB SSD
- Redis: 512 MB
- PostgreSQL shared_buffers: 2 GB

---

## 4. ç›£æ§æŒ‡æ¨™

| æŒ‡æ¨™é¡å‹ | æŒ‡æ¨™åç¨± | é–¾å€¼ | å‘Šè­¦ç­‰ç´š |
|---------|---------|------|---------|
| API æ•ˆèƒ½ | P95 å›æ‡‰æ™‚é–“ | > 200ms | WARNING |
| API æ•ˆèƒ½ | P99 å›æ‡‰æ™‚é–“ | > 500ms | ERROR |
| è¨ˆç®—æ•ˆèƒ½ | å–®ç”¢æ¥­è¨ˆç®—æ™‚é–“ | > 500ms | WARNING |
| æ‰¹æ¬¡æ•ˆèƒ½ | æ¯æ—¥ Job åŸ·è¡Œæ™‚é•· | > 10 åˆ†é˜ | WARNING |
| æ‰¹æ¬¡æ•ˆèƒ½ | è¼ªå‹•åˆ†ææ™‚é•· | > 5 åˆ†é˜ | WARNING |
| å¿«å– | Redis å‘½ä¸­ç‡ | < 70% | WARNING |
| å¿«å– | Redis è¨˜æ†¶é«”ä½¿ç”¨ç‡ | > 80% | WARNING |
| è³‡æ–™åº« | æ…¢æŸ¥è©¢æ•¸é‡ | > 5/åˆ†é˜ | WARNING |
| è³‡æ–™åº« | é€£ç·šæ± ä½¿ç”¨ç‡ | > 80% | WARNING |
| å¤–éƒ¨ä¾è³´ | M06 è³‡æ–™å»¶é² | > 30 åˆ†é˜ | WARNING |
| å¤–éƒ¨ä¾è³´ | M08 è³‡æ–™å»¶é² | > 30 åˆ†é˜ | WARNING |

---

## 5. æ•ˆèƒ½æ¸¬è©¦å ´æ™¯

| æ¸¬è©¦å ´æ™¯ | é æœŸçµæœ | èªªæ˜ |
|---------|---------|------|
| 100 ä½µç™¼ç”¢æ¥­ç¸¾æ•ˆæŸ¥è©¢ | P95 < 100ms | å–®ç”¢æ¥­æŸ¥è©¢ |
| 100 ä½µç™¼ç¸¾æ•ˆç¸½è¦½æŸ¥è©¢ | P95 < 150ms | æ‰€æœ‰ç”¢æ¥­ |
| 50 ä½µç™¼æ’è¡Œæ¦œæŸ¥è©¢ | P95 < 100ms | å„é¡æ’è¡Œ |
| 50 ä½µç™¼è¼ªå‹•åˆ†ææŸ¥è©¢ | P95 < 200ms | å®Œæ•´å ±å‘Š |
| æ¯æ—¥ç¸¾æ•ˆè¨ˆç®— | < 5 åˆ†é˜ | 30 ç”¢æ¥­ |
| é€±è¼ªå‹•åˆ†æ | < 3 åˆ†é˜ | 12 é€±è³‡æ–™ |
| å¿«å–å¤±æ•ˆå¾ŒæŸ¥è©¢ | P95 < 300ms | å†·å•Ÿå‹• |

---

## 6. æ•ˆèƒ½èª¿å„ªå»ºè­°

### 6.1 JPA èª¿å„ª

```yaml
spring:
  jpa:
    properties:
      hibernate:
        jdbc:
          batch_size: 50
          batch_versioned_data: true
        order_inserts: true
        order_updates: true
```

### 6.2 JVM èª¿å„ª

```bash
# ç”Ÿç”¢ç’°å¢ƒ JVM åƒæ•¸
JAVA_OPTS="-Xms1g -Xmx2g \
  -XX:+UseG1GC \
  -XX:MaxGCPauseMillis=100 \
  -XX:+HeapDumpOnOutOfMemoryError \
  -XX:HeapDumpPath=/var/log/heapdump.hprof"
```

### 6.3 PostgreSQL èª¿å„ª

```sql
-- é‡å° M12 æŸ¥è©¢å„ªåŒ–
SET work_mem = '128MB';           -- æ’åºè¨˜æ†¶é«”
SET effective_cache_size = '4GB'; -- å¯ç”¨å¿«å–
SET random_page_cost = 1.1;       -- SSD å„ªåŒ–
```

---

## ğŸ“š ç›¸é—œæ–‡æª”

- [M12 åŠŸèƒ½éœ€æ±‚](../specs/functional/M12-ç¸½ç¶“ç”¢æ¥­åˆ†æåŠŸèƒ½éœ€æ±‚.md)
- [M12 è³‡æ–™åº«è¨­è¨ˆ](./M12-è³‡æ–™åº«è¨­è¨ˆ.md)
- [M12 Jobæ’ç¨‹é…ç½®](../deployment/M12-Jobæ’ç¨‹é…ç½®.md)
- [NFRéåŠŸèƒ½æ€§éœ€æ±‚](../specs/technical/00-NFRéåŠŸèƒ½æ€§éœ€æ±‚.md)

---

**æ–‡ä»¶ç¶­è­·è€…**: æ•ˆèƒ½å·¥ç¨‹å¸«
**æœ€å¾Œæ›´æ–°**: 2026-01-14
**ä¸‹æ¬¡å¯©æ ¸**: 2026-04-14
