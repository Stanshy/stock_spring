# 00-ç³»çµ±æ¶æ§‹åœ–

> **æ–‡ä»¶ç·¨è™Ÿ**: ARCH-00  
> **æ–‡ä»¶åç¨±**: ç³»çµ±æ¶æ§‹åœ–  
> **ç‰ˆæœ¬**: v2.0  
> **æœ€å¾Œæ›´æ–°**: 2025-12-31  
> **ç‹€æ…‹**: Draft

---

## ğŸ“‘ ç›®éŒ„

1. [ç³»çµ±æ•´é«”æ¶æ§‹](#1-ç³»çµ±æ•´é«”æ¶æ§‹)
2. [åˆ†å±¤æ¶æ§‹](#2-åˆ†å±¤æ¶æ§‹)
3. [æ¨¡çµ„æ¶æ§‹](#3-æ¨¡çµ„æ¶æ§‹)
4. [æŠ€è¡“æ¶æ§‹](#4-æŠ€è¡“æ¶æ§‹)
5. [éƒ¨ç½²æ¶æ§‹](#5-éƒ¨ç½²æ¶æ§‹)
6. [è³‡æ–™æµæ¶æ§‹](#6-è³‡æ–™æµæ¶æ§‹)

---

## 1. ç³»çµ±æ•´é«”æ¶æ§‹

### 1.1 é«˜éšæ¶æ§‹åœ–

```mermaid
graph TB
    subgraph "å¤–éƒ¨ç³»çµ±"
        EXT1[Yahoo Finance API]
        EXT2[è­‰äº¤æ‰€å…¬é–‹è³‡è¨Š]
        EXT3[å…¬é–‹è³‡è¨Šè§€æ¸¬ç«™]
    end
    
    subgraph "ç”¨æˆ¶ç«¯"
        WEB[Web å‰ç«¯]
        MOBILE[è¡Œå‹• App]
        API_CLIENT[API ç”¨æˆ¶ç«¯]
    end
    
    subgraph "æ‡‰ç”¨å±¤"
        GATEWAY[API Gateway]
        AUTH[èªè­‰æœå‹™]
    end
    
    subgraph "æ¥­å‹™å±¤"
        M06[M06 è³‡æ–™ç®¡ç†]
        M07[M07 æŠ€è¡“åˆ†æ]
        M08[M08 åŸºæœ¬é¢åˆ†æ]
        M09[M09 ç±Œç¢¼åˆ†æ]
        M13[M13 ä¿¡è™Ÿåˆ¤æ–·å¼•æ“]
        M14[M14 é¸è‚¡å¼•æ“]
    end
    
    subgraph "è³‡æ–™å±¤"
        PG[(PostgreSQL)]
        REDIS[(Redis)]
        MQ[Message Queue]
    end
    
    EXT1 --> M06
    EXT2 --> M06
    EXT3 --> M06
    
    WEB --> GATEWAY
    MOBILE --> GATEWAY
    API_CLIENT --> GATEWAY
    
    GATEWAY --> AUTH
    GATEWAY --> M06
    GATEWAY --> M07
    GATEWAY --> M08
    
    M06 --> PG
    M06 --> REDIS
    
    M07 --> M06
    M07 --> PG
    M07 --> REDIS
    
    M08 --> M06
    M08 --> PG
    
    M13 --> M07
    M13 --> M08
    M13 --> M09
    
    M14 --> M13
```

### 1.2 ç³»çµ±ç‰¹æ€§

| ç‰¹æ€§ | èªªæ˜ |
|-----|------|
| **æ¶æ§‹æ¨¡å¼** | å¾®æœå‹™æ¶æ§‹ + åˆ†å±¤æ¶æ§‹ |
| **é€šè¨Šå”å®š** | REST API / gRPC (æ¨¡çµ„é–“) |
| **è³‡æ–™åº«** | PostgreSQL 15+ (ä¸»è¦), Redis 7.0 (å¿«å–) |
| **è¨Šæ¯ä½‡åˆ—** | RabbitMQ / Kafka (äº‹ä»¶é©…å‹•) |
| **å®¹å™¨åŒ–** | Docker + Kubernetes |
| **ç¨‹å¼èªè¨€** | Java 17+ (Spring Boot), Python 3.11+ (è¨ˆç®—å¼•æ“) |

---

## 2. åˆ†å±¤æ¶æ§‹

### 2.1 å››å±¤æ¶æ§‹è¨­è¨ˆ

```mermaid
graph TB
    subgraph "Layer 4: æ‡‰ç”¨å±¤"
        L4_1[å‰ç«¯æ‡‰ç”¨]
        L4_2[API Gateway]
        L4_3[èªè­‰æˆæ¬Š]
    end
    
    subgraph "Layer 3: æ¥­å‹™é‚è¼¯å±¤"
        L3_1[é¸è‚¡å¼•æ“ M14]
        L3_2[å›æ¸¬ç³»çµ± M16]
        L3_3[æŠ•è³‡çµ„åˆ M18]
    end
    
    subgraph "Layer 2: åˆ†æå±¤"
        L2_1[æŠ€è¡“åˆ†æ M07]
        L2_2[åŸºæœ¬é¢åˆ†æ M08]
        L2_3[ç±Œç¢¼åˆ†æ M09]
        L2_4[ä¿¡è™Ÿåˆ¤æ–· M13]
    end
    
    subgraph "Layer 1: è³‡æ–™å±¤"
        L1_1[è³‡æ–™ç®¡ç† M06]
        L1_2[PostgreSQL]
        L1_3[Redis]
    end
    
    L4_1 --> L4_2
    L4_2 --> L3_1
    L4_2 --> L3_2
    L4_2 --> L3_3
    
    L3_1 --> L2_4
    L3_2 --> L2_1
    L3_3 --> L2_1
    
    L2_4 --> L2_1
    L2_4 --> L2_2
    L2_4 --> L2_3
    
    L2_1 --> L1_1
    L2_2 --> L1_1
    L2_3 --> L1_1
    
    L1_1 --> L1_2
    L1_1 --> L1_3
```

### 2.2 å„å±¤è·è²¬

| å±¤ç´š | åç¨± | è·è²¬ | æ ¸å¿ƒæ¨¡çµ„ |
|-----|------|-----|---------|
| **L4** | æ‡‰ç”¨å±¤ | ç”¨æˆ¶ä»‹é¢ã€è«‹æ±‚è·¯ç”±ã€èªè­‰æˆæ¬Š | API Gateway, å‰ç«¯ |
| **L3** | æ¥­å‹™é‚è¼¯å±¤ | é¸è‚¡ã€å›æ¸¬ã€æŠ•è³‡çµ„åˆç®¡ç† | M14, M16, M18 |
| **L2** | åˆ†æå±¤ | æŠ€è¡“åˆ†æã€åŸºæœ¬é¢åˆ†æã€ä¿¡è™Ÿç”¢ç”Ÿ | M07, M08, M09, M13 |
| **L1** | è³‡æ–™å±¤ | è³‡æ–™ç²å–ã€å„²å­˜ã€æŸ¥è©¢ | M06, PostgreSQL, Redis |

---

## 3. æ¨¡çµ„æ¶æ§‹

### 3.1 æ¨¡çµ„ä¾è³´é—œä¿‚åœ–

```mermaid
graph LR
    M06[M06<br/>è³‡æ–™ç®¡ç†]
    M07[M07<br/>æŠ€è¡“åˆ†æ]
    M08[M08<br/>åŸºæœ¬é¢åˆ†æ]
    M09[M09<br/>ç±Œç¢¼åˆ†æ]
    M10[M10<br/>æŠ€è¡“å‹æ…‹]
    M13[M13<br/>ä¿¡è™Ÿåˆ¤æ–·]
    M14[M14<br/>é¸è‚¡å¼•æ“]
    M16[M16<br/>å›æ¸¬ç³»çµ±]
    
    M06 --> M07
    M06 --> M08
    M06 --> M09
    M06 --> M10
    
    M07 --> M10
    M07 --> M13
    
    M08 --> M13
    M09 --> M13
    M10 --> M13
    
    M13 --> M14
    M13 --> M16
    
    style M06 fill:#e1f5ff
    style M07 fill:#fff4e1
    style M08 fill:#fff4e1
    style M09 fill:#fff4e1
    style M13 fill:#e8f5e9
    style M14 fill:#f3e5f5
```

### 3.2 æ¨¡çµ„åˆ†é¡

| åˆ†é¡ | æ¨¡çµ„ | èªªæ˜ |
|-----|------|------|
| **åŸºç¤å±¤** | M06 | è³‡æ–™ç®¡ç†æ¨¡çµ„ï¼ˆç„¡ä¾è³´ï¼‰ |
| **åˆ†æå±¤** | M07, M08, M09, M10 | å„é¡åˆ†ææ¨¡çµ„ï¼ˆä¾è³´ M06ï¼‰ |
| **æ±ºç­–å±¤** | M13 | ä¿¡è™Ÿåˆ¤æ–·å¼•æ“ï¼ˆä¾è³´åˆ†æå±¤ï¼‰ |
| **æ‡‰ç”¨å±¤** | M14, M16, M18 | é¸è‚¡ã€å›æ¸¬ã€æŠ•è³‡çµ„åˆï¼ˆä¾è³´æ±ºç­–å±¤ï¼‰ |

---

## 4. æŠ€è¡“æ¶æ§‹

### 4.1 æŠ€è¡“å †ç–Š

```mermaid
graph TB
    subgraph "å‰ç«¯æŠ€è¡“"
        FE1[React / Vue.js]
        FE2[TypeScript]
        FE3[TailwindCSS]
    end
    
    subgraph "å¾Œç«¯æŠ€è¡“"
        BE1[Spring Boot 3.2+]
        BE2[Spring Data JPA]
        BE3[MyBatis]
        BE4[Spring Security]
    end
    
    subgraph "è¨ˆç®—å¼•æ“"
        CE1[Python 3.11+]
        CE2[pandas / NumPy]
        CE3[pandas-ta]
        CE4[scikit-learn]
    end
    
    subgraph "è³‡æ–™åº«"
        DB1[(PostgreSQL 15+)]
        DB2[(Redis 7.0+)]
    end
    
    subgraph "è¨Šæ¯ä½‡åˆ—"
        MQ1[RabbitMQ]
        MQ2[Kafka]
    end
    
    subgraph "åŸºç¤è¨­æ–½"
        INF1[Docker]
        INF2[Kubernetes]
        INF3[Prometheus]
        INF4[Grafana]
    end
```

### 4.2 æŠ€è¡“é¸å‹ç†ç”±

| æŠ€è¡“ | é¸å‹ç†ç”± |
|-----|---------|
| **Spring Boot** | æˆç†Ÿçš„ä¼æ¥­ç´šæ¡†æ¶ï¼Œç”Ÿæ…‹å®Œæ•´ï¼Œæ˜“æ–¼ç¶­è­· |
| **PostgreSQL** | æ”¯æ´ JSONBã€é™£åˆ—ã€åˆ†å€ï¼Œé©åˆé‡‘èè³‡æ–™ |
| **Redis** | é«˜æ•ˆèƒ½å¿«å–ï¼Œæ”¯æ´å¤šç¨®è³‡æ–™çµæ§‹ |
| **MyBatis** | éˆæ´»çš„ SQL æ§åˆ¶ï¼Œé©åˆè¤‡é›œæŸ¥è©¢ |
| **pandas-ta** | è±å¯Œçš„æŠ€è¡“æŒ‡æ¨™åº«ï¼Œè¨ˆç®—æ•ˆç‡é«˜ |
| **Kubernetes** | å®¹å™¨ç·¨æ’ï¼Œæ”¯æ´è‡ªå‹•æ“´å±•èˆ‡æ•…éšœæ¢å¾© |

---

## 5. éƒ¨ç½²æ¶æ§‹

### 5.1 ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²åœ–

```mermaid
graph TB
    subgraph "è² è¼‰å‡è¡¡å±¤"
        LB[Nginx / HAProxy]
    end
    
    subgraph "æ‡‰ç”¨æœå‹™å±¤ (Kubernetes)"
        POD1[API Gateway<br/>Pod x3]
        POD2[M06 Service<br/>Pod x2]
        POD3[M07 Service<br/>Pod x2]
        POD4[M08 Service<br/>Pod x2]
    end
    
    subgraph "è³‡æ–™åº«å±¤"
        PG_MASTER[(PostgreSQL<br/>Master)]
        PG_SLAVE1[(PostgreSQL<br/>Slave 1)]
        PG_SLAVE2[(PostgreSQL<br/>Slave 2)]
    end
    
    subgraph "å¿«å–å±¤"
        REDIS_CLUSTER[(Redis Cluster<br/>3 Master + 3 Slave)]
    end
    
    subgraph "è¨Šæ¯ä½‡åˆ—"
        MQ_CLUSTER[RabbitMQ Cluster<br/>3 Nodes]
    end
    
    LB --> POD1
    POD1 --> POD2
    POD1 --> POD3
    POD1 --> POD4
    
    POD2 --> PG_MASTER
    POD2 --> PG_SLAVE1
    POD2 --> REDIS_CLUSTER
    
    POD3 --> PG_MASTER
    POD3 --> REDIS_CLUSTER
    
    PG_MASTER -.->|Replication| PG_SLAVE1
    PG_MASTER -.->|Replication| PG_SLAVE2
    
    POD2 --> MQ_CLUSTER
    POD3 --> MQ_CLUSTER
```

### 5.2 ç’°å¢ƒè¦åŠƒ

| ç’°å¢ƒ | ç”¨é€” | é…ç½® |
|-----|------|-----|
| **é–‹ç™¼ç’°å¢ƒ** | é–‹ç™¼æ¸¬è©¦ | å–®æ©Ÿéƒ¨ç½²ï¼Œæœ€å°è³‡æº |
| **æ¸¬è©¦ç’°å¢ƒ** | æ•´åˆæ¸¬è©¦ | æ¨¡æ“¬ç”Ÿç”¢ï¼Œä¸­ç­‰è³‡æº |
| **é ç™¼ç’°å¢ƒ** | ä¸Šç·šå‰é©—è­‰ | èˆ‡ç”Ÿç”¢ä¸€è‡´ |
| **ç”Ÿç”¢ç’°å¢ƒ** | æ­£å¼æœå‹™ | é«˜å¯ç”¨æ¶æ§‹ï¼Œå¤šç¯€é» |

---

## 6. è³‡æ–™æµæ¶æ§‹

### 6.1 è³‡æ–™ç²å–æµç¨‹

```mermaid
sequenceDiagram
    participant EXT as å¤–éƒ¨è³‡æ–™æº
    participant M06 as M06 è³‡æ–™ç®¡ç†
    participant PG as PostgreSQL
    participant REDIS as Redis
    participant M07 as M07 æŠ€è¡“åˆ†æ
    
    Note over EXT,M06: æ¯æ—¥å®šæ™‚ä»»å‹™
    M06->>EXT: 1. ç²å–è‚¡åƒ¹è³‡æ–™
    EXT-->>M06: 2. è¿”å›åŸå§‹è³‡æ–™
    M06->>M06: 3. è³‡æ–™æ¸…æ´—èˆ‡é©—è­‰
    M06->>PG: 4. å„²å­˜è‡³è³‡æ–™åº«
    M06->>REDIS: 5. æ›´æ–°å¿«å–
    M06->>M07: 6. ç™¼å¸ƒäº‹ä»¶
    M07->>M06: 7. è®€å–è‚¡åƒ¹è³‡æ–™
    M07->>M07: 8. è¨ˆç®—æŠ€è¡“æŒ‡æ¨™
    M07->>PG: 9. å„²å­˜æŒ‡æ¨™çµæœ
```

### 6.2 API æŸ¥è©¢æµç¨‹

```mermaid
sequenceDiagram
    participant CLIENT as ç”¨æˆ¶ç«¯
    participant GW as API Gateway
    participant M07 as M07 æŠ€è¡“åˆ†æ
    participant REDIS as Redis
    participant PG as PostgreSQL
    
    CLIENT->>GW: 1. API è«‹æ±‚
    GW->>GW: 2. èªè­‰æˆæ¬Š
    GW->>M07: 3. è½‰ç™¼è«‹æ±‚
    M07->>REDIS: 4. æª¢æŸ¥å¿«å–
    alt å¿«å–å‘½ä¸­
        REDIS-->>M07: 5a. è¿”å›å¿«å–è³‡æ–™
    else å¿«å–æœªå‘½ä¸­
        M07->>PG: 5b. æŸ¥è©¢è³‡æ–™åº«
        PG-->>M07: 6. è¿”å›è³‡æ–™
        M07->>REDIS: 7. å¯«å…¥å¿«å–
    end
    M07-->>GW: 8. è¿”å›çµæœ
    GW-->>CLIENT: 9. API å›æ‡‰
```

---

## ğŸ“š ç›¸é—œæ–‡æª”

- [æŠ€è¡“æ¶æ§‹](../specs/technical/00-æŠ€è¡“æ¶æ§‹.md)
- [å…¨ç³»çµ±å¥‘ç´„](../specs/technical/00-å…¨ç³»çµ±å¥‘ç´„.md)
- [è³‡æ–™åº«æ¶æ§‹](./database-schema.md)
- [NFRéåŠŸèƒ½æ€§éœ€æ±‚](../specs/technical/00-NFRéåŠŸèƒ½æ€§éœ€æ±‚.md)

---

**æ–‡ä»¶ç¶­è­·è€…**: ç³»çµ±æ¶æ§‹å¸«  
**æœ€å¾Œæ›´æ–°**: 2025-12-31  
**ä¸‹æ¬¡å¯©æ ¸**: 2026-02-28
