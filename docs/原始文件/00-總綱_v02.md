# è‚¡ç¥¨ç›£æ§ç³»çµ± - ç³»çµ±åˆ†æèˆ‡è¨­è¨ˆç¸½ç¶± (SA/SD)

## æ–‡ä»¶è³‡è¨Š
- **æ–‡ä»¶ç·¨è™Ÿ**: DOC-00-MASTER
- **æ–‡ä»¶åç¨±**: ç³»çµ±åˆ†æèˆ‡è¨­è¨ˆç¸½ç¶±
- **ç³»çµ±åç¨±**: è‚¡ç¥¨é€²å‡ºå ´ç›£æ§ç³»çµ± (Stock Monitor & Alert System)
- **ç‰ˆæœ¬**: v2.0
- **å»ºç«‹æ—¥æœŸ**: 2025-12-22
- **æœ€å¾Œæ›´æ–°**: 2025-12-24
- **æ–‡ä»¶ç‹€æ…‹**: Draft
- **æŠ€è¡“æ£§**: Java 17+ / Spring Boot 3.x / PostgreSQL 15+ / Redis 7.0 / JPA + MyBatis

---

## ğŸ“‘ ç›®éŒ„

1. [å°ˆæ¡ˆæ¦‚è¿°](#1-å°ˆæ¡ˆæ¦‚è¿°)
2. [åè©å®šç¾©](#2-åè©å®šç¾©)
3. [ç‰ˆæœ¬ç´€éŒ„](#3-ç‰ˆæœ¬ç´€éŒ„)
4. [å…¨ç³»çµ±å¥‘ç´„](#4-å…¨ç³»çµ±å¥‘ç´„) â­
5. [æŠ€è¡“æ¶æ§‹](#5-æŠ€è¡“æ¶æ§‹)
6. [æ¨¡çµ„æ¸…å–®èˆ‡ä¾è³´é—œä¿‚](#6-æ¨¡çµ„æ¸…å–®èˆ‡ä¾è³´é—œä¿‚)
7. [éåŠŸèƒ½æ€§éœ€æ±‚ (NFR)](#7-éåŠŸèƒ½æ€§éœ€æ±‚-nfr)
8. [é–‹ç™¼æº–å‰‡](#8-é–‹ç™¼æº–å‰‡)
9. [é™„éŒ„](#9-é™„éŒ„)
10. [ç¸½ç¶±ä½¿ç”¨æŒ‡å¼•](#10-ç¸½ç¶±ä½¿ç”¨æŒ‡å¼•)

---

## 1. å°ˆæ¡ˆæ¦‚è¿°

### 1.1 ç³»çµ±å®šä½
åŸºæ–¼ Java Spring Boot 3.x çš„ä¼æ¥­ç´šè‚¡ç¥¨ç›£æ§ç³»çµ±ï¼Œæ•´åˆæŠ€è¡“åˆ†æã€åŸºæœ¬é¢åˆ†æã€ç±Œç¢¼åˆ†æã€æŠ€è¡“å‹æ…‹è¾¨è­˜ã€é‡åŒ–ç­–ç•¥ã€ç¸½ç¶“èˆ‡ç”¢æ¥­åˆ†æç­‰å¤šç¶­åº¦åˆ†æèƒ½åŠ›ï¼Œæä¾›æ™ºèƒ½é¸è‚¡ã€ä¿¡è™Ÿç›£æ§ã€è­¦å ±é€šçŸ¥ã€ç­–ç•¥å›æ¸¬ç­‰å®Œæ•´åŠŸèƒ½ã€‚

### 1.2 ç³»çµ±ç›®æ¨™
- âœ… æä¾›å¤šç¶­åº¦è‚¡ç¥¨åˆ†æèƒ½åŠ›ï¼ˆæŠ€è¡“é¢ + åŸºæœ¬é¢ + ç±Œç¢¼é¢ + å‹æ…‹ + ç¸½ç¶“ç”¢æ¥­ï¼‰
- âœ… è‡ªå‹•åŒ–ç›£æ§èˆ‡å³æ™‚è­¦å ±é€šçŸ¥
- âœ… ç­–ç•¥å›æ¸¬èˆ‡ç¸¾æ•ˆè©•ä¼°
- âœ… æŠ•è³‡çµ„åˆç®¡ç†èˆ‡é¢¨éšªæ§åˆ¶
- âœ… é«˜å¯ç”¨ã€é«˜æ•ˆèƒ½ã€æ˜“æ“´å±•çš„ä¼æ¥­ç´šæ¶æ§‹

### 1.3 æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„
| æ¨¡çµ„ç·¨è™Ÿ | æ¨¡çµ„åç¨± | æ ¸å¿ƒåŠŸèƒ½ |
|---------|---------|---------|
| M06 | è³‡æ–™ç®¡ç†æ¨¡çµ„ | è‚¡åƒ¹/è²¡å ±/ç±Œç¢¼è³‡æ–™ç²å–ã€æ¸…æ´—ã€å„²å­˜ã€æ›´æ–° |
| M07 | æŠ€è¡“åˆ†ææ¨¡çµ„ | 71å€‹æŠ€è¡“æŒ‡æ¨™è¨ˆç®—ï¼ˆè¶¨å‹¢ã€å‹•èƒ½ã€æ³¢å‹•ã€æˆäº¤é‡ï¼‰ |
| M08 | åŸºæœ¬é¢åˆ†ææ¨¡çµ„ | 75å€‹è²¡å‹™æŒ‡æ¨™è¨ˆç®—ï¼ˆä¼°å€¼ã€ç²åˆ©ã€è²¡å‹™çµæ§‹ã€ç¾é‡‘æµï¼‰ |
| M09 | ç±Œç¢¼åˆ†ææ¨¡çµ„ | ä¸‰å¤§æ³•äººã€èè³‡èåˆ¸ã€è‘£ç›£æŒè‚¡ã€ç±Œç¢¼é›†ä¸­åº¦ |
| M10 | æŠ€è¡“å‹æ…‹è¾¨è­˜æ¨¡çµ„ | Kç·šå‹æ…‹ã€åœ–è¡¨å‹æ…‹ã€è¶¨å‹¢å‹æ…‹è­˜åˆ¥ |
| M11 | é‡åŒ–ç­–ç•¥æ¨¡çµ„ | ç­–ç•¥æ¡†æ¶ã€é è¨­ç­–ç•¥åº«ã€è‡ªè¨‚ç­–ç•¥ã€åƒæ•¸å„ªåŒ– |
| M12 | ç¸½ç¶“èˆ‡ç”¢æ¥­åˆ†ææ¨¡çµ„ | ç¸½é«”ç¶“æ¿ŸæŒ‡æ¨™ã€ç”¢æ¥­åˆ†é¡ã€ç”¢æ¥­è¼ªå‹•åˆ†æ |
| M13 | ä¿¡è™Ÿåˆ¤æ–·å¼•æ“ | çµ±ä¸€ä¿¡è™Ÿç”Ÿæˆã€å»é‡åˆä½µã€ç‰ˆæœ¬åŒ–ã€å¯è¿½æº¯ |
| M14 | é¸è‚¡å¼•æ“ | å¤šæ¢ä»¶ç¯©é¸ã€é è¨­ç­–ç•¥ã€è‡ªè¨‚ç­–ç•¥ã€æ’åºæ’å |
| M15 | è­¦å ±é€šçŸ¥ç³»çµ± | è­¦å ±æ¢ä»¶è¨­å®šã€å¤šé€šé“é€šçŸ¥ã€é »ç‡æ§åˆ¶ã€å¤±æ•—é‡è©¦ |
| M16 | å›æ¸¬ç³»çµ± | ç­–ç•¥å›æ¸¬ã€ç¸¾æ•ˆè©•ä¼°ã€åƒæ•¸å„ªåŒ–ã€å ±å‘Šç”Ÿæˆ |
| M17 | é¢¨éšªç®¡ç†æ¨¡çµ„ | åœæåœåˆ©ã€éƒ¨ä½ç®¡ç†ã€é¢¨éšªæŒ‡æ¨™ã€å£“åŠ›æ¸¬è©¦ |
| M18 | æŠ•è³‡çµ„åˆç®¡ç† | æŒè‚¡è¨˜éŒ„ã€æç›Šè¨ˆç®—ã€ç¸¾æ•ˆåˆ†æã€é…ç½®åˆ†æ |

### 1.4 ç›®æ¨™ç”¨æˆ¶
- å€‹äººæŠ•è³‡è€…
- å°ˆæ¥­äº¤æ˜“å“¡
- é‡åŒ–äº¤æ˜“åœ˜éšŠ
- é‡‘èç§‘æŠ€å…¬å¸

### 1.5 ç³»çµ±é‚Šç•Œ
**åŒ…å«ç¯„åœ**:
- å°è‚¡è‚¡ç¥¨è³‡æ–™ï¼ˆä¸Šå¸‚ã€ä¸Šæ«ƒï¼‰
- æŠ€è¡“åˆ†æã€åŸºæœ¬é¢åˆ†æã€ç±Œç¢¼åˆ†æ
- ä¿¡è™Ÿç›£æ§èˆ‡è­¦å ±é€šçŸ¥
- ç­–ç•¥å›æ¸¬èˆ‡ç¸¾æ•ˆè©•ä¼°
- æŠ•è³‡çµ„åˆç®¡ç†

**ä¸åŒ…å«ç¯„åœ**:
- å¯¦éš›ä¸‹å–®äº¤æ˜“ï¼ˆåƒ…æä¾›ä¿¡è™Ÿï¼Œä¸åŸ·è¡Œäº¤æ˜“ï¼‰
- æœŸè²¨ã€é¸æ“‡æ¬Šã€å¤–åŒ¯ç­‰å…¶ä»–é‡‘èå•†å“
- å³æ™‚å ±åƒ¹ä¸²æµï¼ˆä½¿ç”¨å»¶é²å ±åƒ¹ï¼‰
- æ–°èçˆ¬èŸ²èˆ‡æƒ…ç·’åˆ†æï¼ˆæœªä¾†æ“´å……ï¼‰

---

## 2. åè©å®šç¾©

### 2.1 æ¥­å‹™è¡“èª

| è¡“èª | è‹±æ–‡ | å®šç¾© |
|-----|------|-----|
| **è‚¡ç¥¨ä»£ç¢¼** | Stock ID / Symbol | å°è‚¡è‚¡ç¥¨ä»£ç¢¼ï¼Œå¦‚ 2330ï¼ˆå°ç©é›»ï¼‰ |
| **æŠ€è¡“æŒ‡æ¨™** | Technical Indicator | åŸºæ–¼è‚¡åƒ¹ã€æˆäº¤é‡è¨ˆç®—çš„æ•¸å­¸æŒ‡æ¨™ï¼ˆå¦‚ MAã€MACDã€RSIï¼‰ |
| **åŸºæœ¬é¢æŒ‡æ¨™** | Fundamental Indicator | åŸºæ–¼è²¡å ±è¨ˆç®—çš„è²¡å‹™æŒ‡æ¨™ï¼ˆå¦‚ EPSã€ROEã€æœ¬ç›Šæ¯”ï¼‰ |
| **ç±Œç¢¼** | Chip | å¸‚å ´åƒèˆ‡è€…çš„è²·è³£ç±Œç¢¼ï¼ŒåŒ…å«ä¸‰å¤§æ³•äººã€èè³‡èåˆ¸ç­‰ |
| **ä¿¡è™Ÿ** | Signal | ç³»çµ±æ ¹æ“šæŒ‡æ¨™/å‹æ…‹/ç­–ç•¥ç”¢ç”Ÿçš„è²·è³£å»ºè­° |
| **é€²å ´ä¿¡è™Ÿ** | Entry Signal / Buy Signal | å»ºè­°è²·å…¥çš„ä¿¡è™Ÿ |
| **å‡ºå ´ä¿¡è™Ÿ** | Exit Signal / Sell Signal | å»ºè­°è³£å‡ºçš„ä¿¡è™Ÿ |
| **æŠ€è¡“å‹æ…‹** | Pattern | Kç·šçµ„åˆæˆ–åœ–è¡¨å½¢æˆçš„ç‰¹å®šå‹æ…‹ï¼ˆå¦‚é ­è‚©é ‚ã€é›™é‡åº•ï¼‰ |
| **é¸è‚¡** | Stock Screening | æ ¹æ“šæ¢ä»¶ç¯©é¸å‡ºç¬¦åˆçš„è‚¡ç¥¨æ¸…å–® |
| **ç­–ç•¥** | Strategy | ä¸€çµ„æŠ•è³‡è¦å‰‡èˆ‡é‚è¼¯çš„çµ„åˆ |
| **å›æ¸¬** | Backtest | ä½¿ç”¨æ­·å²è³‡æ–™é©—è­‰ç­–ç•¥çš„æœ‰æ•ˆæ€§ |
| **è‡ªé¸è‚¡** | Watchlist | ä½¿ç”¨è€…é—œæ³¨çš„è‚¡ç¥¨æ¸…å–® |
| **è­¦å ±** | Alert | æ»¿è¶³ç‰¹å®šæ¢ä»¶æ™‚è§¸ç™¼çš„é€šçŸ¥ |

### 2.2 æŠ€è¡“è¡“èª

| è¡“èª | å®šç¾© |
|-----|-----|
| **Entity** | JPA å¯¦é«”é¡åˆ¥ï¼Œå°æ‡‰è³‡æ–™åº«è¡¨ |
| **DTO** | Data Transfer Objectï¼Œç”¨æ–¼ API è«‹æ±‚/å›æ‡‰çš„è³‡æ–™å‚³è¼¸ç‰©ä»¶ |
| **Repository** | JPA è³‡æ–™å­˜å–å±¤æ¥å£ï¼Œè² è²¬åŸºç¤ CRUD æ“ä½œ |
| **Service** | æ¥­å‹™é‚è¼¯å±¤ï¼Œè™•ç†æ ¸å¿ƒæ¥­å‹™è¦å‰‡ï¼Œå”èª¿ Repository å’Œ Mapper |
| **Controller** | æ§åˆ¶å™¨å±¤ï¼Œè™•ç† HTTP è«‹æ±‚èˆ‡å›æ‡‰ |
| **Scheduler** | å®šæ™‚ä»»å‹™ï¼Œç”¨æ–¼é€±æœŸæ€§åŸ·è¡Œè³‡æ–™æ›´æ–°ã€ä¿¡è™Ÿæª¢æ¸¬ç­‰ |
| **Job** | å¯è¿½è¹¤çš„æ‰¹æ¬¡ä½œæ¥­å–®ä½ï¼Œæœ‰ç‹€æ…‹ã€å¯é‡è·‘ |
| **Pipeline** | è³‡æ–™è™•ç†æµæ°´ç·šï¼ŒåŒ…å«å¤šå€‹æ­¥é©Ÿçš„è³‡æ–™è™•ç†æµç¨‹ |
| **Cache** | å¿«å–ï¼Œä½¿ç”¨ Redis å„²å­˜ç†±è³‡æ–™ä»¥æå‡æ•ˆèƒ½ |
| **å†ªç­‰æ€§** | Idempotencyï¼ŒåŒä¸€æ“ä½œåŸ·è¡Œå¤šæ¬¡çµæœä¸€è‡´ |
| **Mapper** | MyBatis Mapper æ¥å£ï¼Œç”¨æ–¼è¤‡é›œæŸ¥è©¢å’Œå‹•æ…‹ SQL |
| **JSONB** | PostgreSQL çš„äºŒé€²åˆ¶ JSON å‹æ…‹ï¼Œæ”¯æ´é«˜æ•ˆç´¢å¼•èˆ‡æŸ¥è©¢ |

### 2.3 ç¸®å¯«å°ç…§

| ç¸®å¯« | å…¨å |
|-----|------|
| SA | System Analysisï¼ˆç³»çµ±åˆ†æï¼‰ |
| SD | System Designï¼ˆç³»çµ±è¨­è¨ˆï¼‰ |
| NFR | Non-Functional Requirementsï¼ˆéåŠŸèƒ½æ€§éœ€æ±‚ï¼‰ |
| API | Application Programming Interface |
| REST | Representational State Transfer |
| DTO | Data Transfer Object |
| DAO | Data Access Object |
| JPA | Java Persistence API |
| ORM | Object-Relational Mapping |
| CRUD | Create, Read, Update, Delete |
| JWT | JSON Web Token |
| RBAC | Role-Based Access Control |
| DQ | Data Qualityï¼ˆè³‡æ–™å“è³ªï¼‰ |
| ETL | Extract, Transform, Load |
| TTL | Time To Liveï¼ˆå¿«å–éæœŸæ™‚é–“ï¼‰ |
| PK | Primary Keyï¼ˆä¸»éµï¼‰ |
| FK | Foreign Keyï¼ˆå¤–éµï¼‰ |
| UK | Unique Keyï¼ˆå”¯ä¸€éµï¼‰ |
| IDX | Indexï¼ˆç´¢å¼•ï¼‰ |

---

## 3. ç‰ˆæœ¬ç´€éŒ„

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®æ”¹è€… | ä¿®æ”¹å…§å®¹ | ç‹€æ…‹ |
|-----|------|-------|---------|------|
| v1.0 | 2025-12-22 | Claude | åˆå§‹ç‰ˆæœ¬ï¼Œå»ºç«‹ç¸½ç¶±éª¨æ¶èˆ‡å…¨ç³»çµ±å¥‘ç´„ï¼ˆMySQL + JPAï¼‰ | Draft |
| v2.0 | 2025-12-24 | Chris | èª¿æ•´æŠ€è¡“æ£§ç‚º PostgreSQL + JPA + MyBatis æ··åˆæ¶æ§‹ | Draft |
| | | | | |
| | | | | |

---

## 4. å…¨ç³»çµ±å¥‘ç´„ â­

> **é‡è¦èªªæ˜**: æœ¬ç« ç¯€å®šç¾©æ‰€æœ‰æ¨¡çµ„å¿…é ˆéµå®ˆçš„å…±ç”¨è¦å‰‡èˆ‡æ¨™æº–ï¼Œç¢ºä¿ç³»çµ±æ•´é«”ä¸€è‡´æ€§ã€‚

### 4.1 è³‡æ–™æµç¸½è¦½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å¤–éƒ¨è³‡æ–™ä¾†æº                              â”‚
â”‚  Yahoo Finance / è­‰äº¤æ‰€ / å…¬é–‹è³‡è¨Šè§€æ¸¬ç«™ / FinMind           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    [è³‡æ–™ç®¡ç†æ¨¡çµ„ M06]
                    - è³‡æ–™ç²å– (Fetch)
                    - è³‡æ–™æ¸…æ´— (Clean)
                    - è³‡æ–™é©—è­‰ (Validate)
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      è³‡æ–™å„²å­˜å±¤                               â”‚
â”‚  PostgreSQL: stocks, stock_prices, financial_data, chip_dataâ”‚
â”‚  - ä½¿ç”¨ JSONB å„²å­˜è¤‡é›œçµæ§‹åŒ–è³‡æ–™                             â”‚
â”‚  - æ”¯æ´ GIN ç´¢å¼•æå‡ JSON æŸ¥è©¢æ•ˆèƒ½                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                     â†“                     â†“
   [æŠ€è¡“åˆ†æ M07]        [åŸºæœ¬é¢ M08]         [ç±Œç¢¼åˆ†æ M09]
   [å‹æ…‹è¾¨è­˜ M10]        [é‡åŒ–ç­–ç•¥ M11]       [ç¸½ç¶“ç”¢æ¥­ M12]
   - JPA: ç°¡å–® CRUD      - JPA: åŸºç¤æ“ä½œ      - JPA: åŸºç¤æ“ä½œ
   - MyBatis: è¤‡é›œè¨ˆç®—   - MyBatis: è²¡å ±æŸ¥è©¢  - MyBatis: ç±Œç¢¼åˆ†æ
        â”‚                     â”‚                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    [ä¿¡è™Ÿåˆ¤æ–·å¼•æ“ M13]
                    - ä¿¡è™Ÿç”Ÿæˆ
                    - ä¿¡è™Ÿå»é‡
                    - ä¿¡è™Ÿåˆä½µ
                    - ä¿¡è™Ÿè©•åˆ†
                    - MyBatis: è¤‡é›œä¿¡è™ŸæŸ¥è©¢
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ä¿¡è™Ÿå„²å­˜èˆ‡ç´¢å¼•                            â”‚
â”‚         PostgreSQL: signals (çµ±ä¸€ Signal Contract)          â”‚
â”‚         - JSONB æ¬„ä½å„²å­˜è­‰æ“šè³‡æ–™ï¼ˆevidence_dataï¼‰            â”‚
â”‚              Redis: ä¿¡è™Ÿå¿«å–ã€å»é‡å¿«å–                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                                           â†“
   [é¸è‚¡å¼•æ“ M14]                          [è­¦å ±é€šçŸ¥ç³»çµ± M15]
   - æ¢ä»¶ç¯©é¸                               - æ¢ä»¶åŒ¹é…
   - ç­–ç•¥åŸ·è¡Œ                               - é€šçŸ¥ç™¼é€
   - æ’åºæ’å                               - é »ç‡æ§åˆ¶
   - MyBatis: è¤‡é›œå¤šæ¢ä»¶ç¯©é¸                - JPA: åŸºç¤ CRUD
        â†“                                           â†“
   [å›æ¸¬ç³»çµ± M16]                          [é€šçŸ¥æ¸ é“]
   [é¢¨éšªç®¡ç† M17]                          LINE / Email / Telegram
   [æŠ•è³‡çµ„åˆ M18]                          WebSocket / Discord
   - MyBatis: è¤‡é›œçµ±è¨ˆæŸ¥è©¢                  
        â†“                                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯ä»‹é¢                               â”‚
â”‚              Web Dashboard / Mobile App                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é—œéµè³‡æ–™æµè·¯å¾‘**:
1. **è³‡æ–™å…¥åº«è·¯å¾‘**: å¤–éƒ¨ API â†’ è³‡æ–™ç®¡ç†æ¨¡çµ„ â†’ PostgreSQL/Redis
2. **æŒ‡æ¨™è¨ˆç®—è·¯å¾‘**: è³‡æ–™åº« â†’ å„åˆ†ææ¨¡çµ„ â†’ æŒ‡æ¨™è¡¨ â†’ Redis å¿«å–
3. **ä¿¡è™Ÿç”Ÿæˆè·¯å¾‘**: æŒ‡æ¨™/å‹æ…‹ â†’ ä¿¡è™Ÿå¼•æ“ â†’ ä¿¡è™Ÿè¡¨ â†’ é€šçŸ¥/é¸è‚¡
4. **æŸ¥è©¢è·¯å¾‘**: å‰ç«¯ â†’ API â†’ å¿«å–/è³‡æ–™åº« â†’ å›æ‡‰

---


### 4.2 Signal Contractï¼ˆçµ±ä¸€ä¿¡è™Ÿè³‡æ–™æ¨¡å‹ï¼‰

> **è¨­è¨ˆåŸå‰‡**: æ‰€æœ‰æ¨¡çµ„ç”¢ç”Ÿçš„ä¿¡è™Ÿå¿…é ˆéµå®ˆçµ±ä¸€çš„è³‡æ–™çµæ§‹ï¼Œä»¥ä¾¿æ–¼å»é‡ã€åˆä½µã€è©•åˆ†ã€è¿½æº¯ã€‚

#### 4.2.1 æ ¸å¿ƒæ¬„ä½å®šç¾©

```sql
-- PostgreSQL å»ºè¡¨èªæ³•
CREATE TABLE signals (
    -- ä¸»éµèˆ‡è­˜åˆ¥
    signal_id           BIGSERIAL PRIMARY KEY,
    signal_uuid         VARCHAR(36) NOT NULL UNIQUE,
    
    -- è‚¡ç¥¨è³‡è¨Š
    stock_id            VARCHAR(10) NOT NULL,
    stock_name          VARCHAR(50),
    
    -- ä¿¡è™ŸåŸºæœ¬è³‡è¨Š
    signal_type         VARCHAR(10) NOT NULL CHECK (signal_type IN ('BUY', 'SELL', 'HOLD')),
    signal_source       VARCHAR(50) NOT NULL,
    signal_name         VARCHAR(100) NOT NULL,
    signal_category     VARCHAR(50),
    
    -- ä¿¡è™Ÿå¼·åº¦èˆ‡è©•åˆ†
    signal_strength     NUMERIC(5,2),
    confidence_score    NUMERIC(5,2),
    
    -- åƒ¹æ ¼è³‡è¨Š
    trigger_price       NUMERIC(10,2),
    current_price       NUMERIC(10,2),
    target_price        NUMERIC(10,2),
    stop_loss_price     NUMERIC(10,2),
    
    -- æ™‚é–“è³‡è¨Š
    signal_date         DATE NOT NULL,
    signal_time         TIMESTAMP NOT NULL,
    valid_until         TIMESTAMP,
    
    -- ç‰ˆæœ¬èˆ‡è¿½æº¯
    signal_version      INTEGER DEFAULT 1,
    parent_signal_id    BIGINT,
    is_merged           BOOLEAN DEFAULT FALSE,
    merge_count         INTEGER DEFAULT 1,
    
    -- è­‰æ“šèˆ‡ä¾æ“šï¼ˆä½¿ç”¨ JSONB æå‡æŸ¥è©¢æ•ˆèƒ½ï¼‰
    evidence_data       JSONB,
    technical_factors   JSONB,
    fundamental_factors JSONB,
    chip_factors        JSONB,
    
    -- ç‹€æ…‹ç®¡ç†
    signal_status       VARCHAR(20) DEFAULT 'ACTIVE' 
        CHECK (signal_status IN ('ACTIVE', 'EXPIRED', 'TRIGGERED', 'CANCELLED')),
    is_notified         BOOLEAN DEFAULT FALSE,
    notification_count  INTEGER DEFAULT 0,
    
    -- å¯©è¨ˆæ¬„ä½
    created_at          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by          VARCHAR(50),
    
    -- å¤–éµç´„æŸ
    CONSTRAINT fk_parent_signal FOREIGN KEY (parent_signal_id) REFERENCES signals(signal_id)
);

-- å»ºç«‹ç´¢å¼•
CREATE INDEX idx_signals_stock_date ON signals(stock_id, signal_date);
CREATE INDEX idx_signals_signal_time ON signals(signal_time);
CREATE INDEX idx_signals_source ON signals(signal_source);
CREATE INDEX idx_signals_type_status ON signals(signal_type, signal_status);
CREATE INDEX idx_signals_uuid ON signals(signal_uuid);

-- JSONB æ¬„ä½çš„ GIN ç´¢å¼•ï¼ˆåŠ é€Ÿ JSON æŸ¥è©¢ï¼‰
CREATE INDEX idx_signals_evidence_data ON signals USING GIN (evidence_data);
CREATE INDEX idx_signals_technical_factors ON signals USING GIN (technical_factors);
CREATE INDEX idx_signals_fundamental_factors ON signals USING GIN (fundamental_factors);
CREATE INDEX idx_signals_chip_factors ON signals USING GIN (chip_factors);

-- æ›´æ–°æ™‚é–“è‡ªå‹•æ›´æ–°è§¸ç™¼å™¨
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER update_signals_updated_at
    BEFORE UPDATE ON signals
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();

-- è¡¨è¨»é‡‹
COMMENT ON TABLE signals IS 'çµ±ä¸€ä¿¡è™Ÿè¡¨';
COMMENT ON COLUMN signals.signal_id IS 'ä¿¡è™ŸIDï¼ˆä¸»éµï¼‰';
COMMENT ON COLUMN signals.signal_uuid IS 'UUIDï¼Œç”¨æ–¼å»é‡';
COMMENT ON COLUMN signals.stock_id IS 'è‚¡ç¥¨ä»£ç¢¼';
COMMENT ON COLUMN signals.evidence_data IS 'ä¿¡è™Ÿè­‰æ“šè³‡æ–™ï¼ˆJSONBæ ¼å¼ï¼Œæ”¯æ´é«˜æ•ˆæŸ¥è©¢ï¼‰';
```

#### 4.2.2 PostgreSQL ç‰¹æœ‰åŠŸèƒ½æ‡‰ç”¨

**1. JSONB æŸ¥è©¢ç¯„ä¾‹**:
```sql
-- æŸ¥è©¢ MACD å€¼å¤§æ–¼ 1.0 çš„ä¿¡è™Ÿ
SELECT * FROM signals 
WHERE evidence_data->>'indicator' = 'MACD' 
  AND (evidence_data->>'macd_value')::numeric > 1.0;

-- æŸ¥è©¢åŒ…å«ç‰¹å®šæŠ€è¡“å› å­çš„ä¿¡è™Ÿ
SELECT * FROM signals 
WHERE technical_factors ? 'RSI'  -- æª¢æŸ¥ JSON éµæ˜¯å¦å­˜åœ¨
  AND (technical_factors->>'RSI')::numeric < 30;

-- è¤‡åˆæ¢ä»¶æŸ¥è©¢
SELECT * FROM signals 
WHERE evidence_data @> '{"indicator": "MACD"}'::jsonb  -- åŒ…å«å­é›†
  AND signal_type = 'BUY'
  AND signal_status = 'ACTIVE';
```

**2. PostgreSQL é™£åˆ—å‹æ…‹æ‡‰ç”¨**:
```sql
-- åœ¨éœ€è¦çš„è¡¨ä¸­ä½¿ç”¨é™£åˆ—
ALTER TABLE stocks ADD COLUMN tags TEXT[];

-- æŸ¥è©¢åŒ…å«ç‰¹å®šæ¨™ç±¤çš„è‚¡ç¥¨
SELECT * FROM stocks WHERE 'semiconductor' = ANY(tags);
```

**3. å…¨æ–‡æª¢ç´¢ï¼ˆå¯é¸ï¼‰**:
```sql
-- ç‚º signal_name å»ºç«‹å…¨æ–‡æª¢ç´¢ç´¢å¼•
ALTER TABLE signals ADD COLUMN signal_name_tsv TSVECTOR;

CREATE INDEX idx_signals_fts ON signals USING GIN(signal_name_tsv);

-- æ›´æ–°å…¨æ–‡æª¢ç´¢æ¬„ä½
UPDATE signals SET signal_name_tsv = to_tsvector('english', signal_name);
```


#### 4.2.3 Signal Source è¦ç¯„

æ¯å€‹ç”¢ç”Ÿä¿¡è™Ÿçš„æ¨¡çµ„å¿…é ˆä½¿ç”¨è¦ç¯„çš„ `signal_source` è­˜åˆ¥ç¢¼ï¼š

| æ¨¡çµ„ | Signal Source | ç¯„ä¾‹ Signal Name | æŒä¹…å±¤é¸æ“‡ |
|-----|--------------|------------------|-----------|
| æŠ€è¡“åˆ†ææ¨¡çµ„ | `TECHNICAL` | MA_GOLDEN_CROSS, RSI_OVERSOLD | JPA + MyBatis |
| å‹æ…‹è¾¨è­˜æ¨¡çµ„ | `PATTERN` | HAMMER, HEAD_SHOULDER | JPA + MyBatis |
| åŸºæœ¬é¢æ¨¡çµ„ | `FUNDAMENTAL` | LOW_PE_RATIO, HIGH_ROE | MyBatis |
| ç±Œç¢¼åˆ†ææ¨¡çµ„ | `CHIP` | INSTITUTIONAL_BUY | MyBatis |
| é‡åŒ–ç­–ç•¥æ¨¡çµ„ | `STRATEGY` | MOMENTUM_BUY | MyBatis |
| ç¸½ç¶“ç”¢æ¥­æ¨¡çµ„ | `MACRO` | SECTOR_ROTATION | JPA |
| é¸è‚¡å¼•æ“ | `SCREENER` | TOP_MOMENTUM_STOCKS | MyBatis |

#### 4.2.4 Signal Category åˆ†é¡

```
æŠ€è¡“é¢é¡åˆ¥:
- TREND_FOLLOWING (è¶¨å‹¢è·Ÿéš¨)
- MOMENTUM (å‹•èƒ½)
- REVERSAL (åè½‰)
- VOLUME (æˆäº¤é‡)
- VOLATILITY (æ³¢å‹•)

åŸºæœ¬é¢é¡åˆ¥:
- VALUATION (ä¼°å€¼)
- PROFITABILITY (ç²åˆ©èƒ½åŠ›)
- GROWTH (æˆé•·æ€§)
- FINANCIAL_HEALTH (è²¡å‹™å¥åº·)

ç±Œç¢¼é¢é¡åˆ¥:
- INSTITUTIONAL (æ³•äººå‹•å‘)
- MARGIN (èè³‡èåˆ¸)
- INSIDER (å…§éƒ¨äººæŒè‚¡)
- CONCENTRATION (ç±Œç¢¼é›†ä¸­)

å‹æ…‹é¡åˆ¥:
- CANDLESTICK (Kç·šå‹æ…‹)
- CHART_PATTERN (åœ–è¡¨å‹æ…‹)
- TREND_PATTERN (è¶¨å‹¢å‹æ…‹)
```

#### 4.2.5 Evidence Data çµæ§‹ç¯„ä¾‹

**æŠ€è¡“æŒ‡æ¨™ä¿¡è™Ÿè­‰æ“š**:
```json
{
  "indicator": "MACD",
  "macd_value": 1.25,
  "signal_line": 0.95,
  "histogram": 0.30,
  "condition": "MACD > Signal Line",
  "threshold": 0,
  "calculation_date": "2024-12-22"
}
```

**å‹æ…‹è­˜åˆ¥ä¿¡è™Ÿè­‰æ“š**:
```json
{
  "pattern_type": "HAMMER",
  "pattern_score": 85,
  "candle_count": 1,
  "body_ratio": 0.25,
  "shadow_ratio": 2.5,
  "location": "SUPPORT_LEVEL",
  "confirmation": true
}
```

**åŸºæœ¬é¢ä¿¡è™Ÿè­‰æ“š**:
```json
{
  "metric": "PE_RATIO",
  "current_value": 12.5,
  "industry_average": 18.3,
  "percentile": 25,
  "trend": "IMPROVING",
  "period": "2024Q3"
}
```

#### 4.2.6 ä¿¡è™Ÿå»é‡è¦å‰‡

**å»é‡éµçµ„åˆ**: `stock_id` + `signal_source` + `signal_name` + `signal_date`

**å»é‡é‚è¼¯**:
1. åŒä¸€å¤©ã€åŒä¸€è‚¡ç¥¨ã€åŒä¸€ä¾†æºã€åŒä¸€åç¨±çš„ä¿¡è™Ÿè¦–ç‚ºé‡è¤‡
2. è‹¥å‡ºç¾é‡è¤‡ï¼Œä¿ç•™ `signal_strength` è¼ƒé«˜çš„ä¿¡è™Ÿ
3. è‹¥å¼·åº¦ç›¸åŒï¼Œä¿ç•™æœ€æ–°ç”¢ç”Ÿçš„ä¿¡è™Ÿï¼ˆ`signal_time` è¼ƒæ™šï¼‰
4. è¢«åˆä½µçš„ä¿¡è™Ÿæœƒè¨˜éŒ„ `parent_signal_id` ä¸¦è¨­å®š `is_merged = true`

**å»é‡å¯¦ä½œæ–¹å¼**:
```sql
-- PostgreSQL å»é‡å¯¦ä½œæ–¹å¼

-- æ–¹æ³• 1: ä½¿ç”¨ MD5 + ENCODE
SELECT ENCODE(
    DIGEST(
        CONCAT(stock_id, ':', signal_source, ':', signal_name, ':', signal_date),
        'md5'
    ),
    'hex'
) AS signal_uuid;

-- æ–¹æ³• 2: ä½¿ç”¨ PostgreSQL å…§å»ºçš„ uuid_generate_v5ï¼ˆæ¨è–¦ï¼‰
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
SELECT uuid_generate_v5(
    uuid_ns_url(),
    CONCAT(stock_id, ':', signal_source, ':', signal_name, ':', signal_date)
) AS signal_uuid;
```

#### 4.2.7 ä¿¡è™Ÿåˆä½µè¦å‰‡

ç•¶å¤šå€‹æ¨¡çµ„å°åŒä¸€è‚¡ç¥¨åœ¨åŒä¸€å¤©ç”¢ç”Ÿç›¸åŒæ–¹å‘ï¼ˆBUY/SELLï¼‰çš„ä¿¡è™Ÿæ™‚ï¼Œå¯ä»¥åˆä½µç‚ºä¸€å€‹æ›´å¼·çš„ä¿¡è™Ÿï¼š

**åˆä½µæ¢ä»¶**:
- åŒä¸€ `stock_id`
- åŒä¸€ `signal_date`
- åŒä¸€ `signal_type` (BUY/SELL)
- ä¸åŒ `signal_source` æˆ– `signal_name`

**åˆä½µå¾Œä¿¡è™Ÿç‰¹å¾µ**:
- `signal_name`: é¡¯ç¤ºç‚º "å¤šé‡ä¿¡è™Ÿ (MULTIPLE_SIGNALS)"
- `signal_strength`: åŠ æ¬Šå¹³å‡æˆ–å–æœ€å¤§å€¼
- `confidence_score`: ç¶œåˆè©•åˆ†
- `is_merged`: true
- `merge_count`: åˆä½µçš„ä¿¡è™Ÿæ•¸é‡
- `evidence_data`: åŒ…å«æ‰€æœ‰ä¾†æºä¿¡è™Ÿçš„è­‰æ“š

**åˆä½µæ¬Šé‡ç¯„ä¾‹**:
```
æŠ€è¡“é¢ä¿¡è™Ÿ: 30%
åŸºæœ¬é¢ä¿¡è™Ÿ: 30%
ç±Œç¢¼é¢ä¿¡è™Ÿ: 20%
å‹æ…‹ä¿¡è™Ÿ: 20%
```

#### 4.2.8 ä¿¡è™Ÿç‰ˆæœ¬åŒ–

**ç‰ˆæœ¬æ›´æ–°å ´æ™¯**:
1. ä¿¡è™Ÿåƒæ•¸èª¿æ•´ï¼ˆå¦‚ç›®æ¨™åƒ¹ã€åœæåƒ¹ä¿®æ­£ï¼‰
2. ä¿¡è™Ÿå¼·åº¦é‡æ–°è¨ˆç®—
3. ä¿¡è™Ÿç‹€æ…‹è®Šæ›´ï¼ˆACTIVE â†’ TRIGGEREDï¼‰

**ç‰ˆæœ¬åŒ–è¦å‰‡**:
- æ¯æ¬¡æ›´æ–° `signal_version` è‡ªå¢ 1
- ä¿ç•™æ­·å²ç‰ˆæœ¬ï¼ˆå¯é¸ï¼Œé€é `signal_history` è¡¨ï¼‰
- ä¸»è¡¨å§‹çµ‚é¡¯ç¤ºæœ€æ–°ç‰ˆæœ¬

#### 4.2.9 ä¿¡è™Ÿç”Ÿå‘½é€±æœŸ

```
[ACTIVE] æ–°ç”Ÿæˆçš„ä¿¡è™Ÿï¼Œæœ‰æ•ˆä¸”æœªè§¸ç™¼
   â†“
[TRIGGERED] ä½¿ç”¨è€…å·²åŸ·è¡Œæ“ä½œï¼ˆè²·å…¥/è³£å‡ºï¼‰
   â†“ æˆ–
[EXPIRED] è¶…é valid_until æ™‚é–“ï¼Œä¿¡è™ŸéæœŸ
   â†“ æˆ–
[CANCELLED] æ¢ä»¶ä¸å†æ»¿è¶³ï¼Œä¿¡è™Ÿå–æ¶ˆ
```

**ç‹€æ…‹è½‰æ›è¦å‰‡**:
- `ACTIVE` â†’ `TRIGGERED`: ä½¿ç”¨è€…åŸ·è¡Œäº¤æ˜“
- `ACTIVE` â†’ `EXPIRED`: è¶…éæœ‰æ•ˆæœŸé™
- `ACTIVE` â†’ `CANCELLED`: æ¢ä»¶æ¶ˆå¤±ï¼ˆå¦‚æŠ€è¡“æŒ‡æ¨™åè½‰ï¼‰
- ä»»ä½•ç‹€æ…‹ â†’ `CANCELLED`: æ‰‹å‹•å–æ¶ˆ

---

### 4.3 æŒä¹…å±¤æ¶æ§‹è¨­è¨ˆï¼ˆJPA + MyBatis æ··åˆï¼‰

#### 4.3.1 è¨­è¨ˆåŸå‰‡

**JPA ä½¿ç”¨å ´æ™¯ï¼ˆå„ªå…ˆï¼‰**:
- âœ… ç°¡å–®çš„ CRUD æ“ä½œï¼ˆå–®è¡¨å¢åˆªæ”¹æŸ¥ï¼‰
- âœ… å¯¦é«”é—œè¯æ˜ å°„ï¼ˆOne-to-One, One-to-Many, Many-to-Manyï¼‰
- âœ… åŸºæœ¬æ¢ä»¶æŸ¥è©¢ï¼ˆä½¿ç”¨ Spring Data JPA æ–¹æ³•å‘½åè¦ç¯„ï¼‰
- âœ… åˆ†é èˆ‡æ’åº
- âœ… è³‡æ–™åº« Schema è‡ªå‹•ç®¡ç†ï¼ˆé–‹ç™¼éšæ®µï¼‰

**MyBatis ä½¿ç”¨å ´æ™¯**:
- âœ… è¤‡é›œçš„å¤šè¡¨ JOIN æŸ¥è©¢
- âœ… å‹•æ…‹ SQLï¼ˆæ ¹æ“šæ¢ä»¶å‹•æ…‹çµ„åˆæŸ¥è©¢ï¼‰
- âœ… è¤‡é›œçš„èšåˆçµ±è¨ˆæŸ¥è©¢ï¼ˆGROUP BY, HAVINGï¼‰
- âœ… æ‰¹æ¬¡æ’å…¥/æ›´æ–°ï¼ˆæ•ˆèƒ½å„ªåŒ–ï¼‰
- âœ… åŸç”Ÿ SQL æŸ¥è©¢ï¼ˆåˆ©ç”¨ PostgreSQL ç‰¹æ€§ï¼‰
- âœ… éœ€è¦ç²¾ç´°æ§åˆ¶ SQL çš„å ´æ™¯

#### 4.3.2 å°ˆæ¡ˆçµæ§‹

```
src/main/java/com/stockmonitor/
â”œâ”€â”€ entity/                    # JPA Entity
â”‚   â”œâ”€â”€ Stock.java
â”‚   â”œâ”€â”€ StockPrice.java
â”‚   â”œâ”€â”€ Signal.java
â”‚   â””â”€â”€ ...
â”œâ”€â”€ repository/                # JPA Repository
â”‚   â”œâ”€â”€ StockRepository.java
â”‚   â”œâ”€â”€ StockPriceRepository.java
â”‚   â””â”€â”€ ...
â”œâ”€â”€ mapper/                    # MyBatis Mapper Interface
â”‚   â”œâ”€â”€ SignalMapper.java
â”‚   â”œâ”€â”€ IndicatorMapper.java
â”‚   â”œâ”€â”€ ScreenerMapper.java
â”‚   â””â”€â”€ ...
â”œâ”€â”€ dto/                       # Data Transfer Object
â”‚   â”œâ”€â”€ request/
â”‚   â””â”€â”€ response/
â”œâ”€â”€ service/                   # Business Logic
â”‚   â”œâ”€â”€ StockService.java     # å”èª¿ Repository + Mapper
â”‚   â””â”€â”€ SignalService.java
â””â”€â”€ controller/                # REST API
    â””â”€â”€ ...

src/main/resources/
â”œâ”€â”€ mapper/                    # MyBatis XML Mapper
â”‚   â”œâ”€â”€ SignalMapper.xml
â”‚   â”œâ”€â”€ IndicatorMapper.xml
â”‚   â””â”€â”€ ScreenerMapper.xml
â””â”€â”€ application.yml
```

#### 4.3.3 é…ç½®ç¤ºä¾‹ï¼ˆapplication.ymlï¼‰

```yaml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/stock_monitor
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:password}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: validate  # ç”Ÿç”¢ç’°å¢ƒä½¿ç”¨ validateï¼Œé–‹ç™¼ç’°å¢ƒå¯ç”¨ update
    show-sql: false
    properties:
      hibernate:
        format_sql: true
        jdbc:
          batch_size: 20
        order_inserts: true
        order_updates: true

# MyBatis é…ç½®
mybatis:
  mapper-locations: classpath:mapper/*.xml
  type-aliases-package: com.stockmonitor.entity
  configuration:
    map-underscore-to-camel-case: true
    cache-enabled: true
    lazy-loading-enabled: false
    aggressive-lazy-loading: false
    log-impl: org.apache.ibatis.logging.slf4j.Slf4jImpl

  redis:
    host: ${REDIS_HOST:localhost}
    port: ${REDIS_PORT:6379}
    password: ${REDIS_PASSWORD:}
    database: 0
    lettuce:
      pool:
        max-active: 20
        max-idle: 10
        min-idle: 5

logging:
  level:
    com.stockmonitor.mapper: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
```

#### 4.3.4 Maven ä¾è³´ï¼ˆpom.xmlï¼‰

```xml
<properties>
    <java.version>17</java.version>
    <spring-boot.version>3.2.0</spring-boot.version>
    <postgresql.version>42.7.1</postgresql.version>
    <mybatis-spring-boot.version>3.0.3</mybatis-spring-boot.version>
</properties>

<dependencies>
    <!-- Spring Boot Starter -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
    
    <!-- Spring Data JPA -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-jpa</artifactId>
    </dependency>
    
    <!-- MyBatis Spring Boot Starter -->
    <dependency>
        <groupId>org.mybatis.spring.boot</groupId>
        <artifactId>mybatis-spring-boot-starter</artifactId>
        <version>${mybatis-spring-boot.version}</version>
    </dependency>
    
    <!-- PostgreSQL Driver -->
    <dependency>
        <groupId>org.postgresql</groupId>
        <artifactId>postgresql</artifactId>
        <version>${postgresql.version}</version>
    </dependency>
    
    <!-- Redis -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-redis</artifactId>
    </dependency>
    
    <!-- Hibernate Types for PostgreSQL JSONB -->
    <dependency>
        <groupId>io.hypersistence</groupId>
        <artifactId>hypersistence-utils-hibernate-63</artifactId>
        <version>3.7.0</version>
    </dependency>
    
    <!-- Lombok -->
    <dependency>
        <groupId>org.projectlombok</groupId>
        <artifactId>lombok</artifactId>
        <optional>true</optional>
    </dependency>
    
    <!-- Validation -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-validation</artifactId>
    </dependency>
</dependencies>
```

#### 4.3.5 JPA Entity ç¯„ä¾‹

```java
@Entity
@Table(name = "stocks")
@Data
@NoArgsConstructor
@AllArgsConstructor
public class Stock {
    @Id
    @Column(name = "stock_id", length = 10)
    private String stockId;
    
    @Column(name = "stock_name", length = 50, nullable = false)
    private String stockName;
    
    @Column(name = "market", length = 20)
    private String market;
    
    @Column(name = "industry", length = 50)
    private String industry;
    
    @Column(name = "is_active")
    private Boolean isActive;
    
    @Column(name = "created_at", updatable = false)
    @CreationTimestamp
    private LocalDateTime createdAt;
    
    @Column(name = "updated_at")
    @UpdateTimestamp
    private LocalDateTime updatedAt;
}

@Entity
@Table(name = "signals")
@Data
@TypeDef(name = "jsonb", typeClass = JsonBinaryType.class)
public class Signal {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "signal_id")
    private Long signalId;
    
    @Column(name = "signal_uuid", unique = true, nullable = false)
    private String signalUuid;
    
    @Column(name = "stock_id", nullable = false)
    private String stockId;
    
    @Enumerated(EnumType.STRING)
    @Column(name = "signal_type", nullable = false)
    private SignalType signalType;
    
    // JSONB æ¬„ä½æ˜ å°„
    @Type(JsonBinaryType.class)
    @Column(name = "evidence_data", columnDefinition = "jsonb")
    private Map<String, Object> evidenceData;
    
    @Type(JsonBinaryType.class)
    @Column(name = "technical_factors", columnDefinition = "jsonb")
    private Map<String, Object> technicalFactors;
    
    // ... å…¶ä»–æ¬„ä½
}
```

#### 4.3.6 JPA Repository ç¯„ä¾‹

```java
@Repository
public interface StockRepository extends JpaRepository<Stock, String> {
    
    // ç°¡å–®æ¢ä»¶æŸ¥è©¢ï¼ˆæ–¹æ³•å‘½åè¦ç¯„ï¼‰
    List<Stock> findByMarket(String market);
    
    List<Stock> findByIsActiveTrueAndMarket(String market);
    
    Optional<Stock> findByStockId(String stockId);
    
    // ä½¿ç”¨ @Query è¨»è§£
    @Query("SELECT s FROM Stock s WHERE s.industry = :industry AND s.isActive = true")
    List<Stock> findActiveStocksByIndustry(@Param("industry") String industry);
}

@Repository
public interface SignalRepository extends JpaRepository<Signal, Long> {
    
    List<Signal> findByStockIdAndSignalDate(String stockId, LocalDate signalDate);
    
    boolean existsBySignalUuid(String signalUuid);
    
    @Query("SELECT s FROM Signal s WHERE s.stockId = :stockId " +
           "AND s.signalType = :type AND s.signalStatus = 'ACTIVE'")
    List<Signal> findActiveSignals(@Param("stockId") String stockId, 
                                    @Param("type") SignalType type);
}
```

#### 4.3.7 MyBatis Mapper Interface ç¯„ä¾‹

```java
@Mapper
public interface SignalMapper {
    
    /**
     * è¤‡é›œçš„ä¿¡è™ŸæŸ¥è©¢ï¼ˆå¤šæ¢ä»¶å‹•æ…‹ SQLï¼‰
     */
    List<SignalDTO> searchSignals(@Param("criteria") SignalSearchCriteria criteria);
    
    /**
     * çµ±è¨ˆåˆ†ææŸ¥è©¢
     */
    List<SignalStatDTO> getSignalStatsBySource(@Param("startDate") LocalDate startDate,
                                                @Param("endDate") LocalDate endDate);
    
    /**
     * æ‰¹æ¬¡æ’å…¥ä¿¡è™Ÿ
     */
    void batchInsertSignals(@Param("signals") List<Signal> signals);
    
    /**
     * ä½¿ç”¨ PostgreSQL JSONB æŸ¥è©¢
     */
    List<SignalDTO> findSignalsByEvidenceData(@Param("indicator") String indicator,
                                               @Param("minValue") BigDecimal minValue);
}

@Mapper
public interface IndicatorMapper {
    
    /**
     * è¤‡é›œçš„æŒ‡æ¨™è¨ˆç®—æŸ¥è©¢
     */
    List<IndicatorDTO> calculateCrossoverSignals(@Param("stockId") String stockId,
                                                  @Param("period") int period);
    
    /**
     * æ‰¹æ¬¡è¨ˆç®—æŒ‡æ¨™
     */
    void batchCalculateIndicators(@Param("stockIds") List<String> stockIds,
                                   @Param("date") LocalDate date);
}

@Mapper
public interface ScreenerMapper {
    
    /**
     * é¸è‚¡å¼•æ“ - è¤‡é›œå¤šæ¢ä»¶ç¯©é¸
     */
    List<StockDTO> screenStocks(@Param("criteria") StockScreenCriteria criteria);
}
```

#### 4.3.8 MyBatis XML Mapper ç¯„ä¾‹

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.stockmonitor.mapper.SignalMapper">

    <resultMap id="SignalDTOMap" type="com.stockmonitor.dto.SignalDTO">
        <id property="signalId" column="signal_id"/>
        <result property="stockId" column="stock_id"/>
        <result property="signalType" column="signal_type"/>
        <result property="evidenceData" column="evidence_data" 
                typeHandler="org.apache.ibatis.type.JsonTypeHandler"/>
    </resultMap>

    <!-- è¤‡é›œå‹•æ…‹æŸ¥è©¢ -->
    <select id="searchSignals" resultMap="SignalDTOMap">
        SELECT 
            s.signal_id,
            s.stock_id,
            s.signal_type,
            s.signal_strength,
            s.evidence_data
        FROM signals s
        <where>
            <if test="criteria.stockIds != null and criteria.stockIds.size() > 0">
                AND s.stock_id IN
                <foreach collection="criteria.stockIds" item="stockId" 
                         open="(" separator="," close=")">
                    #{stockId}
                </foreach>
            </if>
            <if test="criteria.minStrength != null">
                AND s.signal_strength >= #{criteria.minStrength}
            </if>
            <!-- PostgreSQL JSONB æŸ¥è©¢ -->
            <if test="criteria.indicator != null">
                AND s.evidence_data ->> 'indicator' = #{criteria.indicator}
            </if>
        </where>
        ORDER BY s.signal_date DESC
    </select>

    <!-- æ‰¹æ¬¡æ’å…¥ï¼ˆPostgreSQL èªæ³•ï¼‰ -->
    <insert id="batchInsertSignals">
        INSERT INTO signals (
            signal_uuid, stock_id, signal_type, signal_source, 
            signal_strength, evidence_data, created_at
        ) VALUES
        <foreach collection="signals" item="signal" separator=",">
            (
                #{signal.signalUuid},
                #{signal.stockId},
                #{signal.signalType}::VARCHAR,
                #{signal.signalSource},
                #{signal.signalStrength},
                #{signal.evidenceData, typeHandler=org.apache.ibatis.type.JsonTypeHandler}::jsonb,
                CURRENT_TIMESTAMP
            )
        </foreach>
        ON CONFLICT (signal_uuid) DO UPDATE SET
            signal_strength = EXCLUDED.signal_strength,
            updated_at = CURRENT_TIMESTAMP
    </insert>

    <!-- PostgreSQL JSONB æŸ¥è©¢ -->
    <select id="findSignalsByEvidenceData" resultMap="SignalDTOMap">
        SELECT * FROM signals
        WHERE evidence_data ->> 'indicator' = #{indicator}
          AND (evidence_data ->> 'macd_value')::numeric >= #{minValue}
        ORDER BY signal_date DESC
    </select>

</mapper>
```

#### 4.3.9 Service å±¤æ•´åˆç¯„ä¾‹

```java
@Service
@Transactional
@Slf4j
public class SignalService {
    
    @Autowired
    private SignalRepository signalRepository;  // JPA
    
    @Autowired
    private SignalMapper signalMapper;          // MyBatis
    
    /**
     * ç°¡å–®æŸ¥è©¢ä½¿ç”¨ JPA
     */
    public Optional<Signal> getSignalById(Long signalId) {
        return signalRepository.findById(signalId);
    }
    
    /**
     * è¤‡é›œæŸ¥è©¢ä½¿ç”¨ MyBatis
     */
    public List<SignalDTO> searchSignals(SignalSearchCriteria criteria) {
        return signalMapper.searchSignals(criteria);
    }
    
    /**
     * å–®ç­†æ’å…¥ä½¿ç”¨ JPA
     */
    public Signal createSignal(Signal signal) {
        return signalRepository.save(signal);
    }
    
    /**
     * æ‰¹æ¬¡æ’å…¥ä½¿ç”¨ MyBatisï¼ˆæ•ˆèƒ½æ›´å¥½ï¼‰
     */
    public void batchCreateSignals(List<Signal> signals) {
        signalMapper.batchInsertSignals(signals);
    }
}
```

#### 4.3.10 æœ€ä½³å¯¦è¸

**é¸æ“‡ JPA é‚„æ˜¯ MyBatisï¼Ÿ**

```
ä½¿ç”¨ JPAï¼š
âœ… å–®è¡¨ CRUD
âœ… ç°¡å–®æ¢ä»¶æŸ¥è©¢
âœ… å¯¦é«”é—œè¯æ“ä½œ
âœ… å¿«é€Ÿé–‹ç™¼

ä½¿ç”¨ MyBatisï¼š
âœ… è¤‡é›œå¤šè¡¨ JOIN
âœ… å‹•æ…‹ SQL
âœ… æ‰¹æ¬¡æ“ä½œ
âœ… PostgreSQL ç‰¹å®šåŠŸèƒ½
```

---


### 4.4 API çµ±ä¸€è¦ç¯„

#### 4.4.1 Base URL èˆ‡è·¯å¾‘è¦ç¯„

**ç’°å¢ƒé…ç½®**:
```
é–‹ç™¼ç’°å¢ƒ: http://localhost:8080/api
æ¸¬è©¦ç’°å¢ƒ: https://test-api.stockmonitor.com/api
ç”Ÿç”¢ç’°å¢ƒ: https://api.stockmonitor.com/api
```

**è·¯å¾‘è¨­è¨ˆåŸå‰‡**:
- æ¡ç”¨è³‡æºå°å‘çš„ RESTful è¨­è¨ˆ
- åŸºç¤è·¯å¾‘: `/api`
- è³‡æºè·¯å¾‘ä½¿ç”¨è¤‡æ•¸åè©ï¼ˆå¦‚ `/stocks`, `/stock-prices`ï¼‰
- ä½¿ç”¨æ¨™æº– HTTP æ–¹æ³•è¡¨é”æ“ä½œæ„åœ–ï¼ˆGET, POST, PUT, DELETEï¼‰

**è·¯å¾‘ç¯„ä¾‹**:
```
è‚¡ç¥¨è³‡æº:
- GET    /api/stocks              å–å¾—è‚¡ç¥¨åˆ—è¡¨
- GET    /api/stocks/{stockId}    å–å¾—å–®ä¸€è‚¡ç¥¨
- POST   /api/stocks              å»ºç«‹è‚¡ç¥¨
- PUT    /api/stocks/{stockId}    æ›´æ–°è‚¡ç¥¨
- DELETE /api/stocks/{stockId}    åˆªé™¤è‚¡ç¥¨

è‚¡åƒ¹è³‡æº:
- GET    /api/stock-prices        å–å¾—è‚¡åƒ¹åˆ—è¡¨
- GET    /api/stock-prices/{id}   å–å¾—å–®ä¸€è‚¡åƒ¹è¨˜éŒ„

æŠ€è¡“æŒ‡æ¨™:
- GET    /api/indicators          å–å¾—æŒ‡æ¨™åˆ—è¡¨
- POST   /api/indicators/calculate è¨ˆç®—æŒ‡æ¨™

ä¿¡è™Ÿè³‡æº:
- GET    /api/signals             å–å¾—ä¿¡è™Ÿåˆ—è¡¨
- POST   /api/signals/detect      åµæ¸¬ä¿¡è™Ÿ
```

**æ‡‰ç”¨ç¨‹å¼ç‰ˆæœ¬ç®¡ç†**:
- ç‰ˆæœ¬è™Ÿæ ¼å¼: `MAJOR.MINOR.PATCH`ï¼ˆå¦‚ 1.0.0ï¼‰
- ç‰ˆæœ¬è™Ÿè¨˜éŒ„åœ¨æ‡‰ç”¨ç¨‹å¼é…ç½®å’Œ API å›æ‡‰ä¸­
- é‡å¤§åŠŸèƒ½æ›´æ–°æ™‚å‡ç´š MINOR ç‰ˆæœ¬
- ä¸ç›¸å®¹è®Šæ›´æ™‚å‡ç´š MAJOR ç‰ˆæœ¬

**ç›¸å®¹æ€§åŸå‰‡**:
- æ–°å¢æ¬„ä½: ä¸å½±éŸ¿ç¾æœ‰å®¢æˆ¶ç«¯ï¼ˆé¸å¡«æ¬„ä½ï¼‰
- ä¿®æ”¹æ¬„ä½: æå‰é€šçŸ¥ï¼Œæä¾›é·ç§»æ™‚é–“
- åˆªé™¤æ¬„ä½: è‡³å°‘æå‰ 3 å€‹æœˆé€šçŸ¥
- ä¸ç›¸å®¹è®Šæ›´: è©•ä¼°å½±éŸ¿ï¼Œå”èª¿æ‰€æœ‰å®¢æˆ¶ç«¯å‡ç´š

#### 4.4.2 çµ±ä¸€ Response æ ¼å¼

**æˆåŠŸå›æ‡‰** (HTTP 200):
```json
{
  "code": 200,
  "message": "Success",
  "data": {
    // å¯¦éš›è³‡æ–™å…§å®¹
  },
  "timestamp": "2024-12-22T13:30:00+08:00",
  "trace_id": "req_abc123xyz"
}
```

**æˆåŠŸå›æ‡‰ (åˆ—è¡¨è³‡æ–™ï¼Œå«åˆ†é )**:
```json
{
  "code": 200,
  "message": "Success",
  "data": {
    "items": [
      // è³‡æ–™é …ç›®
    ],
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total_items": 156,
      "total_pages": 8,
      "has_next": true,
      "has_prev": false
    }
  },
  "timestamp": "2024-12-22T13:30:00+08:00",
  "trace_id": "req_abc123xyz"
}
```

**éŒ¯èª¤å›æ‡‰**:
```json
{
  "code": 404,
  "message": "Stock not found",
  "error": {
    "error_code": "RESOURCE_NOT_FOUND",
    "error_type": "CLIENT_ERROR",
    "details": "Stock with ID '9999' does not exist",
    "field": "stock_id",
    "suggestion": "Please check the stock ID and try again"
  },
  "timestamp": "2024-12-22T13:30:00+08:00",
  "trace_id": "req_abc123xyz"
}
```

#### 4.4.3 HTTP ç‹€æ…‹ç¢¼è¦ç¯„

| ç‹€æ…‹ç¢¼ | èªªæ˜ | ä½¿ç”¨å ´æ™¯ |
|-------|------|---------|
| 200 | OK | è«‹æ±‚æˆåŠŸ |
| 201 | Created | è³‡æºå‰µå»ºæˆåŠŸ |
| 204 | No Content | æ“ä½œæˆåŠŸä½†ç„¡å›æ‡‰å…§å®¹ï¼ˆå¦‚ DELETEï¼‰ |
| 400 | Bad Request | è«‹æ±‚åƒæ•¸éŒ¯èª¤ |
| 401 | Unauthorized | æœªèªè­‰ï¼ˆéœ€ç™»å…¥ï¼‰ |
| 403 | Forbidden | ç„¡æ¬Šé™è¨ªå• |
| 404 | Not Found | è³‡æºä¸å­˜åœ¨ |
| 409 | Conflict | è³‡æºè¡çªï¼ˆå¦‚é‡è¤‡å‰µå»ºï¼‰ |
| 422 | Unprocessable Entity | è«‹æ±‚æ ¼å¼æ­£ç¢ºä½†èªæ„éŒ¯èª¤ |
| 429 | Too Many Requests | è«‹æ±‚æ¬¡æ•¸è¶…éé™åˆ¶ |
| 500 | Internal Server Error | ä¼ºæœå™¨å…§éƒ¨éŒ¯èª¤ |
| 503 | Service Unavailable | æœå‹™æš«æ™‚ä¸å¯ç”¨ |

#### 4.4.4 éŒ¯èª¤ç¢¼å®šç¾©

```java
// éŒ¯èª¤ç¢¼æ ¼å¼: {æ¨¡çµ„ä»£ç¢¼}{éŒ¯èª¤é¡åˆ¥}{åºè™Ÿ}
// ä¾‹å¦‚: M06_DATA_001

public enum ErrorCode {
    // é€šç”¨éŒ¯èª¤ (00xxx)
    INVALID_REQUEST(400, "00001", "Invalid request parameters"),
    UNAUTHORIZED(401, "00002", "Authentication required"),
    FORBIDDEN(403, "00003", "Access denied"),
    RESOURCE_NOT_FOUND(404, "00004", "Resource not found"),
    INTERNAL_ERROR(500, "00005", "Internal server error"),
    
    // è³‡æ–™ç®¡ç†æ¨¡çµ„ (M06xxx)
    DATA_FETCH_FAILED(500, "M06001", "Failed to fetch data from external API"),
    DATA_VALIDATION_FAILED(422, "M06002", "Data validation failed"),
    DATA_ALREADY_EXISTS(409, "M06003", "Data already exists"),
    
    // æŠ€è¡“åˆ†ææ¨¡çµ„ (M07xxx)
    INDICATOR_CALCULATION_FAILED(500, "M07001", "Failed to calculate indicator"),
    INSUFFICIENT_DATA(422, "M07002", "Insufficient data for calculation"),
    
    // ä¿¡è™Ÿåˆ¤æ–·å¼•æ“ (M13xxx)
    SIGNAL_GENERATION_FAILED(500, "M13001", "Failed to generate signal"),
    DUPLICATE_SIGNAL(409, "M13002", "Duplicate signal detected"),
    
    // è­¦å ±é€šçŸ¥ç³»çµ± (M15xxx)
    NOTIFICATION_SEND_FAILED(500, "M15001", "Failed to send notification"),
    NOTIFICATION_RATE_LIMIT(429, "M15002", "Notification rate limit exceeded"),
    
    // ... å…¶ä»–æ¨¡çµ„éŒ¯èª¤ç¢¼
}
```

#### 4.4.5 åˆ†é åƒæ•¸è¦ç¯„

**Query Parameters**:
```
GET /api/signals?page=1&page_size=20&sort_by=signal_time&order=desc
```

| åƒæ•¸ | é¡å‹ | é è¨­å€¼ | èªªæ˜ |
|-----|------|--------|------|
| page | Integer | 1 | é ç¢¼ï¼ˆå¾ 1 é–‹å§‹ï¼‰ |
| page_size | Integer | 20 | æ¯é ç­†æ•¸ï¼ˆæœ€å¤§ 100ï¼‰ |
| sort_by | String | - | æ’åºæ¬„ä½ |
| order | String | asc | æ’åºæ–¹å‘ï¼ˆasc/descï¼‰ |

#### 4.4.6 æ—¥æœŸæ™‚é–“æ ¼å¼è¦ç¯„

**çµ±ä¸€ä½¿ç”¨ ISO 8601 æ ¼å¼**:
- æ—¥æœŸ: `YYYY-MM-DD` (ä¾‹: `2024-12-22`)
- æ—¥æœŸæ™‚é–“: `YYYY-MM-DDTHH:mm:ss+08:00` (ä¾‹: `2024-12-22T13:30:00+08:00`)
- æ™‚å€: å°åŒ—æ™‚é–“ (UTC+8)

**Query Parameter ä¸­çš„æ—¥æœŸç¯„åœ**:
```
GET /api/stock-prices?stock_id=2330&start_date=2024-01-01&end_date=2024-12-22
```

#### 4.4.7 èªè­‰èˆ‡æˆæ¬Šè¦ç¯„

**JWT Token ä½¿ç”¨**:
```
Authorization: Bearer {jwt_token}
```

**Token çµæ§‹**:
```json
{
  "user_id": "user123",
  "username": "john_doe",
  "roles": ["USER", "PREMIUM"],
  "permissions": ["READ_STOCK", "CREATE_ALERT"],
  "exp": 1735654800,
  "iat": 1735568400
}
```

**Token éæœŸæ™‚é–“**:
- Access Token: 2 å°æ™‚
- Refresh Token: 7 å¤©

#### 4.4.8 API å‘½åè¦ç¯„

**RESTful è³‡æºå‘½å**:
- ä½¿ç”¨è¤‡æ•¸åè©: `/stocks`, `/signals`, `/alerts`
- ä½¿ç”¨å°å¯«èˆ‡é€£å­—ç¬¦: `/stock-prices`, `/technical-indicators`
- é¿å…å‹•è©: âŒ `/getStock` â†’ âœ… `GET /stocks/{id}`

**å¸¸è¦‹ API æ“ä½œ**:
```
GET    /api/stocks              # åˆ—å‡ºæ‰€æœ‰è‚¡ç¥¨
GET    /api/stocks/{id}         # å–å¾—å–®ä¸€è‚¡ç¥¨
POST   /api/stocks              # å‰µå»ºè‚¡ç¥¨
PUT    /api/stocks/{id}         # å®Œæ•´æ›´æ–°è‚¡ç¥¨
PATCH  /api/stocks/{id}         # éƒ¨åˆ†æ›´æ–°è‚¡ç¥¨
DELETE /api/stocks/{id}         # åˆªé™¤è‚¡ç¥¨

GET    /api/stocks/{id}/prices  # å–å¾—è‚¡ç¥¨çš„åƒ¹æ ¼æ­·å²
```

#### 4.4.9 API æ–‡æª”è¦ç¯„ (Swagger/OpenAPI)

æ¯å€‹ API å¿…é ˆåŒ…å«ä»¥ä¸‹è¨»è§£:
```java
@Tag(name = "Stock Management", description = "è‚¡ç¥¨è³‡æ–™ç®¡ç†ç›¸é—œ API")
@RestController
@RequestMapping("/api/stocks")
public class StockController {
    
    @Operation(
        summary = "å–å¾—è‚¡ç¥¨è³‡æ–™",
        description = "æ ¹æ“šè‚¡ç¥¨ä»£ç¢¼å–å¾—è©³ç´°è³‡æ–™"
    )
    @ApiResponses({
        @ApiResponse(responseCode = "200", description = "æˆåŠŸå–å¾—è‚¡ç¥¨è³‡æ–™"),
        @ApiResponse(responseCode = "404", description = "è‚¡ç¥¨ä¸å­˜åœ¨")
    })
    @GetMapping("/{stockId}")
    public ResponseEntity<ApiResponse<StockDTO>> getStock(
        @Parameter(description = "è‚¡ç¥¨ä»£ç¢¼", example = "2330")
        @PathVariable String stockId
    ) {
        // ...
    }
}
```

---

### 4.5 Job/æ’ç¨‹æ¨¡å‹

#### 4.5.1 Job å®šç¾©

**Job**: ç³»çµ±ä¸­å¯è¿½è¹¤ã€å¯é‡è·‘ã€æœ‰ç‹€æ…‹çš„æ‰¹æ¬¡ä½œæ¥­å–®ä½ã€‚

**æ ¸å¿ƒç‰¹æ€§**:
- âœ… å¯è¿½è¹¤: æ¯æ¬¡åŸ·è¡Œæœ‰å”¯ä¸€ `job_execution_id`
- âœ… æœ‰ç‹€æ…‹: PENDING â†’ RUNNING â†’ SUCCESS/FAILED
- âœ… å¯é‡è·‘: å¤±æ•—çš„ Job å¯ä»¥æ‰‹å‹•æˆ–è‡ªå‹•é‡æ–°åŸ·è¡Œ
- âœ… å†ªç­‰æ€§: é‡è¤‡åŸ·è¡ŒåŒä¸€ Job ä¸æœƒç”¢ç”Ÿå‰¯ä½œç”¨

#### 4.5.2 Job åŸ·è¡Œè¨˜éŒ„è¡¨

```sql
-- PostgreSQL ç‰ˆæœ¬
CREATE TABLE job_executions (
    execution_id        BIGSERIAL PRIMARY KEY,
    job_name            VARCHAR(100) NOT NULL,
    job_type            VARCHAR(50) NOT NULL,
    job_status          VARCHAR(20) NOT NULL 
        CHECK (job_status IN ('PENDING', 'RUNNING', 'SUCCESS', 'FAILED', 'CANCELLED')),
    
    -- åŸ·è¡Œåƒæ•¸ï¼ˆä½¿ç”¨ JSONBï¼‰
    parameters          JSONB,
    
    -- åŸ·è¡Œè³‡è¨Š
    start_time          TIMESTAMP,
    end_time            TIMESTAMP,
    duration_ms         BIGINT,
    
    -- çµæœçµ±è¨ˆ
    total_items         INTEGER,
    processed_items     INTEGER,
    success_items       INTEGER,
    failed_items        INTEGER,
    
    -- éŒ¯èª¤è³‡è¨Š
    error_message       TEXT,
    error_stack_trace   TEXT,
    
    -- é‡è©¦è³‡è¨Š
    retry_count         INTEGER DEFAULT 0,
    max_retry           INTEGER DEFAULT 3,
    parent_execution_id BIGINT,
    
    -- è§¸ç™¼æ–¹å¼
    trigger_type        VARCHAR(20) NOT NULL 
        CHECK (trigger_type IN ('SCHEDULED', 'MANUAL', 'EVENT', 'RETRY')),
    triggered_by        VARCHAR(50),
    
    -- å¯©è¨ˆ
    created_at          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at          TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_job_executions_name ON job_executions(job_name);
CREATE INDEX idx_job_executions_status ON job_executions(job_status);
CREATE INDEX idx_job_executions_start_time ON job_executions(start_time);
CREATE INDEX idx_job_executions_type ON job_executions(job_type);

-- è‡ªå‹•æ›´æ–° updated_at
CREATE TRIGGER update_job_executions_updated_at
    BEFORE UPDATE ON job_executions
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();

COMMENT ON TABLE job_executions IS 'JobåŸ·è¡Œè¨˜éŒ„è¡¨';
```

#### 4.5.3 Job é¡å‹å®šç¾©

| Job Type | Job Name | èªªæ˜ | åŸ·è¡Œé »ç‡ |
|----------|----------|------|---------|
| DATA_SYNC | SYNC_STOCK_PRICES | åŒæ­¥è‚¡åƒ¹è³‡æ–™ | æ¯æ—¥ 15:00 |
| DATA_SYNC | SYNC_FINANCIAL_DATA | åŒæ­¥è²¡å ±è³‡æ–™ | æ¯å­£è²¡å ±å…¬å‘Šå¾Œ |
| DATA_SYNC | SYNC_CHIP_DATA | åŒæ­¥ç±Œç¢¼è³‡æ–™ | æ¯æ—¥ 15:30 |
| CALCULATION | CALC_TECHNICAL_INDICATORS | è¨ˆç®—æŠ€è¡“æŒ‡æ¨™ | æ¯æ—¥ 16:00 |
| CALCULATION | CALC_FUNDAMENTAL_INDICATORS | è¨ˆç®—åŸºæœ¬é¢æŒ‡æ¨™ | æ¯å­£ |
| SIGNAL_DETECTION | DETECT_TECHNICAL_SIGNALS | åµæ¸¬æŠ€è¡“é¢ä¿¡è™Ÿ | æ¯æ—¥ 17:00 |
| SIGNAL_DETECTION | DETECT_PATTERN_SIGNALS | åµæ¸¬å‹æ…‹ä¿¡è™Ÿ | æ¯æ—¥ 17:00 |
| SIGNAL_DETECTION | DETECT_FUNDAMENTAL_SIGNALS | åµæ¸¬åŸºæœ¬é¢ä¿¡è™Ÿ | æ¯é€±ä¸€ |
| NOTIFICATION | SEND_DAILY_ALERTS | ç™¼é€æ¯æ—¥è­¦å ± | æ¯æ—¥ 18:00 |
| NOTIFICATION | SEND_SIGNAL_NOTIFICATIONS | ç™¼é€ä¿¡è™Ÿé€šçŸ¥ | å³æ™‚ï¼ˆäº‹ä»¶è§¸ç™¼ï¼‰ |
| MAINTENANCE | CLEANUP_EXPIRED_SIGNALS | æ¸…ç†éæœŸä¿¡è™Ÿ | æ¯æ—¥ 01:00 |
| MAINTENANCE | CLEANUP_OLD_LOGS | æ¸…ç†èˆŠæ—¥èªŒ | æ¯é€±æ—¥ 02:00 |

#### 4.5.4 Job ç‹€æ…‹æ©Ÿ

```
[PENDING] Job å·²æ’ç¨‹ï¼Œç­‰å¾…åŸ·è¡Œ
    â†“
[RUNNING] Job æ­£åœ¨åŸ·è¡Œä¸­
    â†“
    â”œâ”€â†’ [SUCCESS] Job åŸ·è¡ŒæˆåŠŸ
    â”œâ”€â†’ [FAILED] Job åŸ·è¡Œå¤±æ•—ï¼ˆå¯é‡è©¦ï¼‰
    â””â”€â†’ [CANCELLED] Job è¢«å–æ¶ˆ
    
FAILED ç‹€æ…‹è™•ç†:
- è‹¥ retry_count < max_retry: è‡ªå‹•é‡è©¦ï¼ˆå»¶é² 5 åˆ†é˜ï¼‰
- è‹¥ retry_count >= max_retry: ç™¼é€å‘Šè­¦é€šçŸ¥
```

#### 4.5.5 Job æ’ç¨‹è¨­å®š

**ä½¿ç”¨ Spring @Scheduled è¨»è§£**:
```java
@Scheduled(cron = "0 0 15 * * MON-FRI") // æ¯å€‹äº¤æ˜“æ—¥ 15:00
public void syncStockPrices() {
    jobExecutionService.executeJob("SYNC_STOCK_PRICES", null, "SCHEDULED");
}
```

**Cron è¡¨é”å¼è¦ç¯„**:
```
æ ¼å¼: ç§’ åˆ† æ™‚ æ—¥ æœˆ é€±
ç¯„ä¾‹:
- "0 0 15 * * MON-FRI" : é€±ä¸€åˆ°é€±äº” 15:00
- "0 30 15 * * *"      : æ¯å¤© 15:30
- "0 0 1 * * SUN"      : æ¯é€±æ—¥ 01:00
- "0 0 18 * * *"       : æ¯å¤© 18:00
```

**é‡è¦æ™‚é–“é»è¦åŠƒ**:
```
13:30 - å°è‚¡æ”¶ç›¤
14:00 - é–‹å§‹æº–å‚™è³‡æ–™åŒæ­¥
15:00 - åŒæ­¥è‚¡åƒ¹è³‡æ–™ (SYNC_STOCK_PRICES)
15:30 - åŒæ­¥ç±Œç¢¼è³‡æ–™ (SYNC_CHIP_DATA)
16:00 - è¨ˆç®—æŠ€è¡“æŒ‡æ¨™ (CALC_TECHNICAL_INDICATORS)
16:30 - è¨ˆç®—å‹æ…‹è­˜åˆ¥ (CALC_PATTERN_RECOGNITION)
17:00 - åµæ¸¬æŠ€è¡“é¢ä¿¡è™Ÿ (DETECT_TECHNICAL_SIGNALS)
17:30 - åµæ¸¬å‹æ…‹ä¿¡è™Ÿ (DETECT_PATTERN_SIGNALS)
18:00 - ç™¼é€æ¯æ—¥è­¦å ± (SEND_DAILY_ALERTS)
01:00 - æ¸…ç†éæœŸè³‡æ–™ (CLEANUP_EXPIRED_SIGNALS)
```

#### 4.5.6 Job å†ªç­‰æ€§è¨­è¨ˆ

**å†ªç­‰æ€§è¦æ±‚**: åŒä¸€ Job ä½¿ç”¨ç›¸åŒåƒæ•¸åŸ·è¡Œå¤šæ¬¡ï¼Œçµæœå¿…é ˆä¸€è‡´ã€‚

**å¯¦ä½œç­–ç•¥**:

1. **è³‡æ–™åŒæ­¥ Job (SYNC_XXX)**:
   ```sql
   -- ä½¿ç”¨ UPSERT (INSERT ... ON DUPLICATE KEY UPDATE)
   INSERT INTO stock_prices (stock_id, trade_date, close_price, ..., updated_at)
   VALUES ('2330', '2024-12-22', 580.00, ..., NOW())
   ON DUPLICATE KEY UPDATE
       close_price = VALUES(close_price),
       updated_at = NOW();
   ```

2. **è¨ˆç®— Job (CALC_XXX)**:
   ```java
   // å…ˆåˆªé™¤è©²æ—¥æœŸçš„è¨ˆç®—çµæœï¼Œå†é‡æ–°è¨ˆç®—
   indicatorRepository.deleteByStockIdAndDate(stockId, date);
   // é‡æ–°è¨ˆç®—ä¸¦å„²å­˜
   indicatorRepository.saveAll(newIndicators);
   ```

3. **ä¿¡è™Ÿåµæ¸¬ Job (DETECT_XXX)**:
   ```java
   // ä½¿ç”¨ signal_uuid ç¢ºä¿å”¯ä¸€æ€§
   String signalUuid = generateSignalUuid(stockId, source, name, date);
   if (signalRepository.existsByUuid(signalUuid)) {
       // æ›´æ–°ç¾æœ‰ä¿¡è™Ÿ
       signalRepository.updateByUuid(signalUuid, signalData);
   } else {
       // å‰µå»ºæ–°ä¿¡è™Ÿ
       signalRepository.save(newSignal);
   }
   ```

4. **é€šçŸ¥ Job (SEND_XXX)**:
   ```java
   // æª¢æŸ¥æ˜¯å¦å·²é€šçŸ¥ï¼ˆä½¿ç”¨å»é‡éµï¼‰
   String notificationKey = generateNotificationKey(userId, signalId, channel);
   if (redisTemplate.hasKey(notificationKey)) {
       logger.info("Notification already sent, skip");
       return;
   }
   // ç™¼é€é€šçŸ¥
   notificationService.send(notification);
   // è¨˜éŒ„å·²é€šçŸ¥ï¼ˆTTL 24å°æ™‚ï¼‰
   redisTemplate.opsForValue().set(notificationKey, "sent", 24, TimeUnit.HOURS);
   ```

#### 4.5.7 Job é‡è·‘æ©Ÿåˆ¶

**æ‰‹å‹•é‡è·‘**:
```java
@PostMapping("/api/jobs/{executionId}/rerun")
public ResponseEntity<ApiResponse<JobExecution>> rerunJob(@PathVariable Long executionId) {
    JobExecution newExecution = jobService.rerunJob(executionId);
    return ResponseEntity.ok(ApiResponse.success(newExecution));
}
```

**è‡ªå‹•é‡è©¦**:
```java
@Retryable(
    value = {DataAccessException.class, ExternalApiException.class},
    maxAttempts = 3,
    backoff = @Backoff(delay = 5000, multiplier = 2)
)
public void syncStockPrices() {
    // Job é‚è¼¯
}
```

**é‡è·‘æ¢ä»¶**:
- Job ç‹€æ…‹ç‚º `FAILED`
- æœªè¶…é `max_retry` æ¬¡æ•¸
- éŒ¯èª¤é¡å‹ç‚ºå¯é‡è©¦éŒ¯èª¤ï¼ˆç¶²è·¯éŒ¯èª¤ã€æš«æ™‚æ€§å¤±æ•—ç­‰ï¼‰

#### 4.5.8 Job ç›£æ§èˆ‡å‘Šè­¦

**ç›£æ§æŒ‡æ¨™**:
- Job åŸ·è¡ŒæˆåŠŸç‡ï¼ˆéå» 24 å°æ™‚ï¼‰
- Job å¹³å‡åŸ·è¡Œæ™‚é•·
- Job å¤±æ•—æ¬¡æ•¸
- Job ç­‰å¾…ä½‡åˆ—é•·åº¦

**å‘Šè­¦æ¢ä»¶**:
- é—œéµ Job é€£çºŒå¤±æ•— 3 æ¬¡
- Job åŸ·è¡Œæ™‚é•·è¶…éé æœŸ 2 å€
- Job ç­‰å¾…ä½‡åˆ—ç©å£“è¶…é 10 å€‹

**å‘Šè­¦é€šé“**:
- Email é€šçŸ¥é–‹ç™¼åœ˜éšŠ
- Slack/Discord å³æ™‚é€šçŸ¥
- ç³»çµ±æ—¥èªŒè¨˜éŒ„

---

### 4.6 æ¬Šé™æ¨¡å‹ (RBAC)

#### 4.6.1 è§’è‰²å®šç¾©

| è§’è‰²ä»£ç¢¼ | è§’è‰²åç¨± | èªªæ˜ | é è¨­æ¬Šé™ |
|---------|---------|------|---------|
| GUEST | è¨ªå®¢ | æœªç™»å…¥ä½¿ç”¨è€… | åƒ…èƒ½æŸ¥çœ‹å…¬é–‹è³‡æ–™ |
| USER | ä¸€èˆ¬ä½¿ç”¨è€… | å·²è¨»å†Šçš„å…è²»ä½¿ç”¨è€… | åŸºæœ¬æŸ¥è©¢ã€è‡ªé¸è‚¡ã€è­¦å ±ï¼ˆé™åˆ¶æ•¸é‡ï¼‰ |
| PREMIUM | ä»˜è²»ä½¿ç”¨è€… | ä»˜è²»æœƒå“¡ | ç„¡é™åˆ¶è­¦å ±ã€å›æ¸¬ã€é€²éšæŒ‡æ¨™ |
| ADMIN | ç³»çµ±ç®¡ç†å“¡ | ç³»çµ±ç¶­è­·äººå“¡ | æ‰€æœ‰åŠŸèƒ½ + ç³»çµ±ç®¡ç† |
| API_USER | API ä½¿ç”¨è€… | é€é API å­˜å–çš„å¤–éƒ¨ç³»çµ± | API å­˜å–æ¬Šé™ï¼ˆéœ€ API Keyï¼‰ |

#### 4.6.2 æ¬Šé™å®šç¾©

```sql
-- PostgreSQL ç‰ˆæœ¬
CREATE TABLE permissions (
    permission_id   SERIAL PRIMARY KEY,
    permission_code VARCHAR(50) NOT NULL UNIQUE,
    permission_name VARCHAR(100) NOT NULL,
    description     VARCHAR(255),
    resource_type   VARCHAR(50),
    action_type     VARCHAR(50),
    created_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_permissions_code ON permissions(permission_code);

COMMENT ON TABLE permissions IS 'æ¬Šé™å®šç¾©è¡¨';


-- æ’å…¥åŸºæœ¬æ¬Šé™
INSERT INTO permissions (permission_code, permission_name, resource_type, action_type) VALUES
-- è‚¡ç¥¨è³‡æ–™
('READ_STOCK', 'æŸ¥è©¢è‚¡ç¥¨è³‡æ–™', 'STOCK', 'READ'),
('READ_STOCK_PRICE', 'æŸ¥è©¢è‚¡åƒ¹', 'STOCK_PRICE', 'READ'),
('READ_INDICATOR', 'æŸ¥è©¢æŠ€è¡“æŒ‡æ¨™', 'INDICATOR', 'READ'),
('READ_FINANCIAL', 'æŸ¥è©¢è²¡å‹™æŒ‡æ¨™', 'FINANCIAL', 'READ'),

-- ä¿¡è™Ÿ
('READ_SIGNAL', 'æŸ¥è©¢ä¿¡è™Ÿ', 'SIGNAL', 'READ'),
('CREATE_SIGNAL', 'å‰µå»ºä¿¡è™Ÿ', 'SIGNAL', 'CREATE'),

-- è‡ªé¸è‚¡
('READ_WATCHLIST', 'æŸ¥è©¢è‡ªé¸è‚¡', 'WATCHLIST', 'READ'),
('CREATE_WATCHLIST', 'æ–°å¢è‡ªé¸è‚¡', 'WATCHLIST', 'CREATE'),
('DELETE_WATCHLIST', 'åˆªé™¤è‡ªé¸è‚¡', 'WATCHLIST', 'DELETE'),

-- è­¦å ±
('READ_ALERT', 'æŸ¥è©¢è­¦å ±', 'ALERT', 'READ'),
('CREATE_ALERT', 'å‰µå»ºè­¦å ±', 'ALERT', 'CREATE'),
('UPDATE_ALERT', 'æ›´æ–°è­¦å ±', 'ALERT', 'UPDATE'),
('DELETE_ALERT', 'åˆªé™¤è­¦å ±', 'ALERT', 'DELETE'),

-- å›æ¸¬
('READ_BACKTEST', 'æŸ¥è©¢å›æ¸¬', 'BACKTEST', 'READ'),
('CREATE_BACKTEST', 'åŸ·è¡Œå›æ¸¬', 'BACKTEST', 'CREATE'),

-- æŠ•è³‡çµ„åˆ
('READ_PORTFOLIO', 'æŸ¥è©¢æŠ•è³‡çµ„åˆ', 'PORTFOLIO', 'READ'),
('MANAGE_PORTFOLIO', 'ç®¡ç†æŠ•è³‡çµ„åˆ', 'PORTFOLIO', 'MANAGE'),

-- ç³»çµ±ç®¡ç†
('MANAGE_USER', 'ç®¡ç†ä½¿ç”¨è€…', 'USER', 'MANAGE'),
('MANAGE_JOB', 'ç®¡ç†æ’ç¨‹ä»»å‹™', 'JOB', 'MANAGE'),
('VIEW_SYSTEM_METRIC', 'æŸ¥çœ‹ç³»çµ±æŒ‡æ¨™', 'SYSTEM', 'READ');
```

#### 4.6.3 è§’è‰²æ¬Šé™å°æ‡‰è¡¨

```sql
CREATE TABLE role_permissions (
    role_code       VARCHAR(20) NOT NULL,
    permission_code VARCHAR(50) NOT NULL,
    PRIMARY KEY (role_code, permission_code),
    FOREIGN KEY (permission_code) REFERENCES permissions(permission_code)
);

COMMENT ON TABLE role_permissions IS 'è§’è‰²æ¬Šé™å°æ‡‰è¡¨';

-- GUEST æ¬Šé™
INSERT INTO role_permissions VALUES
('GUEST', 'READ_STOCK'),
('GUEST', 'READ_STOCK_PRICE');

-- USER æ¬Šé™ï¼ˆåŒ…å« GUEST çš„æ‰€æœ‰æ¬Šé™ï¼‰
INSERT INTO role_permissions VALUES
('USER', 'READ_STOCK'),
('USER', 'READ_STOCK_PRICE'),
('USER', 'READ_INDICATOR'),
('USER', 'READ_SIGNAL'),
('USER', 'READ_WATCHLIST'),
('USER', 'CREATE_WATCHLIST'),
('USER', 'DELETE_WATCHLIST'),
('USER', 'READ_ALERT'),
('USER', 'CREATE_ALERT'),
('USER', 'UPDATE_ALERT'),
('USER', 'DELETE_ALERT'),
('USER', 'READ_PORTFOLIO');

-- PREMIUM æ¬Šé™ï¼ˆåŒ…å« USER çš„æ‰€æœ‰æ¬Šé™ + é€²éšåŠŸèƒ½ï¼‰
INSERT INTO role_permissions VALUES
('PREMIUM', 'READ_STOCK'),
('PREMIUM', 'READ_STOCK_PRICE'),
('PREMIUM', 'READ_INDICATOR'),
('PREMIUM', 'READ_FINANCIAL'),
('PREMIUM', 'READ_SIGNAL'),
('PREMIUM', 'CREATE_SIGNAL'),
('PREMIUM', 'READ_WATCHLIST'),
('PREMIUM', 'CREATE_WATCHLIST'),
('PREMIUM', 'DELETE_WATCHLIST'),
('PREMIUM', 'READ_ALERT'),
('PREMIUM', 'CREATE_ALERT'),
('PREMIUM', 'UPDATE_ALERT'),
('PREMIUM', 'DELETE_ALERT'),
('PREMIUM', 'READ_BACKTEST'),
('PREMIUM', 'CREATE_BACKTEST'),
('PREMIUM', 'READ_PORTFOLIO'),
('PREMIUM', 'MANAGE_PORTFOLIO');

-- ADMIN æ¬Šé™ï¼ˆæ‰€æœ‰æ¬Šé™ï¼‰
INSERT INTO role_permissions 
SELECT 'ADMIN', permission_code FROM permissions;
```

#### 4.6.4 è³‡æ–™å­˜å–é‚Šç•Œï¼ˆRow-Level Securityï¼‰

**åŸå‰‡**: ä½¿ç”¨è€…åªèƒ½å­˜å–è‡ªå·±çš„è³‡æ–™ï¼ˆè‡ªé¸è‚¡ã€è­¦å ±ã€æŠ•è³‡çµ„åˆç­‰ï¼‰

**å¯¦ä½œæ–¹å¼**:
```java
// Service å±¤æª¢æŸ¥
public List<Watchlist> getWatchlist(Long userId) {
    // å¾ SecurityContext å–å¾—ç•¶å‰ä½¿ç”¨è€…
    Long currentUserId = SecurityUtils.getCurrentUserId();
    
    // æª¢æŸ¥æ˜¯å¦ç‚ºæœ¬äººæˆ–ç®¡ç†å“¡
    if (!currentUserId.equals(userId) && !SecurityUtils.isAdmin()) {
        throw new ForbiddenException("You can only access your own watchlist");
    }
    
    return watchlistRepository.findByUserId(userId);
}

// Repository å±¤è‡ªå‹•éæ¿¾
@Query("SELECT a FROM Alert a WHERE a.userId = :userId")
List<Alert> findByUserId(@Param("userId") Long userId);
```

#### 4.6.5 API æ¬Šé™æ§åˆ¶

**ä½¿ç”¨ Spring Security è¨»è§£**:
```java
@PreAuthorize("hasAuthority('READ_SIGNAL')")
@GetMapping("/api/signals")
public ResponseEntity<ApiResponse<List<SignalDTO>>> getSignals() {
    // ...
}

@PreAuthorize("hasAuthority('CREATE_BACKTEST') and hasRole('PREMIUM')")
@PostMapping("/api/backtest/execute")
public ResponseEntity<ApiResponse<BacktestResult>> executeBacktest() {
    // ...
}

@PreAuthorize("hasRole('ADMIN')")
@GetMapping("/api/admin/jobs")
public ResponseEntity<ApiResponse<List<JobExecution>>> getJobs() {
    // ...
}
```

#### 4.6.6 ä½¿ç”¨é‡é™åˆ¶

| åŠŸèƒ½ | GUEST | USER | PREMIUM | ADMIN |
|-----|-------|------|---------|-------|
| è‡ªé¸è‚¡æ•¸é‡ | 0 | 20 | ç„¡é™åˆ¶ | ç„¡é™åˆ¶ |
| è­¦å ±è¨­å®šæ•¸é‡ | 0 | 5 | ç„¡é™åˆ¶ | ç„¡é™åˆ¶ |
| å›æ¸¬æ¬¡æ•¸/æ—¥ | 0 | 0 | 50 | ç„¡é™åˆ¶ |
| API è«‹æ±‚/åˆ†é˜ | 10 | 60 | 300 | 1000 |
| æŸ¥è©¢æ­·å²è³‡æ–™ | 1å€‹æœˆ | 1å¹´ | å…¨éƒ¨ | å…¨éƒ¨ |

**é™æµå¯¦ä½œï¼ˆä½¿ç”¨ Redisï¼‰**:
```java
public boolean checkRateLimit(Long userId, String endpoint) {
    String key = "rate_limit:" + userId + ":" + endpoint;
    Long count = redisTemplate.opsForValue().increment(key);
    
    if (count == 1) {
        redisTemplate.expire(key, 1, TimeUnit.MINUTES);
    }
    
    int limit = getRateLimitByRole(userId);
    return count <= limit;
}
```

---

### 4.7 è³‡æ–™å“è³ªè¦ç¯„ (Data Quality)

#### 4.7.1 è³‡æ–™å“è³ªç¶­åº¦

| ç¶­åº¦ | èªªæ˜ | æª¢æ ¸è¦å‰‡ |
|-----|------|---------|
| **å®Œæ•´æ€§** (Completeness) | è³‡æ–™æ¬„ä½æ˜¯å¦å®Œæ•´ï¼Œç„¡éºæ¼ | å¿…å¡«æ¬„ä½ä¸å¯ç‚º NULL |
| **æº–ç¢ºæ€§** (Accuracy) | è³‡æ–™æ˜¯å¦æ­£ç¢ºï¼Œç¬¦åˆå¯¦éš›æƒ…æ³ | åƒ¹æ ¼ä¸å¯ç‚ºè² æ•¸ã€æˆäº¤é‡åˆç†ç¯„åœ |
| **ä¸€è‡´æ€§** (Consistency) | ç›¸é—œè³‡æ–™ä¹‹é–“æ˜¯å¦ä¸€è‡´ | é–‹ç›¤åƒ¹ â‰¤ æœ€é«˜åƒ¹ï¼Œæœ€ä½åƒ¹ â‰¤ æ”¶ç›¤åƒ¹ |
| **åŠæ™‚æ€§** (Timeliness) | è³‡æ–™æ˜¯å¦ç‚ºæœ€æ–° | è‚¡åƒ¹è³‡æ–™å¿…é ˆåœ¨ç•¶æ—¥ 16:00 å‰æ›´æ–°å®Œæˆ |
| **æœ‰æ•ˆæ€§** (Validity) | è³‡æ–™æ ¼å¼æ˜¯å¦ç¬¦åˆè¦ç¯„ | æ—¥æœŸæ ¼å¼ã€æ•¸å€¼ç¯„åœ |
| **å”¯ä¸€æ€§** (Uniqueness) | ç„¡é‡è¤‡è³‡æ–™ | (stock_id, trade_date) å”¯ä¸€ |

#### 4.7.2 è³‡æ–™é©—è­‰è¦å‰‡

**è‚¡åƒ¹è³‡æ–™é©—è­‰**:
```java
public class StockPriceValidator {
    
    public void validate(StockPrice price) {
        // å®Œæ•´æ€§æª¢æŸ¥
        Assert.notNull(price.getStockId(), "Stock ID cannot be null");
        Assert.notNull(price.getTradeDate(), "Trade date cannot be null");
        Assert.notNull(price.getClosePrice(), "Close price cannot be null");
        
        // æº–ç¢ºæ€§æª¢æŸ¥
        Assert.isTrue(price.getOpenPrice() >= 0, "Open price cannot be negative");
        Assert.isTrue(price.getClosePrice() >= 0, "Close price cannot be negative");
        Assert.isTrue(price.getVolume() >= 0, "Volume cannot be negative");
        
        // ä¸€è‡´æ€§æª¢æŸ¥
        Assert.isTrue(price.getHighPrice() >= price.getOpenPrice(), 
            "High price must be >= open price");
        Assert.isTrue(price.getHighPrice() >= price.getClosePrice(), 
            "High price must be >= close price");
        Assert.isTrue(price.getLowPrice() <= price.getOpenPrice(), 
            "Low price must be <= open price");
        Assert.isTrue(price.getLowPrice() <= price.getClosePrice(), 
            "Low price must be <= close price");
        
        // æœ‰æ•ˆæ€§æª¢æŸ¥ï¼ˆå°è‚¡æ¼²è·Œå¹…é™åˆ¶ Â±10%ï¼‰
        BigDecimal prevClose = getPreviousClosePrice(price.getStockId(), price.getTradeDate());
        if (prevClose != null) {
            BigDecimal upperLimit = prevClose.multiply(new BigDecimal("1.10"));
            BigDecimal lowerLimit = prevClose.multiply(new BigDecimal("0.90"));
            Assert.isTrue(price.getClosePrice().compareTo(upperLimit) <= 0, 
                "Price exceeds upper limit");
            Assert.isTrue(price.getClosePrice().compareTo(lowerLimit) >= 0, 
                "Price below lower limit");
        }
    }
}
```

**è²¡å‹™è³‡æ–™é©—è­‰**:
```java
public class FinancialDataValidator {
    
    public void validate(FinancialData data) {
        // å®Œæ•´æ€§
        Assert.notNull(data.getStockId(), "Stock ID required");
        Assert.notNull(data.getYear(), "Year required");
        Assert.notNull(data.getQuarter(), "Quarter required");
        
        // æœ‰æ•ˆæ€§
        Assert.isTrue(data.getQuarter() >= 1 && data.getQuarter() <= 4, 
            "Quarter must be 1-4");
        
        // ä¸€è‡´æ€§ï¼ˆåŸºæœ¬è²¡å‹™é‚è¼¯ï¼‰
        if (data.getTotalAssets() != null && data.getTotalLiabilities() != null) {
            Assert.isTrue(data.getTotalAssets().compareTo(data.getTotalLiabilities()) >= 0,
                "Assets must be >= Liabilities");
        }
        
        // æº–ç¢ºæ€§ï¼ˆåˆç†ç¯„åœï¼‰
        if (data.getRoe() != null) {
            Assert.isTrue(data.getRoe().abs().compareTo(new BigDecimal("100")) <= 0,
                "ROE value unreasonable (> Â±100%)");
        }
    }
}
```

#### 4.7.3 è³‡æ–™å“è³ªæª¢æ ¸è¡¨

```sql
-- PostgreSQL ç‰ˆæœ¬
CREATE TABLE data_quality_checks (
    check_id        BIGSERIAL PRIMARY KEY,
    check_name      VARCHAR(100) NOT NULL,
    check_type      VARCHAR(50) NOT NULL,
    target_table    VARCHAR(50) NOT NULL,
    check_rule      TEXT NOT NULL,
    severity        VARCHAR(10) CHECK (severity IN ('HIGH', 'MEDIUM', 'LOW')) DEFAULT 'MEDIUM',
    is_active       BOOLEAN DEFAULT TRUE,
    last_check_time TIMESTAMP,
    last_result     VARCHAR(10) CHECK (last_result IN ('PASS', 'FAIL', 'WARNING')),
    created_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_dq_checks_target_table ON data_quality_checks(target_table);

COMMENT ON TABLE data_quality_checks IS 'è³‡æ–™å“è³ªæª¢æ ¸è¦å‰‡è¡¨';

CREATE TABLE data_quality_issues (
    issue_id        BIGSERIAL PRIMARY KEY,
    check_id        BIGINT NOT NULL,
    issue_date      DATE NOT NULL,
    affected_rows   INTEGER,
    issue_detail    TEXT,
    severity        VARCHAR(10) CHECK (severity IN ('HIGH', 'MEDIUM', 'LOW')),
    status          VARCHAR(20) DEFAULT 'OPEN' 
        CHECK (status IN ('OPEN', 'IN_PROGRESS', 'RESOLVED', 'IGNORED')),
    resolved_at     TIMESTAMP,
    resolved_by     VARCHAR(50),
    notes           TEXT,
    created_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (check_id) REFERENCES data_quality_checks(check_id)
);

CREATE INDEX idx_dq_issues_check_id ON data_quality_issues(check_id);
CREATE INDEX idx_dq_issues_date ON data_quality_issues(issue_date);
CREATE INDEX idx_dq_issues_status ON data_quality_issues(status);

COMMENT ON TABLE data_quality_issues IS 'è³‡æ–™å“è³ªå•é¡Œè¨˜éŒ„è¡¨';
```

#### 4.7.4 è³‡æ–™å“è³ªæª¢æ ¸ Job

**æª¢æ ¸æ™‚æ©Ÿ**:
- è³‡æ–™å…¥åº«å¾Œç«‹å³æª¢æ ¸ï¼ˆå³æ™‚æª¢æ ¸ï¼‰
- æ¯æ—¥æ‰¹æ¬¡æª¢æ ¸ï¼ˆå…¨é¢æª¢æ ¸ï¼‰
- æ‰‹å‹•è§¸ç™¼æª¢æ ¸ï¼ˆå•é¡Œæ’æŸ¥ï¼‰

**æª¢æ ¸é …ç›®ç¯„ä¾‹**:

| æª¢æ ¸åç¨± | æª¢æ ¸é¡å‹ | ç›®æ¨™è¡¨ | æª¢æ ¸è¦å‰‡ | åš´é‡ç¨‹åº¦ |
|---------|---------|--------|---------|---------|
| è‚¡åƒ¹è³‡æ–™å®Œæ•´æ€§æª¢æ ¸ | COMPLETENESS | stock_prices | æª¢æŸ¥å¿…å¡«æ¬„ä½æ˜¯å¦ç‚º NULL | HIGH |
| è‚¡åƒ¹å››åƒ¹ä¸€è‡´æ€§æª¢æ ¸ | CONSISTENCY | stock_prices | high >= open, high >= close, low <= open, low <= close | HIGH |
| è²¡å‹™è³‡ç”¢è² å‚µä¸€è‡´æ€§ | CONSISTENCY | financial_data | total_assets >= total_liabilities | MEDIUM |
| è‚¡åƒ¹æ›´æ–°åŠæ™‚æ€§æª¢æ ¸ | TIMELINESS | stock_prices | æª¢æŸ¥æœ€æ–°äº¤æ˜“æ—¥è³‡æ–™æ˜¯å¦å·²æ›´æ–° | HIGH |
| æŠ€è¡“æŒ‡æ¨™è¨ˆç®—å®Œæ•´æ€§ | COMPLETENESS | technical_indicators | æª¢æŸ¥æŒ‡æ¨™è¨ˆç®—æ˜¯å¦è¦†è“‹æ‰€æœ‰è‚¡ç¥¨ | MEDIUM |
| ä¿¡è™Ÿé‡è¤‡æ€§æª¢æ ¸ | UNIQUENESS | signals | æª¢æŸ¥ signal_uuid æ˜¯å¦é‡è¤‡ | MEDIUM |

#### 4.7.5 è³‡æ–™å“è³ªç›£æ§èˆ‡å‘Šè­¦

**ç›£æ§æŒ‡æ¨™**:
- è³‡æ–™å®Œæ•´ç‡ï¼ˆå¿…å¡«æ¬„ä½ç„¡ NULL çš„æ¯”ä¾‹ï¼‰
- è³‡æ–™ä¸€è‡´æ€§é€šéç‡
- è³‡æ–™æ›´æ–°å»¶é²æ™‚é–“
- è³‡æ–™å“è³ªå•é¡Œæ•¸é‡ï¼ˆæŒ‰åš´é‡ç¨‹åº¦åˆ†é¡ï¼‰

**å‘Šè­¦æ¢ä»¶**:

| æ¢ä»¶ | åš´é‡ç¨‹åº¦ | è™•ç†æ–¹å¼ |
|-----|---------|---------|
| è‚¡åƒ¹è³‡æ–™è¶…é 1 å°æ™‚æœªæ›´æ–° | HIGH | ç«‹å³é€šçŸ¥ + è‡ªå‹•é‡è©¦ |
| è³‡æ–™ä¸€è‡´æ€§æª¢æ ¸å¤±æ•— > 10 ç­† | HIGH | ç«‹å³é€šçŸ¥ + æš«åœç›¸é—œ Job |
| è³‡æ–™å®Œæ•´ç‡ < 95% | MEDIUM | æ¯æ—¥å½™æ•´é€šçŸ¥ |
| è²¡å‹™è³‡æ–™ç¼ºå¤± | MEDIUM | æ¨™è¨˜ç¼ºå¤±ï¼Œå®šæœŸè£œé½Š |

**è™•ç†æµç¨‹**:
1. è³‡æ–™å“è³ªæª¢æ ¸ Job åµæ¸¬åˆ°å•é¡Œ
2. å¯«å…¥ `data_quality_issues` è¡¨
3. æ ¹æ“šåš´é‡ç¨‹åº¦æ±ºå®šå‘Šè­¦æ–¹å¼
4. é–‹ç™¼äººå“¡èª¿æŸ¥ä¸¦ä¿®æ­£
5. æ¨™è¨˜å•é¡Œç‚º RESOLVED

---

### 4.8 è³‡æ–™ä¸€è‡´æ€§èˆ‡äº¤æ˜“è¦ç¯„

#### 4.8.1 è³‡æ–™åº«äº¤æ˜“åŸå‰‡

**ACID åŸå‰‡éµå®ˆ**:
- **Atomicity (åŸå­æ€§)**: äº¤æ˜“å…§çš„æ“ä½œè¦éº¼å…¨éƒ¨æˆåŠŸï¼Œè¦éº¼å…¨éƒ¨å¤±æ•—
- **Consistency (ä¸€è‡´æ€§)**: äº¤æ˜“å‰å¾Œè³‡æ–™åº«ç‹€æ…‹ä¿æŒä¸€è‡´
- **Isolation (éš”é›¢æ€§)**: ä¸¦è¡Œäº¤æ˜“äº’ä¸å¹²æ“¾
- **Durability (æŒä¹…æ€§)**: äº¤æ˜“å®Œæˆå¾Œè³‡æ–™æŒä¹…åŒ–

**äº¤æ˜“ç¯„åœåŸå‰‡**:
- å–®ä¸€è³‡æ–™è¡¨æ“ä½œ: ä¸éœ€è¦é¡¯å¼äº¤æ˜“ï¼ˆä¾è³´è³‡æ–™åº«é è¨­ï¼‰
- å¤šè¡¨é—œè¯æ“ä½œ: å¿…é ˆä½¿ç”¨äº¤æ˜“
- è®€å–æ“ä½œ: ä¸€èˆ¬ä¸éœ€è¦äº¤æ˜“
- å¯«å…¥æ“ä½œ: å»ºè­°ä½¿ç”¨äº¤æ˜“ä»¥ç¢ºä¿ä¸€è‡´æ€§

**äº¤æ˜“éš”é›¢ç´šåˆ¥**:
- é è¨­ä½¿ç”¨: `READ_COMMITTED`
- ç‰¹æ®Šå ´æ™¯: `REPEATABLE_READ`ï¼ˆå¦‚å›æ¸¬è¨ˆç®—ï¼‰

#### 4.8.2 ä½µç™¼æ§åˆ¶ç­–ç•¥

**æ¨‚è§€é– (Optimistic Locking)**:
- ä½¿ç”¨å ´æ™¯: è¡çªæ©Ÿç‡ä½çš„æ›´æ–°æ“ä½œ
- å¯¦ä½œæ–¹å¼: ä½¿ç”¨ version æ¬„ä½
- é©ç”¨è³‡æ–™: ä½¿ç”¨è€…è¨­å®šã€è­¦å ±æ¢ä»¶

**æ‚²è§€é– (Pessimistic Locking)**:
- ä½¿ç”¨å ´æ™¯: é«˜è¡çªæ©Ÿç‡çš„æ“ä½œ
- å¯¦ä½œæ–¹å¼: SELECT ... FOR UPDATE
- é©ç”¨è³‡æ–™: æŠ•è³‡çµ„åˆé¤˜é¡æ›´æ–°

**åˆ†æ•£å¼é– (Redis Lock)**:
- ä½¿ç”¨å ´æ™¯: è·¨å¤šå€‹æœå‹™çš„è³‡æºç«¶çˆ­
- å¯¦ä½œæ–¹å¼: Redis SETNX + TTL
- é©ç”¨æ“ä½œ: Job æ’ç¨‹é˜²é‡è¤‡åŸ·è¡Œ

#### 4.8.3 è³‡æ–™ä¸€è‡´æ€§ä¿è­‰ç­–ç•¥

**å¤šè¡¨å¯«å…¥ä¸€è‡´æ€§**:
- ä½¿ç”¨è³‡æ–™åº«äº¤æ˜“ç¢ºä¿å¤šè¡¨æ“ä½œçš„åŸå­æ€§
- ç¯„ä¾‹: å‰µå»ºä¿¡è™Ÿæ™‚åŒæ™‚æ›´æ–°ä¿¡è™Ÿçµ±è¨ˆè¡¨

**å¿«å–èˆ‡è³‡æ–™åº«ä¸€è‡´æ€§**:
- Write-Through: åŒæ™‚æ›´æ–°è³‡æ–™åº«èˆ‡å¿«å–
- Cache-Aside: æ›´æ–°è³‡æ–™åº«å¾Œåˆªé™¤å¿«å–
- å»¶é²é›™åˆª: æ›´æ–°è³‡æ–™åº«å‰å¾Œå„åˆªé™¤ä¸€æ¬¡å¿«å–

**åˆ†æ•£å¼ä¸€è‡´æ€§**:
- æœ€çµ‚ä¸€è‡´æ€§: éé—œéµè³‡æ–™å¯æ¥å—çŸ­æš«ä¸ä¸€è‡´
- å¼·ä¸€è‡´æ€§: é—œéµè³‡æ–™ï¼ˆå¦‚äº¤æ˜“è¨˜éŒ„ï¼‰å¿…é ˆç«‹å³ä¸€è‡´

---

### 4.9 äº¤æ˜“æ—¥æ›†èˆ‡å¸‚å ´æ™‚æ®µç®¡ç†

#### 4.9.1 äº¤æ˜“æ—¥æ›†å®šç¾©

**äº¤æ˜“æ—¥åˆ¤å®šè¦å‰‡**:
- æ’é™¤é€±å…­ã€é€±æ—¥
- æ’é™¤åœ‹å®šå‡æ—¥
- æ’é™¤è­‰äº¤æ‰€å…¬å‘Šçš„ç‰¹æ®Šä¼‘å¸‚æ—¥

**äº¤æ˜“æ—¥æ›†è¡¨**:
```sql
-- PostgreSQL ç‰ˆæœ¬
CREATE TABLE trading_calendar (
    date            DATE PRIMARY KEY,
    is_trading_day  BOOLEAN NOT NULL,
    market          VARCHAR(20) DEFAULT 'TWSE',
    holiday_name    VARCHAR(100),
    note            VARCHAR(255),
    created_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_trading_calendar_is_trading ON trading_calendar(is_trading_day);
CREATE INDEX idx_trading_calendar_market ON trading_calendar(market);

COMMENT ON TABLE trading_calendar IS 'äº¤æ˜“æ—¥æ›†è¡¨';
COMMENT ON COLUMN trading_calendar.is_trading_day IS 'æ˜¯å¦ç‚ºäº¤æ˜“æ—¥';
```

**ç”¨é€”**:
- Job æ’ç¨‹åªåœ¨äº¤æ˜“æ—¥åŸ·è¡Œ
- è¨ˆç®—äº¤æ˜“æ—¥æ•¸ï¼ˆå¦‚ 20 æ—¥å‡ç·šéœ€è¦ 20 å€‹äº¤æ˜“æ—¥ï¼‰
- æ­·å²è³‡æ–™æŸ¥è©¢éæ¿¾éäº¤æ˜“æ—¥

#### 4.9.2 å¸‚å ´æ™‚æ®µå®šç¾©

**å°è‚¡å¸‚å ´æ™‚æ®µ**:

| æ™‚æ®µ | æ™‚é–“ | èªªæ˜ |
|-----|------|------|
| é–‹ç›¤å‰ | 08:00 - 08:30 | é›†åˆç«¶åƒ¹æ’®åˆ |
| ç›¤ä¸­äº¤æ˜“ | 09:00 - 13:30 | æ­£å¸¸äº¤æ˜“æ™‚æ®µ |
| æ”¶ç›¤ | 13:30 | æ”¶ç›¤æ™‚é–“ |
| ç›¤å¾Œäº¤æ˜“ | 14:00 - 14:30 | ç›¤å¾Œå®šåƒ¹äº¤æ˜“ |
| è³‡æ–™ç¢ºèª | 14:30 - 15:00 | è³‡æ–™æ ¸å°èˆ‡ç¢ºèª |

**ç³»çµ±æ’ç¨‹æ™‚é–“è¨­è¨ˆ**:
- é¿å…åœ¨äº¤æ˜“æ™‚æ®µåŸ·è¡Œé‡é‡ç´šä»»å‹™
- è³‡æ–™åŒæ­¥åœ¨ 15:00 å¾ŒåŸ·è¡Œï¼ˆç¢ºä¿è³‡æ–™å®Œæ•´ï¼‰
- ä¿¡è™Ÿè¨ˆç®—èˆ‡é€šçŸ¥åœ¨ 16:00 å¾ŒåŸ·è¡Œ

---

### 4.10 å¤šè³‡æ–™ä¾†æºå„ªå…ˆç´šèˆ‡å‚™æ´ç­–ç•¥

#### 4.10.1 è³‡æ–™ä¾†æºæ¸…å–®

| è³‡æ–™ä¾†æº | è³‡æ–™é¡å‹ | å„ªå…ˆç´š | é™åˆ¶ |
|---------|---------|-------|------|
| Yahoo Finance | è‚¡åƒ¹ã€åŸºæœ¬è³‡æ–™ | P1 | å…è²»ï¼Œæœ‰è«‹æ±‚é™åˆ¶ |
| å°ç£è­‰äº¤æ‰€ API | è‚¡åƒ¹ã€ä¸‰å¤§æ³•äºº | P2 | å®˜æ–¹è³‡æ–™ï¼Œè¼ƒæ…¢ |
| å…¬é–‹è³‡è¨Šè§€æ¸¬ç«™ | è²¡å ±ã€é‡å¤§è¨Šæ¯ | P1 | å®˜æ–¹è³‡æ–™ |
| FinMind API | è‚¡åƒ¹ã€è²¡å ±ã€ç±Œç¢¼ | P3 | éœ€ä»˜è²» |

#### 4.10.2 å‚™æ´ç­–ç•¥

**ä¸»å‚™åˆ‡æ›è¦å‰‡**:
1. å˜—è©¦ P1 è³‡æ–™ä¾†æº
2. è‹¥å¤±æ•—æˆ–è¶…æ™‚ï¼Œåˆ‡æ›è‡³ P2
3. è‹¥ä»å¤±æ•—ï¼Œåˆ‡æ›è‡³ P3
4. è‹¥å…¨éƒ¨å¤±æ•—ï¼Œè¨˜éŒ„éŒ¯èª¤ä¸¦å‘Šè­¦

**è³‡æ–™ä¾†æºé…ç½®è¡¨**:
```sql
-- PostgreSQL ç‰ˆæœ¬
CREATE TABLE data_source_config (
    source_id       SERIAL PRIMARY KEY,
    source_name     VARCHAR(50) NOT NULL,
    source_type     VARCHAR(50) NOT NULL,
    priority        INTEGER NOT NULL,
    is_active       BOOLEAN DEFAULT TRUE,
    api_endpoint    VARCHAR(255),
    rate_limit      INTEGER,
    timeout_ms      INTEGER DEFAULT 10000,
    retry_count     INTEGER DEFAULT 3,
    created_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_data_source_type_priority ON data_source_config(source_type, priority);

COMMENT ON TABLE data_source_config IS 'è³‡æ–™ä¾†æºé…ç½®è¡¨';
```

#### 4.10.3 è³‡æ–™å“è³ªæ¯”è¼ƒ

**å¤šä¾†æºè³‡æ–™é©—è­‰**:
- è‹¥å¤šå€‹ä¾†æºæä¾›ç›¸åŒè³‡æ–™ï¼Œäº¤å‰é©—è­‰
- è‹¥æ•¸æ“šå·®ç•°è¶…éé–¾å€¼ï¼ˆå¦‚åƒ¹æ ¼å·®ç•° >1%ï¼‰ï¼Œæ¨™è¨˜ç•°å¸¸
- å„ªå…ˆæ¡ç”¨å„ªå…ˆç´šè¼ƒé«˜ä¸”è³‡æ–™å“è³ªå¥½çš„ä¾†æº

---

## 5. æŠ€è¡“æ¶æ§‹

### 5.1 æ•´é«”æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å‰ç«¯å±¤ (Frontend Layer)                     â”‚
â”‚         React / Vue.js / Angular / Mobile App               â”‚
â”‚                  (æœªä¾†å¯æ“´å±• Thymeleaf SSR)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†• HTTP/HTTPS + WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                APIç¶²é—œå±¤ (API Gateway) - å¯é¸                â”‚
â”‚           Spring Cloud Gateway / Nginx / Kong               â”‚
â”‚            (è² è¼‰å‡è¡¡ã€é™æµã€èªè­‰ã€è·¯ç”±)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Spring Boot æ‡‰ç”¨å±¤ (Application Layer)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Controller Layer (REST API + WebSocket)        â”‚       â”‚
â”‚  â”‚   - @RestController                              â”‚       â”‚
â”‚  â”‚   - @WebSocketHandler                            â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚  Service Layer (Business Logic)                 â”‚       â”‚
â”‚  â”‚   - @Service                                     â”‚       â”‚
â”‚  â”‚   - @Transactional                               â”‚       â”‚
â”‚  â”‚   - å”èª¿ Repository + Mapper                     â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚  Repository Layer (Data Access)                 â”‚       â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚       â”‚
â”‚  â”‚   â”‚ JPA Repository  â”‚ MyBatis Mapper  â”‚         â”‚       â”‚
â”‚  â”‚   â”‚ - ç°¡å–® CRUD     â”‚ - è¤‡é›œæŸ¥è©¢      â”‚         â”‚       â”‚
â”‚  â”‚   â”‚ - å¯¦é«”é—œè¯      â”‚ - å‹•æ…‹ SQL      â”‚         â”‚       â”‚
â”‚  â”‚   â”‚ - åŸºç¤æŸ¥è©¢      â”‚ - æ‰¹æ¬¡æ“ä½œ      â”‚         â”‚       â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†•                    â†•                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQL 15+â”‚   â”‚   Redis 7.0   â”‚   â”‚  InfluxDB     â”‚
â”‚ (ä¸»è³‡æ–™åº«)     â”‚   â”‚   (å¿«å–)       â”‚   â”‚  (æ™‚åºè³‡æ–™)    â”‚
â”‚ - è‚¡ç¥¨è³‡æ–™     â”‚   â”‚  - ç†±è³‡æ–™      â”‚   â”‚  (å¯é¸)       â”‚
â”‚ - è²¡å ±è³‡æ–™     â”‚   â”‚  - Session    â”‚   â”‚               â”‚
â”‚ - ä¿¡è™Ÿè³‡æ–™     â”‚   â”‚  - Rate Limit â”‚   â”‚               â”‚
â”‚ - JSONBæ”¯æ´    â”‚   â”‚  - å»é‡å¿«å–    â”‚   â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å¤–éƒ¨æœå‹™å±¤ (External Services)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Yahoo Finance   â”‚  â”‚ å°ç£è­‰äº¤æ‰€ API   â”‚  â”‚ FinMind   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ LINE Notify     â”‚  â”‚ SMTP Email      â”‚  â”‚ Telegram  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 åˆ†å±¤æ¶æ§‹è¨­è¨ˆ

#### 5.2.1 å››å±¤æ¶æ§‹

```
1. Presentation Layer (è¡¨ç¾å±¤)
   - Controller: è™•ç† HTTP è«‹æ±‚
   - WebSocket Handler: è™•ç† WebSocket é€£ç·š
   - DTO: è³‡æ–™å‚³è¼¸ç‰©ä»¶
   - Exception Handler: å…¨å±€ç•°å¸¸è™•ç†

2. Application Layer (æ‡‰ç”¨å±¤)
   - Service: æ¥­å‹™é‚è¼¯å¯¦ä½œ
   - Facade: é–€é¢æœå‹™ï¼ˆæ•´åˆå¤šå€‹ Serviceï¼‰
   - Scheduler: å®šæ™‚ä»»å‹™
   - Event Handler: äº‹ä»¶è™•ç†

3. Domain Layer (é ˜åŸŸå±¤)
   - Entity: å¯¦é«”ç‰©ä»¶ï¼ˆå°æ‡‰è³‡æ–™è¡¨ï¼‰
   - Repository Interface: è³‡æ–™å­˜å–æ¥å£
   - Domain Service: é ˜åŸŸæœå‹™
   - Value Object: å€¼ç‰©ä»¶

4. Infrastructure Layer (åŸºç¤è¨­æ–½å±¤)
   - Repository Implementation: è³‡æ–™å­˜å–å¯¦ä½œ
   - External API Client: å¤–éƒ¨ API æ•´åˆ
   - Cache Service: å¿«å–æœå‹™
   - Configuration: ç³»çµ±é…ç½®
   - Utils: å·¥å…·é¡åˆ¥
```

#### 5.2.2 Controller Layer (è¡¨ç¾å±¤)

**è·è²¬**:
- æ¥æ”¶ HTTP è«‹æ±‚
- åƒæ•¸é©—è­‰èˆ‡è½‰æ›
- å‘¼å« Service å±¤è™•ç†æ¥­å‹™é‚è¼¯
- å›å‚³çµ±ä¸€æ ¼å¼çš„ Response

**ä¸æ‡‰è©²åšçš„äº‹**:
- ç›´æ¥æ“ä½œè³‡æ–™åº«
- åŒ…å«è¤‡é›œçš„æ¥­å‹™é‚è¼¯
- è™•ç†ç•°å¸¸ï¼ˆæ‡‰ç”±å…¨å±€ç•°å¸¸è™•ç†å™¨çµ±ä¸€è™•ç†ï¼‰

#### 5.2.3 Service Layer (æ¥­å‹™é‚è¼¯å±¤)

**è·è²¬**:
- å¯¦ä½œæ ¸å¿ƒæ¥­å‹™é‚è¼¯
- å”èª¿å¤šå€‹ Repository
- è™•ç†äº‹å‹™é‚Šç•Œ (@Transactional)
- å‘¼å«å¤–éƒ¨æœå‹™

**ç‰¹é»**:
- å¯é‡ç”¨ï¼šè¢« Controllerã€Schedulerã€Event Handler å‘¼å«
- ç„¡ç‹€æ…‹ï¼šä¸æ‡‰ä¿å­˜è«‹æ±‚ç›¸é—œçš„ç‹€æ…‹

#### 5.2.4 Repository Layer (è³‡æ–™å­˜å–å±¤)

**è·è²¬**:
- å°è£è³‡æ–™åº«æ“ä½œ
- æä¾› CRUD æ–¹æ³•
- è¤‡é›œæŸ¥è©¢å®šç¾©

**ç‰¹é»**:
- ç¹¼æ‰¿ JpaRepository
- ä½¿ç”¨ @Query å®šç¾©è¤‡é›œæŸ¥è©¢
- ä¸åŒ…å«æ¥­å‹™é‚è¼¯

#### 5.2.5 Entity Layer (å¯¦é«”å±¤)

**è·è²¬**:
- å°æ‡‰è³‡æ–™åº«è¡¨çµæ§‹
- å®šç¾©æ¬„ä½èˆ‡é—œè¯é—œä¿‚
- åŒ…å«å¿…è¦çš„é©—è­‰è¨»è§£

#### 5.2.6 DTO Layer (è³‡æ–™å‚³è¼¸å±¤)

**è·è²¬**:
- API è«‹æ±‚/å›æ‡‰çš„è³‡æ–™çµæ§‹
- èˆ‡ Entity åˆ†é›¢ï¼Œé¿å…ç›´æ¥æš´éœ²è³‡æ–™åº«çµæ§‹
- å¯åŒ…å«æ ¼å¼åŒ–é‚è¼¯

### 5.3 æŠ€è¡“é¸å‹

| å±¤æ¬¡ | æŠ€è¡“ | ç‰ˆæœ¬ | èªªæ˜ |
|-----|------|------|------|
| **æ ¸å¿ƒæ¡†æ¶** | Spring Boot | 3.2+ | ä¼æ¥­ç´š Java æ¡†æ¶ |
| **Java ç‰ˆæœ¬** | Java | 17 LTS | é•·æœŸæ”¯æ´ç‰ˆæœ¬ |
| **Web æ¡†æ¶** | Spring MVC | 6.x | RESTful API |
| **æŒä¹…å±¤æ¡†æ¶** | Spring Data JPA | 3.x | ç°¡å–® CRUDï¼Œå¯¦é«”é—œè¯ |
| **æŒä¹…å±¤æ¡†æ¶** | MyBatis | 3.5+ | è¤‡é›œæŸ¥è©¢ï¼Œå‹•æ…‹ SQL |
| **MyBatis æ•´åˆ** | mybatis-spring-boot-starter | 3.0+ | MyBatis + Spring Boot æ•´åˆ |
| **è³‡æ–™åº«** | PostgreSQL | 15+ | é—œè¯å¼è³‡æ–™åº«ï¼Œæ”¯æ´ JSONB |
| **PostgreSQL é©…å‹•** | postgresql | 42.7+ | JDBC Driver |
| **JSONB æ”¯æ´** | hypersistence-utils | 3.7+ | Hibernate JSONB æ˜ å°„ |
| **å¿«å–** | Redis | 7.0+ | åˆ†æ•£å¼å¿«å– |
| **æ™‚åºè³‡æ–™åº«** | InfluxDB | 2.x (å¯é¸) | æ™‚åºè³‡æ–™å­˜å„²ï¼ˆè‚¡åƒ¹æ­·å²ã€æŒ‡æ¨™æ™‚åºï¼‰ |
| **å®‰å…¨æ¡†æ¶** | Spring Security | 6.x | å®‰å…¨èªè­‰æˆæ¬Š |
| **JWT** | JJWT | 0.12+ | Token ç”Ÿæˆèˆ‡é©—è­‰ |
| **WebSocket** | Spring WebSocket | 6.x | å³æ™‚é€šè¨Š |
| **API æ–‡æª”** | SpringDoc OpenAPI | 2.3+ | Swagger UI 3.0 |
| **HTTP å®¢æˆ¶ç«¯** | WebClient | 6.x | éé˜»å¡ HTTP å®¢æˆ¶ç«¯ï¼ˆå‘¼å«å¤–éƒ¨ APIï¼‰ |
| **JSON è™•ç†** | Jackson | 2.15+ | JSON åºåˆ—åŒ–/ååºåˆ—åŒ– |
| **æ—¥èªŒæ¡†æ¶** | SLF4J + Logback | 2.0+ | æ—¥èªŒè¨˜éŒ„ |
| **æ¸¬è©¦æ¡†æ¶** | JUnit 5 + Mockito | 5.10+ | å–®å…ƒæ¸¬è©¦ |
| **å»ºç½®å·¥å…·** | Maven | 3.9+ | ä¾è³´ç®¡ç†èˆ‡å°ˆæ¡ˆå»ºç½® |
| **ç›£æ§** | Spring Actuator | 3.x | æ‡‰ç”¨å¥åº·æª¢æŸ¥èˆ‡ç›£æ§ |
| **æŒ‡æ¨™æ”¶é›†** | Micrometer | 1.12+ | æŒ‡æ¨™æ”¶é›†èˆ‡åŒ¯å‡º |
| **æ’ç¨‹** | Spring Scheduler | 3.x | å®šæ™‚ä»»å‹™ |
| **é©—è­‰æ¡†æ¶** | Hibernate Validator | 8.x | Bean Validation (JSR 380) |

### 5.4 éƒ¨ç½²æ¶æ§‹

**é–‹ç™¼ç’°å¢ƒ**:
- å–®æ©Ÿéƒ¨ç½²: Spring Boot + MySQL + Redisï¼ˆæœ¬æ©Ÿæˆ– Docker Composeï¼‰
- IDE: IntelliJ IDEA / Eclipse
- è³‡æ–™åº«ç®¡ç†: MySQL Workbench / DBeaver

**æ¸¬è©¦ç’°å¢ƒ**:
- Docker Compose: å¤šå®¹å™¨ç·¨æ’
- ç¨ç«‹çš„ MySQL èˆ‡ Redis å¯¦ä¾‹
- æ¨¡æ“¬å¤–éƒ¨ APIï¼ˆMock Serverï¼‰

**ç”Ÿç”¢ç’°å¢ƒé¸é …**:

**é¸é … 1: å–®æ©Ÿéƒ¨ç½²ï¼ˆå°è¦æ¨¡ï¼‰**
```
â”œâ”€â”€ Application Server (Docker Container)
â”‚   â””â”€â”€ Spring Boot Application
â”œâ”€â”€ MySQL Server
â””â”€â”€ Redis Server
```

**é¸é … 2: åˆ†æ•£å¼éƒ¨ç½²ï¼ˆä¸­è¦æ¨¡ï¼‰**
```
â”œâ”€â”€ Load Balancer (Nginx)
â”‚   â”œâ”€â”€ Application Server 1
â”‚   â”œâ”€â”€ Application Server 2
â”‚   â””â”€â”€ Application Server N
â”œâ”€â”€ MySQL (Master-Slave)
â”‚   â”œâ”€â”€ Master (Write)
â”‚   â””â”€â”€ Slave (Read)
â””â”€â”€ Redis Cluster
```

**é¸é … 3: Kubernetes éƒ¨ç½²ï¼ˆå¤§è¦æ¨¡ï¼‰**
```
â”œâ”€â”€ Kubernetes Cluster
â”‚   â”œâ”€â”€ Application Pods (Auto-scaling)
â”‚   â”œâ”€â”€ MySQL StatefulSet
â”‚   â”œâ”€â”€ Redis Deployment
â”‚   â””â”€â”€ Ingress Controller
```

### 5.5 æŠ€è¡“é¸å‹å°æ¯”

| åŠŸèƒ½éœ€æ±‚ | æ–¹æ¡ˆA | æ–¹æ¡ˆB | é¸æ“‡ | ç†ç”± |
|---------|-------|-------|------|------|
| è³‡æ–™åº« | MySQL | PostgreSQL | **PostgreSQL** | JSONB æ”¯æ´æ›´å¥½ï¼Œå…¨æ–‡æª¢ç´¢ï¼Œé™£åˆ—å‹æ…‹ |
| æŒä¹…å±¤ | ç´” JPA | ç´” MyBatis | **JPA + MyBatis** | å…¼é¡§é–‹ç™¼æ•ˆç‡èˆ‡æŸ¥è©¢éˆæ´»æ€§ |
| å¿«å– | Guava Cache | Redis | **Redis** | åˆ†æ•£å¼å¿«å–ï¼Œæ”¯æ´å¤šå¯¦ä¾‹å…±äº« |
| æ™‚åºè³‡æ–™ | PostgreSQL | InfluxDB | **PostgreSQLï¼ˆä¸»ï¼‰+ InfluxDBï¼ˆå¯é¸ï¼‰** | PostgreSQL æ»¿è¶³åŸºæœ¬éœ€æ±‚ |
| API æ–‡æª” | Swagger 2 | SpringDoc OpenAPI 3 | **SpringDoc** | OpenAPI 3.0 æ¨™æº–ï¼Œæ›´ç¾ä»£åŒ– |
| HTTP å®¢æˆ¶ç«¯ | RestTemplate | WebClient | **WebClient** | éé˜»å¡ï¼Œæ•ˆèƒ½æ›´å¥½ |
| å®šæ™‚ä»»å‹™ | Quartz | Spring Scheduler | **Spring Scheduler** | ç°¡å–®éœ€æ±‚ç”¨åŸç”Ÿå³å¯ |


---

## 6. æ¨¡çµ„æ¸…å–®èˆ‡ä¾è³´é—œä¿‚

### 6.1 æ¨¡çµ„æ¸…å–®

| æ¨¡çµ„ç·¨è™Ÿ | æ¨¡çµ„åç¨± | è·è²¬èªªæ˜ | æŒä¹…å±¤é¸æ“‡ | ä¾è³´æ¨¡çµ„ | æ–‡ä»¶ç·¨è™Ÿ |
|---------|---------|---------|----------|---------|---------|
| M06 | è³‡æ–™ç®¡ç†æ¨¡çµ„ | è³‡æ–™ç²å–ã€æ¸…æ´—ã€å„²å­˜ã€æ›´æ–°æ’ç¨‹ | JPA (ä¸») + MyBatis (æ‰¹æ¬¡) | ç„¡ | DOC-01-M06 |
| M07 | æŠ€è¡“åˆ†ææ¨¡çµ„ | è¨ˆç®— 71 å€‹æŠ€è¡“æŒ‡æ¨™ | JPA + MyBatis | M06 | DOC-02-M07 |
| M08 | åŸºæœ¬é¢åˆ†ææ¨¡çµ„ | è¨ˆç®— 75 å€‹è²¡å‹™æŒ‡æ¨™ | MyBatis (ä¸») + JPA | M06 | DOC-03-M08 |
| M09 | ç±Œç¢¼åˆ†ææ¨¡çµ„ | åˆ†æä¸‰å¤§æ³•äººã€èè³‡èåˆ¸ | MyBatis | M06 | DOC-04-M09 |
| M10 | æŠ€è¡“å‹æ…‹è¾¨è­˜æ¨¡çµ„ | è­˜åˆ¥ K ç·šã€åœ–è¡¨ã€è¶¨å‹¢å‹æ…‹ | JPA + MyBatis | M06, M07 | DOC-05-M10 |
| M11 | é‡åŒ–ç­–ç•¥æ¨¡çµ„ | ç­–ç•¥æ¡†æ¶ã€ç­–ç•¥åº«ã€åƒæ•¸å„ªåŒ– | MyBatis | M06, M07, M08, M09 | DOC-06-M11 |
| M12 | ç¸½ç¶“èˆ‡ç”¢æ¥­åˆ†ææ¨¡çµ„ | ç¸½ç¶“æŒ‡æ¨™ã€ç”¢æ¥­åˆ†é¡ã€ç”¢æ¥­è¼ªå‹• | JPA (ä¸») | M06, M08 | DOC-07-M12 |
| M13 | ä¿¡è™Ÿåˆ¤æ–·å¼•æ“ | çµ±ä¸€ä¿¡è™Ÿç”Ÿæˆã€å»é‡ã€åˆä½µã€è©•åˆ† | JPA + MyBatis | M07, M08, M09, M10, M11, M12 | DOC-08-M13 |
| M14 | é¸è‚¡å¼•æ“ | å¤šæ¢ä»¶ç¯©é¸ã€é è¨­ç­–ç•¥ã€æ’åºæ’å | MyBatis (ä¸») | M06, M07, M08, M09, M13 | DOC-09-M14 |
| M15 | è­¦å ±é€šçŸ¥ç³»çµ± | è­¦å ±è¨­å®šã€å¤šé€šé“é€šçŸ¥ã€é »ç‡æ§åˆ¶ | JPA (ä¸») | M13 | DOC-10-M15 |
| M16 | å›æ¸¬ç³»çµ± | ç­–ç•¥å›æ¸¬ã€ç¸¾æ•ˆè©•ä¼°ã€åƒæ•¸å„ªåŒ– | MyBatis | M06, M07, M11, M13 | DOC-11-M16 |
| M17 | é¢¨éšªç®¡ç†æ¨¡çµ„ | åœæåœåˆ©ã€éƒ¨ä½ç®¡ç†ã€é¢¨éšªæŒ‡æ¨™ | JPA + MyBatis | M06, M07, M13 | DOC-12-M17 |
| M18 | æŠ•è³‡çµ„åˆç®¡ç† | æŒè‚¡è¨˜éŒ„ã€æç›Šè¨ˆç®—ã€ç¸¾æ•ˆåˆ†æ | JPA + MyBatis | M06, M13, M17 | DOC-13-M18 |

**æŒä¹…å±¤é¸æ“‡èªªæ˜**:
- **JPA (ä¸»)**: è©²æ¨¡çµ„ä¸»è¦ä½¿ç”¨ JPA è™•ç† CRUD
- **MyBatis (ä¸»)**: è©²æ¨¡çµ„ä¸»è¦ä½¿ç”¨ MyBatis è™•ç†è¤‡é›œæŸ¥è©¢
- **JPA + MyBatis**: è©²æ¨¡çµ„éœ€è¦æ··åˆä½¿ç”¨å…©è€…

### 6.2 æ¨¡çµ„ä¾è³´é—œä¿‚åœ–

```
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   M06   â”‚
                        â”‚è³‡æ–™ç®¡ç†  â”‚
                        â”‚JPA+MyBa â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â†“          â†“          â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   M07   â”‚ â”‚   M08   â”‚ â”‚   M09   â”‚
            â”‚æŠ€è¡“åˆ†æ  â”‚ â”‚åŸºæœ¬é¢    â”‚ â”‚ç±Œç¢¼åˆ†æ  â”‚
            â”‚JPA+MyBa â”‚ â”‚MyBatis  â”‚ â”‚MyBatis  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚          â”‚          â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â†“          â†“          â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   M10   â”‚ â”‚   M11   â”‚ â”‚   M12   â”‚
            â”‚å‹æ…‹è¾¨è­˜  â”‚ â”‚é‡åŒ–ç­–ç•¥  â”‚ â”‚ç¸½ç¶“ç”¢æ¥­  â”‚
            â”‚JPA+MyBa â”‚ â”‚MyBatis  â”‚ â”‚  JPA    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚          â”‚          â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   M13   â”‚
                       â”‚ä¿¡è™Ÿå¼•æ“  â”‚
                       â”‚JPA+MyBa â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â†“          â†“          â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   M14   â”‚ â”‚   M15   â”‚ â”‚   M16   â”‚
            â”‚é¸è‚¡å¼•æ“  â”‚ â”‚è­¦å ±é€šçŸ¥  â”‚ â”‚å›æ¸¬ç³»çµ±  â”‚
            â”‚MyBatis  â”‚ â”‚  JPA    â”‚ â”‚MyBatis  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                       â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   M17      â”‚
                    â”‚é¢¨éšªç®¡ç†     â”‚
                    â”‚JPA+MyBatis â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   M18      â”‚
                    â”‚æŠ•è³‡çµ„åˆ     â”‚
                    â”‚JPA+MyBatis â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 æ¨¡çµ„åˆ†å±¤èªªæ˜

**Layer 1: è³‡æ–™å±¤ï¼ˆåŸºç¤ï¼‰**
- M06 è³‡æ–™ç®¡ç†æ¨¡çµ„
- è·è²¬: æä¾›ä¹¾æ·¨ã€æ­£ç¢ºçš„è³‡æ–™çµ¦å…¶ä»–æ¨¡çµ„
- ç‰¹æ€§: ç¨ç«‹ï¼Œç„¡ä¾è³´

**Layer 2: åˆ†æå±¤ï¼ˆæ ¸å¿ƒï¼‰**
- M07 æŠ€è¡“åˆ†ææ¨¡çµ„
- M08 åŸºæœ¬é¢åˆ†ææ¨¡çµ„
- M09 ç±Œç¢¼åˆ†ææ¨¡çµ„
- è·è²¬: åŸºæ–¼åŸå§‹è³‡æ–™é€²è¡Œå„é¡åˆ†æèˆ‡æŒ‡æ¨™è¨ˆç®—
- ä¾è³´: M06

**Layer 3: é€²éšåˆ†æå±¤**
- M10 æŠ€è¡“å‹æ…‹è¾¨è­˜æ¨¡çµ„
- M11 é‡åŒ–ç­–ç•¥æ¨¡çµ„
- M12 ç¸½ç¶“èˆ‡ç”¢æ¥­åˆ†ææ¨¡çµ„
- è·è²¬: åŸºæ–¼ Layer 2 çš„åˆ†æçµæœé€²è¡Œæ›´é«˜å±¤æ¬¡çš„åˆ¤æ–·
- ä¾è³´: M06, M07, M08, M09

**Layer 4: ä¿¡è™Ÿå±¤**
- M13 ä¿¡è™Ÿåˆ¤æ–·å¼•æ“
- è·è²¬: æ•´åˆæ‰€æœ‰åˆ†æçµæœï¼Œç”¢ç”Ÿçµ±ä¸€çš„è²·è³£ä¿¡è™Ÿ
- ä¾è³´: M07, M08, M09, M10, M11, M12

**Layer 5: æ‡‰ç”¨å±¤**
- M14 é¸è‚¡å¼•æ“
- M15 è­¦å ±é€šçŸ¥ç³»çµ±
- M16 å›æ¸¬ç³»çµ±
- è·è²¬: åŸºæ–¼ä¿¡è™Ÿæä¾›å„é¡æ‡‰ç”¨åŠŸèƒ½
- ä¾è³´: M13

**Layer 6: ç®¡ç†å±¤**
- M17 é¢¨éšªç®¡ç†æ¨¡çµ„
- M18 æŠ•è³‡çµ„åˆç®¡ç†
- è·è²¬: è³‡é‡‘ç®¡ç†èˆ‡ç¸¾æ•ˆè¿½è¹¤
- ä¾è³´: M06, M13, M17

### 6.4 æ¨¡çµ„é–“é€šè¨Šæ–¹å¼

| é€šè¨Šæ–¹å¼ | ä½¿ç”¨å ´æ™¯ | ç¯„ä¾‹ | å„ªé» | ç¼ºé» |
|---------|---------|------|------|------|
| **ç›´æ¥å‘¼å«** | åŒæ­¥è™•ç†ï¼Œå¯¦æ™‚å›æ‡‰ | Controller â†’ Service â†’ Repository | ç°¡å–®ç›´æ¥ | å¼·è€¦åˆ |
| **äº‹ä»¶é©…å‹•** | éåŒæ­¥è™•ç†ï¼Œè§£è€¦æ¨¡çµ„ | ä¿¡è™Ÿç”¢ç”Ÿ â†’ ç™¼å¸ƒäº‹ä»¶ â†’ é€šçŸ¥ç³»çµ±ç›£è½ | è§£è€¦ï¼Œæ“´å±•æ€§å¥½ | è¤‡é›œåº¦è¼ƒé«˜ |
| **Job æ’ç¨‹** | æ‰¹æ¬¡è™•ç†ï¼Œå®šæ™‚åŸ·è¡Œ | æ¯æ—¥è³‡æ–™æ›´æ–°ã€æŒ‡æ¨™è¨ˆç®— | å¯æ§æ™‚é–“ | ä¸é©åˆå³æ™‚è™•ç† |
| **è¨Šæ¯ä½‡åˆ—** | é«˜ä½µç™¼ã€å¯é æ€§è¦æ±‚ | å¤§é‡é€šçŸ¥ç™¼é€ï¼ˆå¯é¸ï¼Œæœªä¾†æ“´å……ï¼‰ | é«˜å¯é æ€§ | å¢åŠ ç³»çµ±è¤‡é›œåº¦ |

### 6.5 æ¨¡çµ„é–‹ç™¼å„ªå…ˆç´š

**Phase 1: MVP æ ¸å¿ƒï¼ˆå¿…é ˆï¼‰**
1. M06 è³‡æ–™ç®¡ç†æ¨¡çµ„
2. M07 æŠ€è¡“åˆ†ææ¨¡çµ„ï¼ˆéƒ¨åˆ†æŒ‡æ¨™ï¼‰
3. M13 ä¿¡è™Ÿåˆ¤æ–·å¼•æ“ï¼ˆç°¡åŒ–ç‰ˆï¼‰
4. M15 è­¦å ±é€šçŸ¥ç³»çµ±ï¼ˆåŸºç¤åŠŸèƒ½ï¼‰

**Phase 2: æ ¸å¿ƒåŠŸèƒ½å®Œå–„**
1. M07 æŠ€è¡“åˆ†ææ¨¡çµ„ï¼ˆå®Œæ•´ï¼‰
2. M08 åŸºæœ¬é¢åˆ†ææ¨¡çµ„
3. M09 ç±Œç¢¼åˆ†ææ¨¡çµ„
4. M14 é¸è‚¡å¼•æ“

**Phase 3: é€²éšåŠŸèƒ½**
1. M10 æŠ€è¡“å‹æ…‹è¾¨è­˜æ¨¡çµ„
2. M11 é‡åŒ–ç­–ç•¥æ¨¡çµ„
3. M16 å›æ¸¬ç³»çµ±
4. M17 é¢¨éšªç®¡ç†æ¨¡çµ„
5. M18 æŠ•è³‡çµ„åˆç®¡ç†

**Phase 4: æ“´å±•åŠŸèƒ½**
1. M12 ç¸½ç¶“èˆ‡ç”¢æ¥­åˆ†ææ¨¡çµ„
2. å‰ç«¯æ•´åˆ
3. æ•ˆèƒ½å„ªåŒ–
4. ç›£æ§èˆ‡å‘Šè­¦å®Œå–„

---

## 7. éåŠŸèƒ½æ€§éœ€æ±‚ (NFR)

### 7.1 æ•ˆèƒ½éœ€æ±‚ (Performance)

#### 7.1.1 å›æ‡‰æ™‚é–“ç›®æ¨™

| API é¡å‹ | P50 | P95 | P99 | èªªæ˜ |
|---------|-----|-----|-----|------|
| ç°¡å–®æŸ¥è©¢ API | < 100ms | < 200ms | < 500ms | å–®è¡¨æŸ¥è©¢ï¼Œæœ‰ç´¢å¼• |
| ä¸€èˆ¬æŸ¥è©¢ API | < 200ms | < 500ms | < 1s | å¤šè¡¨ JOINï¼Œè¤‡é›œæ¢ä»¶ |
| è¤‡é›œè¨ˆç®— API | < 1s | < 2s | < 5s | å›æ¸¬ã€å¤šæ¢ä»¶é¸è‚¡ |
| æ‰¹æ¬¡å°å‡º API | < 5s | < 10s | < 30s | å¤§é‡è³‡æ–™å°å‡º |

#### 7.1.2 ååé‡ç›®æ¨™

| æŒ‡æ¨™ | ç›®æ¨™å€¼ | èªªæ˜ |
|-----|-------|------|
| API ä½µç™¼è™•ç†èƒ½åŠ› | > 500 req/s | å–®æ©Ÿæ”¯æ´ä½µç™¼è«‹æ±‚æ•¸ |
| è³‡æ–™åº«é€£ç·šæ•¸ | 50 - 100 | é€£ç·šæ± å¤§å° |
| å¿«å–å‘½ä¸­ç‡ | > 80% | ç†±è³‡æ–™å¿«å–æ–¼ Redis |
| Job åŸ·è¡Œæ™‚é–“ | è‚¡åƒ¹åŒæ­¥: < 5åˆ†é˜<br>æŒ‡æ¨™è¨ˆç®—: < 10åˆ†é˜ | æ‰¹æ¬¡ä»»å‹™åŸ·è¡Œæ™‚é•· |

#### 7.1.3 è³‡æºä½¿ç”¨é™åˆ¶

| è³‡æº | é™åˆ¶ | èªªæ˜ |
|-----|------|------|
| JVM Heap Memory | 2GB - 4GB | ä¾æ“šä¼ºæœå™¨è¦æ ¼èª¿æ•´ |
| å–®æ¬¡æŸ¥è©¢çµæœæ•¸ | < 1000 ç­† | ä½¿ç”¨åˆ†é é¿å…è¨˜æ†¶é«”æº¢ä½ |
| æª”æ¡ˆå¤§å° | < 50MB | ä¸Šå‚³æª”æ¡ˆå¤§å°é™åˆ¶ |
| WebSocket é€£ç·šæ•¸ | < 10,000 | åŒæ™‚ WebSocket é€£ç·šæ•¸ |

#### 7.1.4 æ•ˆèƒ½å„ªåŒ–ç­–ç•¥

**è³‡æ–™åº«å„ªåŒ–**:
- é©ç•¶ç´¢å¼•è¨­è¨ˆ
- é¿å… SELECT *ï¼ŒåªæŸ¥è©¢éœ€è¦çš„æ¬„ä½
- ä½¿ç”¨åˆ†é æŸ¥è©¢
- è®€å¯«åˆ†é›¢ï¼ˆMaster-Slaveï¼‰

**å¿«å–ç­–ç•¥**:
- ç†±è³‡æ–™å¿«å–æ–¼ Redisï¼ˆè‚¡åƒ¹ã€æŒ‡æ¨™ã€ä¿¡è™Ÿï¼‰
- è¨­å®šé©ç•¶çš„ TTLï¼ˆTime To Liveï¼‰
- å¿«å–é ç†±ï¼ˆç³»çµ±å•Ÿå‹•æ™‚è¼‰å…¥å¸¸ç”¨è³‡æ–™ï¼‰
- Cache-Aside æ¨¡å¼

**ç¨‹å¼ç¢¼å„ªåŒ–**:
- ä½¿ç”¨éåŒæ­¥è™•ç†ï¼ˆ@Asyncï¼‰
- æ‰¹æ¬¡è™•ç†æ›¿ä»£é€ç­†è™•ç†
- é¿å… N+1 æŸ¥è©¢å•é¡Œ
- ä½¿ç”¨é€£ç·šæ± ç®¡ç†

**æ¶æ§‹å„ªåŒ–**:
- è² è¼‰å‡è¡¡ï¼ˆå¤šå¯¦ä¾‹éƒ¨ç½²ï¼‰
- CDN åŠ é€Ÿéœæ…‹è³‡æº
- API å›æ‡‰å£“ç¸®ï¼ˆGzipï¼‰

---

### 7.2 å¯ç”¨æ€§éœ€æ±‚ (Availability)

#### 7.2.1 å¯ç”¨æ€§ç›®æ¨™

| æŒ‡æ¨™ | ç›®æ¨™å€¼ | è¨ˆç®—èªªæ˜ |
|-----|-------|---------|
| ç³»çµ±å¯ç”¨æ€§ | 99.5% | æ¯æœˆåœæ©Ÿæ™‚é–“ < 3.6 å°æ™‚ |
| è¨ˆç•«æ€§ç¶­è­·æ™‚é–“ | < 2å°æ™‚/æœˆ | é¸åœ¨ä½æµé‡æ™‚æ®µï¼ˆå¦‚é€±æ—¥å‡Œæ™¨ï¼‰ |
| éè¨ˆç•«æ€§åœæ©Ÿ | < 1å°æ™‚/æœˆ | æ•…éšœå¿«é€Ÿæ¢å¾© |

#### 7.2.2 å‚™ä»½èˆ‡æ¢å¾©

| é …ç›® | ç­–ç•¥ | é »ç‡ | ä¿ç•™æœŸé™ |
|-----|------|------|---------|
| è³‡æ–™åº«å®Œæ•´å‚™ä»½ | mysqldump | æ¯æ—¥ 02:00 | 30 å¤© |
| è³‡æ–™åº«å¢é‡å‚™ä»½ | Binary Log | å¯¦æ™‚ | 7 å¤© |
| æ‡‰ç”¨ç¨‹å¼ç¢¼ | Git Repository | æ¯æ¬¡ Commit | æ°¸ä¹… |
| ç³»çµ±é…ç½®æª” | ç‰ˆæœ¬æ§åˆ¶ + å‚™ä»½ | æ¯æ¬¡ä¿®æ”¹ | æ°¸ä¹… |

**ç½é›£æ¢å¾©ç›®æ¨™**:
- RTO (Recovery Time Objective): < 4 å°æ™‚
- RPO (Recovery Point Objective): < 24 å°æ™‚

#### 7.2.3 é«˜å¯ç”¨ç­–ç•¥

**æ‡‰ç”¨å±¤é«˜å¯ç”¨**:
- ç„¡ç‹€æ…‹è¨­è¨ˆï¼ˆSession å­˜æ–¼ Redisï¼‰
- å¤šå¯¦ä¾‹éƒ¨ç½² + è² è¼‰å‡è¡¡
- Docker å®¹å™¨åŒ–ï¼Œå¿«é€Ÿé‡å•Ÿ
- å¥åº·æª¢æŸ¥èˆ‡è‡ªå‹•é‡å•Ÿ

**è³‡æ–™å±¤é«˜å¯ç”¨**:
- MySQL ä¸»å¾è¤‡è£½ï¼ˆMaster-Slaveï¼‰
- Redis å“¨å…µæ¨¡å¼ï¼ˆå¯é¸ï¼‰
- å®šæœŸå‚™ä»½èˆ‡é©—è­‰æ¢å¾©æµç¨‹

**ç›£æ§èˆ‡å‘Šè­¦**:
- å¥åº·æª¢æŸ¥ API (`/actuator/health`)
- é—œéµæŒ‡æ¨™ç›£æ§ï¼ˆCPUã€è¨˜æ†¶é«”ã€ç£ç¢Ÿï¼‰
- ç•°å¸¸è‡ªå‹•å‘Šè­¦ï¼ˆEmail + Slackï¼‰

---

### 7.3 å¯æ“´å±•æ€§éœ€æ±‚ (Scalability)

#### 7.3.1 æ“´å±•æ–¹å¼

**æ°´å¹³æ“´å±• (Scale-Out)**:
- æ‡‰ç”¨å±¤: å¢åŠ æ‡‰ç”¨å¯¦ä¾‹ï¼ˆDocker å®¹å™¨ï¼‰
- å¿«å–å±¤: Redis Cluster
- è³‡æ–™åº«: åˆ†åº«åˆ†è¡¨ï¼ˆæœªä¾†è¦åŠƒï¼‰

**å‚ç›´æ“´å±• (Scale-Up)**:
- æå‡ä¼ºæœå™¨ç¡¬é«”è¦æ ¼ï¼ˆCPUã€è¨˜æ†¶é«”ã€ç£ç¢Ÿï¼‰
- å„ªåŒ–è³‡æ–™åº«é…ç½®ï¼ˆé€£ç·šæ•¸ã€å¿«å–å¤§å°ï¼‰

#### 7.3.2 æ“´å±•æŒ‡æ¨™

| é¢å‘ | ç•¶å‰æ”¯æ´ | æ“´å±•å¾Œç›®æ¨™ |
|-----|---------|----------|
| ä½µç™¼ä½¿ç”¨è€…æ•¸ | 1,000 | 10,000+ |
| è‚¡ç¥¨æ•¸é‡ | 2,000ï¼ˆå°è‚¡å…¨å¸‚å ´ï¼‰ | 10,000+ï¼ˆè·¨å¸‚å ´ï¼‰ |
| æ­·å²è³‡æ–™ | 5å¹´ | 20å¹´+ |
| API è«‹æ±‚é‡ | 500 req/s | 5,000 req/s |

#### 7.3.3 æ¨¡çµ„åŒ–è¨­è¨ˆ

**ç•¶å‰æ¶æ§‹**: Monolithicï¼ˆå–®é«”æ‡‰ç”¨ï¼‰
**æœªä¾†è¦åŠƒ**: Microservicesï¼ˆå¾®æœå‹™ï¼‰

**å¯æ‹†åˆ†çš„æ¨¡çµ„**:
1. è³‡æ–™ç®¡ç†æœå‹™
2. åˆ†æè¨ˆç®—æœå‹™
3. ä¿¡è™Ÿå¼•æ“æœå‹™
4. é€šçŸ¥æœå‹™
5. ä½¿ç”¨è€…æœå‹™

**å„ªé»**:
- ç¨ç«‹éƒ¨ç½²èˆ‡æ“´å±•
- æ•…éšœéš”é›¢
- æŠ€è¡“æ£§å½ˆæ€§

**ç¼ºé»**:
- ç³»çµ±è¤‡é›œåº¦æé«˜
- éœ€è¦æœå‹™æ²»ç†ï¼ˆService Meshï¼‰

---

### 7.4 å®‰å…¨æ€§éœ€æ±‚ (Security)

#### 7.4.1 èªè­‰èˆ‡æˆæ¬Š

**èªè­‰æ©Ÿåˆ¶**:
- JWT Token èªè­‰
- Token æœ‰æ•ˆæœŸ: Access Token 2å°æ™‚, Refresh Token 7å¤©
- å¯†ç¢¼åŠ å¯†: BCrypt (å¼·åº¦ 10)

**æˆæ¬Šæ©Ÿåˆ¶**:
- RBACï¼ˆåŸºæ–¼è§’è‰²çš„å­˜å–æ§åˆ¶ï¼‰
- API å±¤ç´šæ¬Šé™æª¢æŸ¥
- è³‡æ–™å±¤ç´šæ¬Šé™æª¢æŸ¥ï¼ˆRow-Level Securityï¼‰

**å¤šå› ç´ èªè­‰ (MFA)** - å¯é¸:
- Email OTP
- SMS OTP
- Google Authenticator

#### 7.4.2 è³‡æ–™å‚³è¼¸å®‰å…¨

| é¢å‘ | è¦æ±‚ | å¯¦ä½œæ–¹å¼ |
|-----|------|---------|
| HTTPS | å¿…é ˆ | TLS 1.2+ |
| API Token | åŠ å¯†å‚³è¼¸ | HTTPS + JWT |
| WebSocket | åŠ å¯†é€£ç·š | WSS (WebSocket Secure) |
| æ•æ„Ÿè³‡æ–™ | é¡å¤–åŠ å¯† | AES-256ï¼ˆå¦‚å¯†ç¢¼ã€API Keyï¼‰ |

#### 7.4.3 è³‡æ–™å„²å­˜å®‰å…¨

| è³‡æ–™é¡å‹ | åŠ å¯†æ–¹å¼ | èªªæ˜ |
|---------|---------|------|
| ä½¿ç”¨è€…å¯†ç¢¼ | BCrypt Hash | å–®å‘åŠ å¯†ï¼Œä¸å¯é€† |
| API Key | AES-256 | å°ç¨±åŠ å¯†ï¼Œå¯è§£å¯† |
| JWT Secret | ç’°å¢ƒè®Šæ•¸ | ä¸å¯«å…¥ç¨‹å¼ç¢¼ï¼Œä¸é€²ç‰ˆæ§ |
| è³‡æ–™åº«é€£ç·šå¯†ç¢¼ | ç’°å¢ƒè®Šæ•¸ | ä¸å¯«å…¥ç¨‹å¼ç¢¼ |

#### 7.4.4 å®‰å…¨é˜²è­·

**SQL æ³¨å…¥é˜²è­·**:
- ä½¿ç”¨ JPA/Hibernateï¼ˆåƒæ•¸åŒ–æŸ¥è©¢ï¼‰
- é¿å…æ‹¼æ¥ SQL å­—ä¸²

**XSS é˜²è­·**:
- å‰ç«¯è¼¸å‡ºç·¨ç¢¼
- Content Security Policy (CSP)

**CSRF é˜²è­·**:
- Spring Security CSRF Token
- SameSite Cookie å±¬æ€§

**DDoS é˜²è­·**:
- API Rate Limiting
- IP é»‘åå–®
- WAF (Web Application Firewall) - å¯é¸

**æ•æ„Ÿè³‡æ–™é®ç½©**:
- Log ä¸è¨˜éŒ„å¯†ç¢¼ã€Token
- API å›æ‡‰ä¸è¿”å›æ•æ„Ÿæ¬„ä½

#### 7.4.5 å®‰å…¨å¯©è¨ˆ

**æ“ä½œæ—¥èªŒè¨˜éŒ„**:
- ä½¿ç”¨è€…ç™»å…¥/ç™»å‡º
- é‡è¦è³‡æ–™ä¿®æ”¹ï¼ˆä¿¡è™Ÿã€è­¦å ±ã€äº¤æ˜“ï¼‰
- æ¬Šé™è®Šæ›´
- ç•°å¸¸æ“ä½œ

**æ—¥èªŒå…§å®¹**:
```
æ™‚é–“æˆ³ | ä½¿ç”¨è€…ID | IPä½å€ | æ“ä½œé¡å‹ | è³‡æº | çµæœ | è©³ç´°è³‡è¨Š
```

**æ—¥èªŒä¿ç•™**: 90 å¤©

---

### 7.5 å¯è§€æ¸¬æ€§éœ€æ±‚ (Observability)

#### 7.5.1 æ—¥èªŒ (Logging)

**æ—¥èªŒç´šåˆ¥**:
- DEBUG: é–‹ç™¼ç’°å¢ƒè©³ç´°è³‡è¨Š
- INFO: æ­£å¸¸æ“ä½œè³‡è¨Šï¼ˆå¦‚ Job åŸ·è¡Œï¼‰
- WARN: è­¦å‘Šè¨Šæ¯ï¼ˆä¸å½±éŸ¿ç³»çµ±é‹ä½œï¼‰
- ERROR: éŒ¯èª¤è¨Šæ¯ï¼ˆéœ€è¦è™•ç†ï¼‰

**æ—¥èªŒå…§å®¹è¦æ±‚**:
```
[æ™‚é–“æˆ³] [ç´šåˆ¥] [Thread] [é¡åˆ¥] [trace_id] [user_id] - è¨Šæ¯å…§å®¹
```

**ç¯„ä¾‹**:
```
2024-12-22 15:30:05.123 INFO [http-nio-8080-exec-1] [StockController] 
[trace_id=abc123] [user_id=user456] - Fetching stock data for 2330
```

**æ—¥èªŒç®¡ç†**:
- æ»¾å‹•ç­–ç•¥: æ¯æ—¥æˆ– 100MB
- ä¿ç•™æœŸé™: 30 å¤©
- æ—¥èªŒæ ¼å¼: JSONï¼ˆä¾¿æ–¼è§£æï¼‰

#### 7.5.2 æŒ‡æ¨™ (Metrics)

**ä½¿ç”¨ Micrometer + Spring Actuator**

**ç³»çµ±æŒ‡æ¨™**:
- JVM Heap Memory ä½¿ç”¨ç‡
- JVM GC é »ç‡èˆ‡æ™‚é–“
- CPU ä½¿ç”¨ç‡
- åŸ·è¡Œç·’æ•¸é‡

**æ‡‰ç”¨æŒ‡æ¨™**:
- API è«‹æ±‚æ•¸ï¼ˆç¸½æ•¸ã€æˆåŠŸã€å¤±æ•—ï¼‰
- API å›æ‡‰æ™‚é–“ï¼ˆP50, P95, P99ï¼‰
- è³‡æ–™åº«é€£ç·šæ± ä½¿ç”¨ç‡
- Redis é€£ç·šæ•¸èˆ‡å‘½ä¸­ç‡

**æ¥­å‹™æŒ‡æ¨™**:
- æ¯æ—¥æ–°å¢ä¿¡è™Ÿæ•¸
- è­¦å ±è§¸ç™¼æ¬¡æ•¸
- Job åŸ·è¡ŒæˆåŠŸç‡
- ä½¿ç”¨è€…æ´»èºæ•¸

**æŒ‡æ¨™åŒ¯å‡º**:
- Prometheus (å¯é¸)
- InfluxDB (å¯é¸)

#### 7.5.3 è¿½è¹¤ (Tracing)

**Request Tracing**:
- æ¯å€‹ API è«‹æ±‚ç”¢ç”Ÿå”¯ä¸€ `trace_id`
- trace_id è¨˜éŒ„æ–¼ Response Header èˆ‡ Log
- æ–¹ä¾¿å•é¡Œè¿½è¹¤èˆ‡é™¤éŒ¯

**Trace ID ç”Ÿæˆ**:
- UUID æ ¼å¼
- åœ¨ Filter/Interceptor å±¤ç´šç”¢ç”Ÿ
- é€é MDC (Mapped Diagnostic Context) å‚³é

**åˆ†æ•£å¼è¿½è¹¤** - æœªä¾†æ“´å……:
- Spring Cloud Sleuth + Zipkin

#### 7.5.4 å¥åº·æª¢æŸ¥

**Spring Actuator Endpoints**:
- `/actuator/health`: æ•´é«”å¥åº·ç‹€æ…‹
- `/actuator/health/db`: è³‡æ–™åº«é€£ç·šç‹€æ…‹
- `/actuator/health/redis`: Redis é€£ç·šç‹€æ…‹
- `/actuator/metrics`: ç³»çµ±æŒ‡æ¨™
- `/actuator/info`: æ‡‰ç”¨è³‡è¨Š

**å¥åº·æª¢æŸ¥å…§å®¹**:
```json
{
  "status": "UP",
  "components": {
    "db": {
      "status": "UP",
      "details": {
        "database": "MySQL",
        "validationQuery": "SELECT 1"
      }
    },
    "redis": {
      "status": "UP",
      "details": {
        "version": "7.0.5"
      }
    },
    "diskSpace": {
      "status": "UP",
      "details": {
        "free": 10737418240,
        "threshold": 10485760
      }
    }
  }
}
```

#### 7.5.5 å‘Šè­¦ç­–ç•¥

**å‘Šè­¦ç´šåˆ¥**:
- CRITICAL: ç³»çµ±ä¸å¯ç”¨ï¼Œç«‹å³è™•ç†
- HIGH: å½±éŸ¿æ ¸å¿ƒåŠŸèƒ½ï¼Œ1å°æ™‚å…§è™•ç†
- MEDIUM: å½±éŸ¿éƒ¨åˆ†åŠŸèƒ½ï¼Œ4å°æ™‚å…§è™•ç†
- LOW: è³‡è¨Šé€šçŸ¥ï¼Œå®šæœŸæŸ¥çœ‹

**å‘Šè­¦æ¢ä»¶ç¯„ä¾‹**:

| å‘Šè­¦é …ç›® | æ¢ä»¶ | ç´šåˆ¥ | é€šçŸ¥æ–¹å¼ |
|---------|------|------|---------|
| æ‡‰ç”¨åœæ­¢é‹è¡Œ | Health Check å¤±æ•— | CRITICAL | Email + Slack + SMS |
| è³‡æ–™åº«é€£ç·šå¤±æ•— | é€£çºŒå¤±æ•— 3 æ¬¡ | CRITICAL | Email + Slack |
| API éŒ¯èª¤ç‡éé«˜ | éŒ¯èª¤ç‡ > 5% | HIGH | Email + Slack |
| JVM Memory éé«˜ | ä½¿ç”¨ç‡ > 90% | HIGH | Slack |
| é—œéµ Job å¤±æ•— | é€£çºŒå¤±æ•— 3 æ¬¡ | HIGH | Email |
| ç£ç¢Ÿç©ºé–“ä¸è¶³ | å‰©é¤˜ç©ºé–“ < 10% | MEDIUM | Email |
| Redis å‘½ä¸­ç‡ä½ | å‘½ä¸­ç‡ < 60% | LOW | æ¯æ—¥å½™æ•´ |

---

### 7.6 å¯ç¶­è­·æ€§éœ€æ±‚ (Maintainability)

#### 7.6.1 ç¨‹å¼ç¢¼å“è³ªè¦æ±‚

**ç¨‹å¼ç¢¼è¦ç¯„**:
- éµå¾ª Google Java Style Guide
- ä½¿ç”¨ Checkstyle / SonarLint æª¢æŸ¥
- Pull Request å‰å¿…é ˆé€šé Code Review

**æ¸¬è©¦è¦†è“‹ç‡**:
- Service å±¤: > 70%
- Repository å±¤: > 60%
- Controller å±¤: > 50%

**ç¨‹å¼ç¢¼è¤‡é›œåº¦**:
- å–®ä¸€æ–¹æ³•ä¸è¶…é 50 è¡Œ
- åœˆè¤‡é›œåº¦ (Cyclomatic Complexity) < 10
- é¿å…éæ·±çš„å·¢ç‹€ (< 3å±¤)

#### 7.6.2 æ–‡æª”è¦æ±‚

**å¿…è¦æ–‡æª”**:
- README.md: å°ˆæ¡ˆèªªæ˜èˆ‡å¿«é€Ÿé–‹å§‹
- API æ–‡æª”: Swagger/OpenAPIï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
- æ¶æ§‹æ–‡æª”: æœ¬ç³»åˆ— SA/SD æ–‡ä»¶
- è³‡æ–™åº«æ–‡æª”: ERD + è³‡æ–™å­—å…¸
- éƒ¨ç½²æ–‡æª”: ç’°å¢ƒé…ç½®èˆ‡éƒ¨ç½²æ­¥é©Ÿ

**JavaDoc è¨»è§£**:
- æ‰€æœ‰ public æ–¹æ³•å¿…é ˆæœ‰ JavaDoc
- èªªæ˜æ–¹æ³•ç”¨é€”ã€åƒæ•¸ã€å›å‚³å€¼ã€å¯èƒ½çš„ç•°å¸¸

#### 7.6.3 ç‰ˆæœ¬æ§åˆ¶

**Git åˆ†æ”¯ç®¡ç†**:
- `main`: ç”Ÿç”¢ç’°å¢ƒ
- `develop`: é–‹ç™¼ä¸»åˆ†æ”¯
- `feature/*`: åŠŸèƒ½é–‹ç™¼åˆ†æ”¯
- `bugfix/*`: Bug ä¿®å¾©åˆ†æ”¯
- `hotfix/*`: ç·Šæ€¥ä¿®å¾©åˆ†æ”¯

**Commit Message è¦ç¯„**:
```
<type>(<scope>): <subject>

<body>

<footer>
```

**Type**: feat, fix, docs, style, refactor, test, chore

#### 7.6.4 ç›£æ§èˆ‡æ—¥èªŒ

å·²åœ¨ 7.5 ç¯€è©³è¿°ã€‚

---

### 7.7 å¯æ¸¬è©¦æ€§éœ€æ±‚ (Testability)

#### 7.7.1 æ¸¬è©¦ç­–ç•¥

**æ¸¬è©¦é‡‘å­—å¡”**:
```
        /\
       /E2E\      (å°‘é‡ç«¯åˆ°ç«¯æ¸¬è©¦)
      /------\
     /æ•´åˆæ¸¬è©¦ \   (ä¸­é‡æ•´åˆæ¸¬è©¦)
    /----------\
   /  å–®å…ƒæ¸¬è©¦   \  (å¤§é‡å–®å…ƒæ¸¬è©¦)
  /--------------\
```

#### 7.7.2 æ¸¬è©¦é¡å‹

**å–®å…ƒæ¸¬è©¦ (Unit Test)**:
- æ¸¬è©¦å–®ä¸€æ–¹æ³•æˆ–é¡åˆ¥
- ä½¿ç”¨ Mock éš”é›¢ä¾è³´
- åŸ·è¡Œé€Ÿåº¦å¿«

**æ•´åˆæ¸¬è©¦ (Integration Test)**:
- æ¸¬è©¦æ¨¡çµ„é–“æ•´åˆ
- æ¸¬è©¦èˆ‡è³‡æ–™åº«ã€Redis çš„æ•´åˆ
- ä½¿ç”¨ Testcontainers æä¾›æ¸¬è©¦ç’°å¢ƒ

**API æ¸¬è©¦**:
- æ¸¬è©¦ REST API ç«¯é»
- ä½¿ç”¨ MockMvc æˆ– RestAssured
- é©—è­‰ Request/Response æ ¼å¼

**æ•ˆèƒ½æ¸¬è©¦** - å¯é¸:
- ä½¿ç”¨ JMeter / Gatling
- æ¸¬è©¦ API å›æ‡‰æ™‚é–“èˆ‡ååé‡
- æ‰¾å‡ºæ•ˆèƒ½ç“¶é ¸

#### 7.7.3 æ¸¬è©¦ç’°å¢ƒ

**æ¸¬è©¦è³‡æ–™åº«**:
- ä½¿ç”¨ H2 In-Memory Databaseï¼ˆå¿«é€Ÿï¼‰
- æˆ–ä½¿ç”¨ Testcontainersï¼ˆçœŸå¯¦ç’°å¢ƒï¼‰

**æ¸¬è©¦è³‡æ–™**:
- æº–å‚™æ¸¬è©¦è³‡æ–™é›†ï¼ˆTest Fixturesï¼‰
- æ¯æ¬¡æ¸¬è©¦å¾Œæ¸…ç†è³‡æ–™

**Mock å¤–éƒ¨æœå‹™**:
- ä½¿ç”¨ WireMock æ¨¡æ“¬å¤–éƒ¨ API
- é¿å…æ¸¬è©¦ä¾è³´å¤–éƒ¨æœå‹™å¯ç”¨æ€§

---

### 7.8 å¯éƒ¨ç½²æ€§éœ€æ±‚ (Deployability)

#### 7.8.1 éƒ¨ç½²æ–¹å¼

**å®¹å™¨åŒ–éƒ¨ç½²**:
- ä½¿ç”¨ Docker æ‰“åŒ…æ‡‰ç”¨
- Docker Compose ç·¨æ’å¤šå®¹å™¨
- Kubernetesï¼ˆæœªä¾†è¦åŠƒï¼‰

**å‚³çµ±éƒ¨ç½²**:
- JAR æª”æ¡ˆ + systemd æœå‹™
- ç›´æ¥åœ¨ä¼ºæœå™¨ä¸Šé‹è¡Œ

#### 7.8.2 ç’°å¢ƒéš”é›¢

**å¤šç’°å¢ƒæ”¯æ´**:
- é–‹ç™¼ç’°å¢ƒ (dev)
- æ¸¬è©¦ç’°å¢ƒ (test)
- ç”Ÿç”¢ç’°å¢ƒ (prod)

**é…ç½®ç®¡ç†**:
- ä½¿ç”¨ Spring Profiles
- ç’°å¢ƒè®Šæ•¸å„ªå…ˆæ–¼é…ç½®æª”
- æ•æ„Ÿè³‡è¨Šä¸é€²ç‰ˆæ§

#### 7.8.3 CI/CD æµç¨‹

**æŒçºŒæ•´åˆ (CI)**:
```
ç¨‹å¼ç¢¼æäº¤ â†’ ç·¨è­¯ â†’ å–®å…ƒæ¸¬è©¦ â†’ æ•´åˆæ¸¬è©¦ â†’ ç¨‹å¼ç¢¼æª¢æŸ¥ â†’ å»ºç½® Docker Image
```

**æŒçºŒéƒ¨ç½² (CD)**:
```
Docker Image â†’ æ¨é€åˆ° Registry â†’ éƒ¨ç½²åˆ°æ¸¬è©¦ç’°å¢ƒ â†’ è‡ªå‹•åŒ–æ¸¬è©¦ â†’ éƒ¨ç½²åˆ°ç”Ÿç”¢ç’°å¢ƒ
```

**å»ºè­°å·¥å…·**:
- CI/CD Platform: GitHub Actions / GitLab CI / Jenkins
- Container Registry: Docker Hub / GitLab Registry
- éƒ¨ç½²å·¥å…·: Ansible / Kubernetes

#### 7.8.4 å›æ»¾ç­–ç•¥

**å›æ»¾è§¸ç™¼æ¢ä»¶**:
- éƒ¨ç½²å¾Œå¥åº·æª¢æŸ¥å¤±æ•—
- éŒ¯èª¤ç‡çªç„¶å‡é«˜
- ä½¿ç”¨è€…å›å ±åš´é‡å•é¡Œ

**å›æ»¾æ­¥é©Ÿ**:
1. åœæ­¢æ–°ç‰ˆæœ¬æœå‹™
2. å•Ÿå‹•èˆŠç‰ˆæœ¬æœå‹™
3. é©—è­‰èˆŠç‰ˆæœ¬é‹ä½œæ­£å¸¸
4. èª¿æŸ¥å•é¡ŒåŸå› 

**è—ç¶ éƒ¨ç½²** - æœªä¾†è¦åŠƒ:
- åŒæ™‚é‹è¡Œå…©å€‹ç‰ˆæœ¬ï¼ˆè—/ç¶ ï¼‰
- åˆ‡æ›æµé‡åˆ°æ–°ç‰ˆæœ¬
- è‹¥æœ‰å•é¡Œç«‹å³åˆ‡å›èˆŠç‰ˆæœ¬

---

## 8. é–‹ç™¼æº–å‰‡

### 8.1 ç¨‹å¼ç¢¼è¦ç¯„

#### 8.1.1 Java ç¨‹å¼ç¢¼é¢¨æ ¼

**åŸºæœ¬è¦ç¯„**:
- éµå¾ª Google Java Style Guide
- ä½¿ç”¨ 4 ç©ºæ ¼ç¸®æ’ï¼ˆä¸ä½¿ç”¨ Tabï¼‰
- æ¯è¡Œä¸è¶…é 120 å­—å…ƒ
- ä½¿ç”¨æœ‰æ„ç¾©çš„è®Šæ•¸èˆ‡æ–¹æ³•åç¨±

**å‘½åè¦ç¯„**:
- é¡åˆ¥åç¨±: `PascalCase` (ä¾‹: `StockService`)
- æ–¹æ³•åç¨±: `camelCase` (ä¾‹: `getStockById`)
- å¸¸æ•¸: `UPPER_SNAKE_CASE` (ä¾‹: `MAX_RETRY_COUNT`)
- è®Šæ•¸: `camelCase` (ä¾‹: `stockPrice`)
- å¥—ä»¶: å…¨å°å¯« (ä¾‹: `com.example.stock`)

**é¡åˆ¥å‘½åè¦ç¯„**:
```
Controller:  XxxController  (ä¾‹: StockController)
Service:     XxxService     (ä¾‹: StockService)
ServiceImpl: XxxServiceImpl (ä¾‹: StockServiceImpl)
Repository:  XxxRepository  (ä¾‹: StockRepository)
Mapper:      XxxMapper      (ä¾‹: SignalMapper)
Entity:      Xxx            (ä¾‹: Stock, Signal)
DTO:         XxxDTO         (ä¾‹: StockDTO, SignalDTO)
Request:     XxxRequest     (ä¾‹: CreateAlertRequest)
Response:    XxxResponse    (ä¾‹: StockListResponse)
Config:      XxxConfig      (ä¾‹: RedisConfig)
Utils:       XxxUtils       (ä¾‹: DateUtils)
```

#### 8.1.2 ç¨‹å¼ç¢¼çµ„ç¹”

**å¥—ä»¶çµæ§‹**:
```
com.example.stockmonitor
â”œâ”€â”€ controller    # REST API Controllers
â”œâ”€â”€ service       # Business Logic Services
â”œâ”€â”€ repository    # JPA Data Access Repositories
â”œâ”€â”€ mapper        # MyBatis Mapper Interfaces
â”œâ”€â”€ entity        # JPA Entities
â”œâ”€â”€ dto           # Data Transfer Objects
â”‚   â”œâ”€â”€ request   # API Request DTOs
â”‚   â””â”€â”€ response  # API Response DTOs
â”œâ”€â”€ config        # Configuration Classes
â”œâ”€â”€ exception     # Custom Exceptions
â”œâ”€â”€ util          # Utility Classes
â”œâ”€â”€ constant      # Constants
â””â”€â”€ enums         # Enumerations
```

**æ¯å€‹æ¨¡çµ„çš„å¥—ä»¶**:
```
com.example.stockmonitor.m06.data   # M06 è³‡æ–™ç®¡ç†æ¨¡çµ„
com.example.stockmonitor.m07.tech   # M07 æŠ€è¡“åˆ†ææ¨¡çµ„
com.example.stockmonitor.m13.signal # M13 ä¿¡è™Ÿå¼•æ“æ¨¡çµ„
```

**Resources çµæ§‹**:
```
src/main/resources
â”œâ”€â”€ mapper/                    # MyBatis XML Mapper
â”‚   â”œâ”€â”€ SignalMapper.xml
â”‚   â”œâ”€â”€ IndicatorMapper.xml
â”‚   â””â”€â”€ ScreenerMapper.xml
â”œâ”€â”€ application.yml
â””â”€â”€ application-prod.yml
```

#### 8.1.3 è¨»è§£è¦ç¯„

**JavaDoc è¨»è§£**:
- æ‰€æœ‰ public é¡åˆ¥èˆ‡æ–¹æ³•å¿…é ˆæœ‰ JavaDoc
- èªªæ˜æ–¹æ³•ç”¨é€”ã€åƒæ•¸ã€å›å‚³å€¼ã€å¯èƒ½çš„ç•°å¸¸

**ç¯„ä¾‹**:
```java
/**
 * è¨ˆç®—è‚¡ç¥¨çš„æŠ€è¡“æŒ‡æ¨™
 *
 * @param stockId è‚¡ç¥¨ä»£ç¢¼
 * @param startDate é–‹å§‹æ—¥æœŸ
 * @param endDate çµæŸæ—¥æœŸ
 * @return æŠ€è¡“æŒ‡æ¨™åˆ—è¡¨
 * @throws StockNotFoundException ç•¶è‚¡ç¥¨ä¸å­˜åœ¨æ™‚
 */
public List<TechnicalIndicator> calculateIndicators(
    String stockId, LocalDate startDate, LocalDate endDate) {
    // ...
}
```

**ç¨‹å¼ç¢¼è¨»è§£**:
- è§£é‡‹è¤‡é›œé‚è¼¯
- èªªæ˜ç‚ºä»€éº¼é€™æ¨£åšï¼ˆWhyï¼‰ï¼Œè€Œéåšä»€éº¼ï¼ˆWhatï¼‰
- é¿å…ç„¡æ„ç¾©çš„è¨»è§£

---

### 8.2 è³‡æ–™åº«è¨­è¨ˆè¦ç¯„

#### 8.2.1 å‘½åè¦ç¯„

**è¡¨å‘½å**:
- å°å¯« + åº•ç·š
- è¤‡æ•¸å½¢å¼
- ç¯„ä¾‹: `stocks`, `stock_prices`, `technical_indicators`

**æ¬„ä½å‘½å**:
- å°å¯« + åº•ç·š
- ç¯„ä¾‹: `stock_id`, `signal_type`, `created_at`

**ä¸»éµå‘½å**:
- `{table}_id` (ä¾‹: `signal_id`, `stock_id`)

**å¤–éµå‘½å**:
- `{reference_table}_id` (ä¾‹: `stock_id` æŒ‡å‘ `stocks` è¡¨)

**ç´¢å¼•å‘½å**:
- ä¸»éµ: `pk_{table}`
- å”¯ä¸€ç´¢å¼•: `uk_{table}_{column(s)}`
- ä¸€èˆ¬ç´¢å¼•: `idx_{table}_{column(s)}`
- GIN ç´¢å¼•: `gin_{table}_{column}`

#### 8.2.2 PostgreSQL è³‡æ–™é¡å‹è¦ç¯„

| è³‡æ–™é¡å‹ | PostgreSQL é¡å‹ | èªªæ˜ |
|---------|----------------|------|
| ä¸»éµï¼ˆè‡ªå¢ï¼‰ | BIGSERIAL / SERIAL | è‡ªå‹•éå¢ä¸»éµ |
| è‚¡ç¥¨ä»£ç¢¼ | VARCHAR(10) | å°è‚¡æœ€å¤š 6 ç¢¼ |
| é‡‘é¡/åƒ¹æ ¼ | NUMERIC(15,2) | ç²¾ç¢ºåˆ°å°æ•¸é»å¾Œ 2 ä½ |
| æ¯”ç‡/ç™¾åˆ†æ¯” | NUMERIC(5,2) | ç²¾ç¢ºåˆ°å°æ•¸é»å¾Œ 2 ä½ï¼Œç¯„åœ -999.99 ~ 999.99 |
| æ•¸é‡ | BIGINT | æˆäº¤é‡ã€å¼µæ•¸ |
| æ—¥æœŸ | DATE | åƒ…æ—¥æœŸ |
| æ—¥æœŸæ™‚é–“ | TIMESTAMP / TIMESTAMPTZ | å«æ™‚åˆ†ç§’ï¼ŒTIMESTAMPTZ åŒ…å«æ™‚å€ |
| çŸ­æ–‡å­— | VARCHAR(N) | N < 255 |
| é•·æ–‡å­— | TEXT | é•·æ–‡å­—å…§å®¹ |
| JSON | JSONB | çµæ§‹åŒ–è³‡æ–™ï¼ˆæ¨è–¦ä½¿ç”¨ JSONB è€Œé JSONï¼‰ |
| å¸ƒæ—å€¼ | BOOLEAN | true/false |
| é™£åˆ— | ARRAY | PostgreSQL åŸç”Ÿé™£åˆ—é¡å‹ |

#### 8.2.3 PostgreSQL ç‰¹å®šè¨­è¨ˆè¦ç¯„

**ä½¿ç”¨ BIGSERIAL ä½œç‚ºè‡ªå¢ä¸»éµ**:
```sql
CREATE TABLE stocks (
    stock_id BIGSERIAL PRIMARY KEY,
    -- å…¶ä»–æ¬„ä½...
);
```

**ä½¿ç”¨ JSONB å„²å­˜è¤‡é›œçµæ§‹åŒ–è³‡æ–™**:
```sql
CREATE TABLE signals (
    signal_id BIGSERIAL PRIMARY KEY,
    evidence_data JSONB,
    technical_factors JSONB
);
```

**ä½¿ç”¨ TIMESTAMP æˆ– TIMESTAMPTZ ä½œç‚ºæ™‚é–“æ¬„ä½**:
```sql
CREATE TABLE signals (
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**ä½¿ç”¨ CHECK ç´„æŸå–ä»£ ENUM**:
```sql
CREATE TABLE signals (
    signal_type VARCHAR(10) NOT NULL 
        CHECK (signal_type IN ('BUY', 'SELL', 'HOLD')),
    signal_status VARCHAR(20) DEFAULT 'ACTIVE'
        CHECK (signal_status IN ('ACTIVE', 'EXPIRED', 'TRIGGERED', 'CANCELLED'))
);
```

**ç‚º JSONB æ¬„ä½å»ºç«‹ GIN ç´¢å¼•**:
```sql
-- åŠ é€Ÿ JSONB æŸ¥è©¢
CREATE INDEX gin_signals_evidence_data ON signals USING GIN (evidence_data);
CREATE INDEX gin_signals_technical_factors ON signals USING GIN (technical_factors);
```

**ä½¿ç”¨è§¸ç™¼å™¨è‡ªå‹•æ›´æ–° updated_at**:
```sql
-- å»ºç«‹é€šç”¨çš„æ›´æ–°å‡½æ•¸
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- ç‚ºè¡¨å»ºç«‹è§¸ç™¼å™¨
CREATE TRIGGER update_signals_updated_at
    BEFORE UPDATE ON signals
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();
```

**ä½¿ç”¨ COMMENT ON æ–°å¢è¡¨å’Œæ¬„ä½è¨»é‡‹**:
```sql
COMMENT ON TABLE signals IS 'çµ±ä¸€ä¿¡è™Ÿè¡¨';
COMMENT ON COLUMN signals.signal_id IS 'ä¿¡è™ŸIDï¼ˆä¸»éµï¼‰';
COMMENT ON COLUMN signals.signal_uuid IS 'UUIDï¼Œç”¨æ–¼å»é‡';
COMMENT ON COLUMN signals.evidence_data IS 'ä¿¡è™Ÿè­‰æ“šè³‡æ–™ï¼ˆJSONBæ ¼å¼ï¼Œæ”¯æ´é«˜æ•ˆæŸ¥è©¢ï¼‰';
```

**å®Œæ•´ç¯„ä¾‹**:
```sql
CREATE TABLE technical_indicators (
    indicator_id    BIGSERIAL PRIMARY KEY,
    stock_id        VARCHAR(10) NOT NULL,
    trade_date      DATE NOT NULL,
    indicator_name  VARCHAR(50) NOT NULL,
    indicator_value NUMERIC(15,4),
    metadata        JSONB,
    created_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    CONSTRAINT fk_stock FOREIGN KEY (stock_id) REFERENCES stocks(stock_id)
);

-- å»ºç«‹ç´¢å¼•
CREATE UNIQUE INDEX uk_technical_indicators_stock_date_name 
    ON technical_indicators(stock_id, trade_date, indicator_name);
CREATE INDEX idx_technical_indicators_stock ON technical_indicators(stock_id);
CREATE INDEX idx_technical_indicators_date ON technical_indicators(trade_date);
CREATE INDEX gin_technical_indicators_metadata ON technical_indicators USING GIN (metadata);

-- å»ºç«‹è§¸ç™¼å™¨
CREATE TRIGGER update_technical_indicators_updated_at
    BEFORE UPDATE ON technical_indicators
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();

-- æ–°å¢è¨»é‡‹
COMMENT ON TABLE technical_indicators IS 'æŠ€è¡“æŒ‡æ¨™è¡¨';
```

#### 8.2.4 å¿…è¦æ¬„ä½

**æ‰€æœ‰è¡¨å¿…é ˆåŒ…å«**:
- `created_at`: TIMESTAMP DEFAULT CURRENT_TIMESTAMP
- `updated_at`: TIMESTAMP DEFAULT CURRENT_TIMESTAMP

**ä½¿ç”¨è€…ç›¸é—œè¡¨å»ºè­°åŒ…å«**:
- `created_by`: VARCHAR(50) - å‰µå»ºè€…
- `updated_by`: VARCHAR(50) - æ›´æ–°è€…

#### 8.2.5 ç´¢å¼•è¨­è¨ˆåŸå‰‡

**ä½•æ™‚å»ºç«‹ç´¢å¼•**:
- ä¸»éµï¼ˆè‡ªå‹•å»ºç«‹ï¼‰
- å¤–éµ
- ç¶“å¸¸ç”¨æ–¼ WHERE æ¢ä»¶çš„æ¬„ä½
- ç¶“å¸¸ç”¨æ–¼ ORDER BY çš„æ¬„ä½
- ç¶“å¸¸ç”¨æ–¼ JOIN çš„æ¬„ä½
- JSONB æ¬„ä½ï¼ˆä½¿ç”¨ GIN ç´¢å¼•ï¼‰

**è¤‡åˆç´¢å¼•è¦å‰‡**:
- æœ€å¸¸ç”¨æ–¼æŸ¥è©¢çš„æ¬„ä½æ”¾åœ¨å‰é¢
- é¸æ“‡æ€§é«˜çš„æ¬„ä½æ”¾åœ¨å‰é¢
- ç¯„ä¾‹: `INDEX (stock_id, trade_date)` å„ªæ–¼ `INDEX (trade_date, stock_id)`

**éƒ¨åˆ†ç´¢å¼•ï¼ˆPartial Indexï¼‰**:
```sql
-- åªç´¢å¼• ACTIVE ç‹€æ…‹çš„ä¿¡è™Ÿ
CREATE INDEX idx_signals_active_only ON signals(stock_id, signal_date)
WHERE signal_status = 'ACTIVE';
```

**é¿å…éåº¦ç´¢å¼•**:
- æ¯å€‹è¡¨çš„ç´¢å¼•æ•¸é‡ < 5-7 å€‹ï¼ˆç‰¹æ®Šæƒ…æ³ä¾‹å¤–ï¼‰
- å¯«å…¥é »ç¹çš„è¡¨è¬¹æ…å»ºç«‹ç´¢å¼•

---

### 8.3 æŒä¹…å±¤ä½¿ç”¨æº–å‰‡

#### 8.3.1 JPA ä½¿ç”¨æº–å‰‡

**æ¨è–¦ä½¿ç”¨å ´æ™¯**:
```java
// âœ… æ¨è–¦ï¼šç°¡å–®æŸ¥è©¢
stockRepository.findById(stockId);
stockRepository.findByMarket("TWSE");

// âœ… æ¨è–¦ï¼šç°¡å–®æ¢ä»¶çµ„åˆ
List<Stock> findByIsActiveTrueAndMarket(String market);

// âœ… æ¨è–¦ï¼šåŸºç¤åˆ†é 
Page<Stock> findAll(Pageable pageable);

// âŒ ä¸æ¨è–¦ï¼šè¤‡é›œå‹•æ…‹æŸ¥è©¢ç”¨ JPA
// æ‡‰æ”¹ç”¨ MyBatis
```

**Entity è¨­è¨ˆ**:
```java
@Entity
@Table(name = "signals")
@TypeDef(name = "jsonb", typeClass = JsonBinaryType.class)
public class Signal {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long signalId;
    
    // JSONB æ¬„ä½æ˜ å°„
    @Type(JsonBinaryType.class)
    @Column(name = "evidence_data", columnDefinition = "jsonb")
    private Map<String, Object> evidenceData;
}
```

**é¿å… N+1 æŸ¥è©¢**:
```java
// âœ… ä½¿ç”¨ @EntityGraph
@EntityGraph(attributePaths = {"stock", "indicators"})
List<Signal> findByStockId(String stockId);

// âœ… ä½¿ç”¨ JOIN FETCH
@Query("SELECT s FROM Signal s JOIN FETCH s.stock WHERE s.stockId = :stockId")
List<Signal> findWithStock(@Param("stockId") String stockId);
```

#### 8.3.2 MyBatis ä½¿ç”¨æº–å‰‡

**æ¨è–¦ä½¿ç”¨å ´æ™¯**:
```java
// âœ… æ¨è–¦ï¼šè¤‡é›œå¤šè¡¨ JOIN
signalMapper.searchSignals(criteria);

// âœ… æ¨è–¦ï¼šå‹•æ…‹ SQL
indicatorMapper.calculateWithDynamicConditions(params);

// âœ… æ¨è–¦ï¼šæ‰¹æ¬¡æ“ä½œ
signalMapper.batchInsertSignals(signals);

// âœ… æ¨è–¦ï¼šPostgreSQL ç‰¹å®šåŠŸèƒ½
signalMapper.findByJsonbField(indicator, minValue);

// âŒ ä¸æ¨è–¦ï¼šç°¡å–® CRUD ç”¨ MyBatis
// æ‡‰æ”¹ç”¨ JPA Repository
```

**XML Mapper ç¯„ä¾‹**:
```xml
<!-- è¤‡é›œå‹•æ…‹æŸ¥è©¢ -->
<select id="searchSignals" resultType="SignalDTO">
    SELECT * FROM signals
    <where>
        <if test="criteria.stockIds != null">
            AND stock_id IN
            <foreach collection="criteria.stockIds" item="stockId" 
                     open="(" separator="," close=")">
                #{stockId}
            </foreach>
        </if>
        <if test="criteria.indicator != null">
            AND evidence_data ->> 'indicator' = #{criteria.indicator}
        </if>
        <if test="criteria.minValue != null">
            AND (evidence_data ->> 'value')::numeric >= #{criteria.minValue}
        </if>
    </where>
    ORDER BY signal_time DESC
</select>

<!-- PostgreSQL æ‰¹æ¬¡æ’å…¥ -->
<insert id="batchInsertSignals">
    INSERT INTO signals (signal_uuid, stock_id, signal_type, evidence_data)
    VALUES
    <foreach collection="signals" item="signal" separator=",">
        (#{signal.signalUuid}, #{signal.stockId}, #{signal.signalType},
         #{signal.evidenceData, typeHandler=org.apache.ibatis.type.JsonTypeHandler}::jsonb)
    </foreach>
    ON CONFLICT (signal_uuid) DO UPDATE SET
        updated_at = CURRENT_TIMESTAMP
</insert>
```

#### 8.3.3 äº‹å‹™ç®¡ç†

**JPA å’Œ MyBatis å…±ç”¨åŒä¸€å€‹äº‹å‹™ç®¡ç†å™¨**:
```java
@Service
@Transactional
public class MixedService {
    
    @Autowired
    private StockRepository stockRepository;  // JPA
    
    @Autowired
    private SignalMapper signalMapper;  // MyBatis
    
    public void mixedOperation() {
        // JPA æ“ä½œ
        Stock stock = stockRepository.findById(stockId).orElseThrow();
        stock.setUpdatedAt(LocalDateTime.now());
        stockRepository.save(stock);
        
        // MyBatis æ“ä½œï¼ˆåŒä¸€äº‹å‹™ï¼‰
        signalMapper.updateRelatedData(stockId);
        
        // è‹¥ä»»ä¸€æ“ä½œå¤±æ•—ï¼Œæ•´é«”å›æ»¾
    }
}
```

#### 8.3.4 æ‰¹æ¬¡æ“ä½œå°æ¯”

```java
// JPA æ‰¹æ¬¡ï¼ˆæ•ˆç‡è¼ƒä½ï¼‰
@Transactional
public void batchInsertWithJPA(List<Signal> signals) {
    signalRepository.saveAll(signals);
    // æ¯ 20 ç­†åŸ·è¡Œä¸€æ¬¡ flushï¼ˆéœ€é…ç½® hibernate.jdbc.batch_sizeï¼‰
}

// MyBatis æ‰¹æ¬¡ï¼ˆæ•ˆç‡æ›´é«˜ï¼Œæ¨è–¦ï¼‰
@Transactional
public void batchInsertWithMyBatis(List<Signal> signals) {
    signalMapper.batchInsertSignals(signals);
    // å–®ä¸€ SQL æ‰¹æ¬¡æ’å…¥
}
```

#### 8.3.5 é¸æ“‡æ±ºç­–è¡¨

| å ´æ™¯ | ä½¿ç”¨ JPA | ä½¿ç”¨ MyBatis | ç†ç”± |
|-----|---------|-------------|------|
| å–®è¡¨ CRUD | âœ… | âŒ | JPA æ›´ç°¡æ½” |
| ç°¡å–®æ¢ä»¶æŸ¥è©¢ | âœ… | âŒ | æ–¹æ³•å‘½åå³å¯ |
| è¤‡é›œ JOIN | âŒ | âœ… | MyBatis SQL æ›´ç›´è§€ |
| å‹•æ…‹æ¢ä»¶æŸ¥è©¢ | âŒ | âœ… | MyBatis å‹•æ…‹ SQL æ›´éˆæ´» |
| æ‰¹æ¬¡æ’å…¥/æ›´æ–° | âŒ | âœ… | MyBatis æ•ˆèƒ½æ›´å¥½ |
| JSONB è¤‡é›œæŸ¥è©¢ | âŒ | âœ… | MyBatis æ”¯æ´åŸç”Ÿ SQL |
| åˆ†é æŸ¥è©¢ | âœ… | âœ… | å…©è€…çš†å¯ |
| çµ±è¨ˆèšåˆ | âŒ | âœ… | MyBatis æ›´é©åˆ |

---

### 8.4 Git è¦ç¯„

#### 8.4.1 åˆ†æ”¯ç­–ç•¥

**ä¸»è¦åˆ†æ”¯**:
- `main`: ç”Ÿç”¢ç’°å¢ƒåˆ†æ”¯ï¼Œæ°¸é ä¿æŒç©©å®š
- `develop`: é–‹ç™¼ä¸»åˆ†æ”¯ï¼Œæ•´åˆæ‰€æœ‰åŠŸèƒ½

**è‡¨æ™‚åˆ†æ”¯**:
- `feature/<feature-name>`: åŠŸèƒ½é–‹ç™¼
- `bugfix/<bug-description>`: Bug ä¿®å¾©
- `hotfix/<issue-description>`: ç·Šæ€¥ä¿®å¾©
- `release/<version>`: ç™¼å¸ƒæº–å‚™

**åˆ†æ”¯å‘½åç¯„ä¾‹**:
```
feature/m07-macd-indicator
feature/m13-signal-deduplication
bugfix/fix-price-validation
hotfix/critical-db-connection-issue
release/v1.0.0
```

#### 8.4.2 Commit Message è¦ç¯„

**æ ¼å¼**:
```
<type>(<scope>): <subject>

<body>

<footer>
```

**Type é¡å‹**:
- `feat`: æ–°åŠŸèƒ½
- `fix`: Bug ä¿®å¾©
- `docs`: æ–‡ä»¶ä¿®æ”¹
- `style`: ç¨‹å¼ç¢¼æ ¼å¼ï¼ˆä¸å½±éŸ¿åŠŸèƒ½ï¼‰
- `refactor`: é‡æ§‹
- `test`: æ¸¬è©¦ç›¸é—œ
- `chore`: å»ºç½®å·¥å…·ã€ä¾è³´æ›´æ–°ã€é…ç½®ä¿®æ”¹

**Scope**: æ¨¡çµ„åç¨±ï¼ˆM06, M07, M13 ç­‰ï¼‰

**Subject**: ç°¡çŸ­æè¿°ï¼ˆä¸è¶…é 50 å­—å…ƒï¼‰

**ç¯„ä¾‹**:
```
feat(M07): æ–°å¢ MACD æŒ‡æ¨™è¨ˆç®—åŠŸèƒ½

å¯¦ä½œ MACD æŒ‡æ¨™è¨ˆç®—é‚è¼¯ï¼ŒåŒ…å«ï¼š
- MACD ç·šè¨ˆç®—
- Signal ç·šè¨ˆç®—
- æŸ±ç‹€åœ–è¨ˆç®—

Issue #123
```

```
fix(M13): ä¿®æ­£ä¿¡è™Ÿå»é‡é‚è¼¯éŒ¯èª¤

ä¿®æ­£ signal_uuid ç”Ÿæˆæ™‚æœªåŒ…å« signal_name çš„å•é¡Œï¼Œ
å°è‡´ä¸åŒä¿¡è™Ÿè¢«èª¤åˆ¤ç‚ºé‡è¤‡

Issue #456
```

#### 8.4.3 Pull Request è¦ç¯„

**PR æ¨™é¡Œ**: èˆ‡ Commit Message æ ¼å¼ç›¸åŒ

**PR æè¿°**:
```markdown
## è®Šæ›´èªªæ˜
ç°¡çŸ­æè¿°é€™å€‹ PR åšäº†ä»€éº¼

## è®Šæ›´å…§å®¹
- æ–°å¢ XXX åŠŸèƒ½
- ä¿®æ”¹ YYY é‚è¼¯
- åˆªé™¤ ZZZ å†—é¤˜ç¨‹å¼ç¢¼

## æ¸¬è©¦
- [ ] å–®å…ƒæ¸¬è©¦é€šé
- [ ] æ•´åˆæ¸¬è©¦é€šé
- [ ] æ‰‹å‹•æ¸¬è©¦é€šé

## ç›¸é—œ Issue
Closes #123
```

**Code Review è¦é»**:
- ç¨‹å¼ç¢¼é‚è¼¯æ­£ç¢ºæ€§
- ç¬¦åˆç¨‹å¼ç¢¼è¦ç¯„
- æ¸¬è©¦è¦†è“‹å……è¶³
- æ•ˆèƒ½è€ƒé‡
- å®‰å…¨æ€§æª¢æŸ¥

---

### 8.5 æ¸¬è©¦è¦ç¯„

#### 8.5.1 æ¸¬è©¦å‘½åè¦ç¯„

**æ¸¬è©¦é¡åˆ¥å‘½å**:
```
{ClassName}Test  (ä¾‹: StockServiceTest)
```

**æ¸¬è©¦æ–¹æ³•å‘½å**:
```
test{MethodName}_{Scenario}_should{ExpectedResult}

ç¯„ä¾‹:
testGetStockById_WithValidId_shouldReturnStock()
testGetStockById_WithInvalidId_shouldThrowNotFoundException()
testCalculateMACD_WithInsufficientData_shouldThrowException()
```

#### 8.5.2 æ¸¬è©¦çµæ§‹

**Given-When-Then æ¨¡å¼**:
```java
@Test
void testCalculateMACD_WithValidData_shouldReturnCorrectValue() {
    // Given: æº–å‚™æ¸¬è©¦è³‡æ–™
    String stockId = "2330";
    List<StockPrice> prices = prepareTestData();
    
    // When: åŸ·è¡Œæ¸¬è©¦æ–¹æ³•
    MACD result = indicatorService.calculateMACD(stockId, prices);
    
    // Then: é©—è­‰çµæœ
    assertNotNull(result);
    assertEquals(1.25, result.getMacdValue(), 0.01);
}
```

#### 8.5.3 Mock ä½¿ç”¨åŸå‰‡

**éœ€è¦ Mock çš„å ´æ™¯**:
- å¤–éƒ¨ API å‘¼å«
- è³‡æ–™åº«æ“ä½œï¼ˆå–®å…ƒæ¸¬è©¦ï¼‰
- è¤‡é›œä¾è³´

**Mock ç¯„ä¾‹**:
```java
@Mock
private StockRepository stockRepository;

@Mock
private SignalMapper signalMapper;

@InjectMocks
private StockService stockService;

@Test
void testGetStock() {
    // Given
    Stock mockStock = new Stock("2330", "å°ç©é›»");
    when(stockRepository.findById("2330")).thenReturn(Optional.of(mockStock));
    
    // When
    Stock result = stockService.getStock("2330");
    
    // Then
    assertEquals("2330", result.getStockId());
    verify(stockRepository, times(1)).findById("2330");
}
```

---

### 8.6 API è¨­è¨ˆè¦ç¯„

å·²åœ¨ 4.4 ç¯€è©³è¿°ã€‚

---

### 8.7 ç‰ˆæœ¬æ§åˆ¶è¦ç¯„

**ç‰ˆæœ¬è™Ÿæ ¼å¼**: `MAJOR.MINOR.PATCH`

ç¯„ä¾‹:
- v1.0.0: é¦–æ¬¡æ­£å¼ç™¼å¸ƒ
- v1.1.0: æ–°å¢æŠ€è¡“å‹æ…‹è¾¨è­˜æ¨¡çµ„
- v1.1.1: ä¿®å¾© MACD è¨ˆç®—éŒ¯èª¤
- v2.0.0: é‡å¤§æ¶æ§‹èª¿æ•´ï¼ˆPostgreSQL + JPA + MyBatisï¼‰

---


## 9. é™„éŒ„

### 9.1 åƒè€ƒè³‡æº

**å®˜æ–¹æ–‡æª”**:
- Spring Boot: https://spring.io/projects/spring-boot
- Spring Data JPA: https://spring.io/projects/spring-data-jpa
- Spring Security: https://spring.io/projects/spring-security
- Redis: https://redis.io/documentation
- MySQL: https://dev.mysql.com/doc/

**ç¬¬ä¸‰æ–¹å·¥å…·**:
- Swagger UI: https://swagger.io/tools/swagger-ui/
- Docker: https://docs.docker.com/
- Maven: https://maven.apache.org/guides/

### 9.2 å¸¸è¦‹å•é¡Œ (FAQ)

**Q1: ç‚ºä»€éº¼ä½¿ç”¨ Signal Contract çµ±ä¸€ä¿¡è™Ÿæ ¼å¼ï¼Ÿ**
A: ç¢ºä¿ä¸åŒæ¨¡çµ„ç”¢ç”Ÿçš„ä¿¡è™Ÿæ ¼å¼ä¸€è‡´ï¼Œæ–¹ä¾¿å»é‡ã€åˆä½µã€è©•åˆ†ï¼Œä¹Ÿä¾¿æ–¼æœªä¾†æ“´å……æ–°çš„ä¿¡è™Ÿä¾†æºã€‚

**Q2: ç‚ºä»€éº¼éœ€è¦ Job åŸ·è¡Œè¨˜éŒ„ï¼Ÿ**
A: è¿½è¹¤æ¯æ¬¡æ‰¹æ¬¡ä»»å‹™çš„åŸ·è¡Œç‹€æ…‹ï¼Œæ–¹ä¾¿é™¤éŒ¯èˆ‡å•é¡Œæ’æŸ¥ï¼Œä¹Ÿæ”¯æ´å¤±æ•—é‡è·‘ã€‚

**Q3: ç‚ºä»€éº¼ä½¿ç”¨ Redisï¼Ÿ**
A: åŠ é€Ÿç†±è³‡æ–™æŸ¥è©¢ï¼ˆå¦‚è‚¡åƒ¹ã€æŒ‡æ¨™ï¼‰ï¼Œé™ä½è³‡æ–™åº«è² è¼‰ï¼Œæå‡ç³»çµ±æ•ˆèƒ½ã€‚

**Q4: å¦‚ä½•ç¢ºä¿è³‡æ–™ä¸€è‡´æ€§ï¼Ÿ**
A: ä½¿ç”¨è³‡æ–™åº«äº¤æ˜“ã€å”¯ä¸€éµç´„æŸã€è³‡æ–™å“è³ªæª¢æ ¸æ©Ÿåˆ¶ã€‚

**Q5: å¤šäººå”ä½œæ™‚å¦‚ä½•é¿å…è¡çªï¼Ÿ**
A: éµå®ˆ Git åˆ†æ”¯ç­–ç•¥ã€Commit è¦ç¯„ï¼Œå®šæœŸ merge develop åˆ†æ”¯ï¼Œåšå¥½ Code Reviewã€‚

**Q6: ç‚ºä»€éº¼ä¸ä½¿ç”¨å¾®æœå‹™æ¶æ§‹ï¼Ÿ**
A: åˆæœŸç³»çµ±è¦æ¨¡ä¸å¤§ï¼Œå–®é«”æ‡‰ç”¨æ›´ç°¡å–®ã€æ˜“ç¶­è­·ã€‚æœªä¾†è‹¥ç³»çµ±æ“´å¤§å¯é‡æ§‹ç‚ºå¾®æœå‹™ã€‚

**Q7: å¦‚ä½•è™•ç†å¤–éƒ¨ API é™åˆ¶ï¼Ÿ**
A: ä½¿ç”¨å¤šè³‡æ–™ä¾†æºå‚™æ´ã€å¿«å–æ¸›å°‘è«‹æ±‚ã€æ§åˆ¶è«‹æ±‚é »ç‡ã€ä»˜è²» API ä½œç‚ºå‚™æ´ã€‚

**Q8: æ¸¬è©¦ç’°å¢ƒå¦‚ä½•æ¨¡æ“¬å¤–éƒ¨ APIï¼Ÿ**
A: ä½¿ç”¨ WireMock æˆ–å…¶ä»– Mock Server æ¨¡æ“¬å¤–éƒ¨ API å›æ‡‰ã€‚

### 9.3 å°ˆæœ‰åè©ç´¢å¼•

- **Signal Contract**: çµ±ä¸€ä¿¡è™Ÿè³‡æ–™æ¨¡å‹ï¼Œè¦‹ 4.2 ç¯€
- **Job**: å¯è¿½è¹¤çš„æ‰¹æ¬¡ä½œæ¥­å–®ä½ï¼Œè¦‹ 4.4 ç¯€
- **RBAC**: åŸºæ–¼è§’è‰²çš„å­˜å–æ§åˆ¶ï¼Œè¦‹ 4.5 ç¯€
- **Data Quality**: è³‡æ–™å“è³ªï¼Œè¦‹ 4.6 ç¯€
- **Idempotency**: å†ªç­‰æ€§ï¼Œè¦‹ 4.4.6 ç¯€
- **NFR**: éåŠŸèƒ½æ€§éœ€æ±‚ï¼Œè¦‹ç¬¬ 7 ç« 
- **DTO**: Data Transfer Objectï¼Œè¦‹ 5.2.6 ç¯€
- **Repository**: è³‡æ–™å­˜å–å±¤ï¼Œè¦‹ 5.2.4 ç¯€

### 9.4 ç¸®å¯«å°ç…§è¡¨

| ç¸®å¯« | å…¨å |
|-----|------|
| SA | System Analysisï¼ˆç³»çµ±åˆ†æï¼‰ |
| SD | System Designï¼ˆç³»çµ±è¨­è¨ˆï¼‰ |
| API | Application Programming Interface |
| REST | Representational State Transfer |
| JWT | JSON Web Token |
| RBAC | Role-Based Access Control |
| CRUD | Create, Read, Update, Delete |
| ORM | Object-Relational Mapping |
| JPA | Java Persistence API |
| DTO | Data Transfer Object |
| NFR | Non-Functional Requirements |
| RTO | Recovery Time Objective |
| RPO | Recovery Point Objective |
| SLA | Service Level Agreement |
| TTL | Time To Live |

---

### 9.5 å®Œæ•´é…ç½®æª”ç¯„ä¾‹

#### 9.5.1 application.ymlï¼ˆå®Œæ•´ç‰ˆï¼‰

```yaml
server:
  port: 8080
  servlet:
    context-path: /

spring:
  application:
    name: stock-monitor-system

  # PostgreSQL è³‡æ–™æºé…ç½®
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:stock_monitor}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:password}
    driver-class-name: org.postgresql.Driver
    
    # HikariCP é€£ç·šæ± é…ç½®
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
      pool-name: StockMonitorHikariPool

  # JPA é…ç½®
  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: validate  # ç”Ÿç”¢ç’°å¢ƒä½¿ç”¨ validate
      naming:
        physical-strategy: org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
    show-sql: false
    properties:
      hibernate:
        format_sql: true
        jdbc:
          batch_size: 20
          fetch_size: 50
        order_inserts: true
        order_updates: true
        generate_statistics: false
        # PostgreSQL ç‰¹å®šé…ç½®
        dialect.storage_engine: innodb

  # Redis é…ç½®
  redis:
    host: ${REDIS_HOST:localhost}
    port: ${REDIS_PORT:6379}
    password: ${REDIS_PASSWORD:}
    database: 0
    timeout: 5000ms
    lettuce:
      pool:
        max-active: 20
        max-idle: 10
        min-idle: 5
        max-wait: -1ms

# MyBatis é…ç½®
mybatis:
  mapper-locations: classpath:mapper/**/*.xml
  type-aliases-package: com.stockmonitor.entity
  configuration:
    map-underscore-to-camel-case: true
    cache-enabled: true
    lazy-loading-enabled: false
    aggressive-lazy-loading: false
    default-executor-type: REUSE
    default-statement-timeout: 25000
    log-impl: org.apache.ibatis.logging.slf4j.Slf4jImpl
  type-handlers-package: com.stockmonitor.typehandler

# æ—¥èªŒé…ç½®
logging:
  level:
    root: INFO
    com.stockmonitor: DEBUG
    com.stockmonitor.mapper: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
    org.springframework.jdbc.core: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/stock-monitor.log
    max-size: 10MB
    max-history: 30

# Actuator ç›£æ§é…ç½®
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always

# æ‡‰ç”¨é…ç½®
app:
  scheduler:
    enabled: true
    thread-pool-size: 10
  cache:
    default-ttl: 3600
  external-api:
    timeout: 10000
    retry-count: 3
```

#### 9.5.2 pom.xmlï¼ˆå®Œæ•´ç‰ˆï¼‰

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
         http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.2.0</version>
        <relativePath/>
    </parent>

    <groupId>com.stockmonitor</groupId>
    <artifactId>stock-monitor-system</artifactId>
    <version>1.0.0-SNAPSHOT</version>
    <name>Stock Monitor System</name>
    <description>è‚¡ç¥¨é€²å‡ºå ´ç›£æ§ç³»çµ±</description>

    <properties>
        <java.version>17</java.version>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <postgresql.version>42.7.1</postgresql.version>
        <mybatis-spring-boot.version>3.0.3</mybatis-spring-boot.version>
        <hypersistence-utils.version>3.7.0</hypersistence-utils.version>
        <springdoc-openapi.version>2.3.0</springdoc-openapi.version>
    </properties>

    <dependencies>
        <!-- Spring Boot Starters -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <!-- Spring Data JPA -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>

        <!-- MyBatis Spring Boot Starter -->
        <dependency>
            <groupId>org.mybatis.spring.boot</groupId>
            <artifactId>mybatis-spring-boot-starter</artifactId>
            <version>${mybatis-spring-boot.version}</version>
        </dependency>

        <!-- PostgreSQL Driver -->
        <dependency>
            <groupId>org.postgresql</groupId>
            <artifactId>postgresql</artifactId>
            <version>${postgresql.version}</version>
        </dependency>

        <!-- Hibernate Types for PostgreSQL JSONB -->
        <dependency>
            <groupId>io.hypersistence</groupId>
            <artifactId>hypersistence-utils-hibernate-63</artifactId>
            <version>${hypersistence-utils.version}</version>
        </dependency>

        <!-- Redis -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-redis</artifactId>
        </dependency>

        <!-- Spring Security -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-security</artifactId>
        </dependency>

        <!-- Validation -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-validation</artifactId>
        </dependency>

        <!-- WebSocket -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-websocket</artifactId>
        </dependency>

        <!-- Spring Actuator -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>

        <!-- SpringDoc OpenAPI (Swagger) -->
        <dependency>
            <groupId>org.springdoc</groupId>
            <artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
            <version>${springdoc-openapi.version}</version>
        </dependency>

        <!-- Lombok -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>

        <!-- WebClient -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-webflux</artifactId>
        </dependency>

        <!-- JWT -->
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-api</artifactId>
            <version>0.12.3</version>
        </dependency>
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-impl</artifactId>
            <version>0.12.3</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-jackson</artifactId>
            <version>0.12.3</version>
            <scope>runtime</scope>
        </dependency>

        <!-- Testing -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-test</artifactId>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.mybatis.spring.boot</groupId>
            <artifactId>mybatis-spring-boot-starter-test</artifactId>
            <version>${mybatis-spring-boot.version}</version>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <excludes>
                        <exclude>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </exclude>
                    </excludes>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>
```

#### 9.5.3 Docker Composeï¼ˆé–‹ç™¼ç’°å¢ƒï¼‰

```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15-alpine
    container_name: stock-monitor-postgres
    environment:
      POSTGRES_DB: stock_monitor
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
      PGDATA: /var/lib/postgresql/data/pgdata
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - stock-monitor-network

  redis:
    image: redis:7-alpine
    container_name: stock-monitor-redis
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    networks:
      - stock-monitor-network
    command: redis-server --appendonly yes

volumes:
  postgres_data:
  redis_data:

networks:
  stock-monitor-network:
    driver: bridge
```

## 10. ç¸½ç¶±ä½¿ç”¨æŒ‡å¼•

### 10.1 å¦‚ä½•ä½¿ç”¨æœ¬æ–‡ä»¶

**é–‹ç™¼å‰**:
1. é–±è®€ã€Œå°ˆæ¡ˆæ¦‚è¿°ã€èˆ‡ã€Œåè©å®šç¾©ã€ï¼Œç†è§£ç³»çµ±å…¨è²Œ
2. ç†Ÿæ‚‰ã€Œå…¨ç³»çµ±å¥‘ç´„ã€ï¼ˆç¬¬ 4 ç« ï¼‰ï¼Œé€™æ˜¯æ‰€æœ‰æ¨¡çµ„çš„å…±åŒè¦ç¯„
3. æŸ¥é–±ã€ŒæŠ€è¡“æ¶æ§‹ã€èˆ‡ã€Œæ¨¡çµ„ä¾è³´é—œä¿‚ã€ï¼Œäº†è§£æ•´é«”è¨­è¨ˆ

**é–‹ç™¼ä¸­**:
1. é–‹ç™¼å‰å…ˆæŸ¥é–±å°æ‡‰çš„æ¨¡çµ„æ–‡ä»¶ (DOC-XX-MXX)
2. éµå®ˆã€ŒAPI çµ±ä¸€è¦ç¯„ã€èˆ‡ã€ŒSignal Contractã€
3. åƒè€ƒã€Œé–‹ç™¼æº–å‰‡ã€æ’°å¯«ç¨‹å¼ç¢¼
4. ä½¿ç”¨ã€ŒJob æ¨¡å‹ã€å¯¦ä½œå®šæ™‚ä»»å‹™
5. éµå®ˆã€Œè³‡æ–™å“è³ªè¦ç¯„ã€ç¢ºä¿è³‡æ–™æ­£ç¢ºæ€§

**å•é¡Œæ’æŸ¥**:
1. æŸ¥é–±ã€ŒJob åŸ·è¡Œè¨˜éŒ„è¡¨ã€è¿½è¹¤æ‰¹æ¬¡ä»»å‹™ç‹€æ…‹
2. ä½¿ç”¨ `trace_id` è¿½è¹¤ API è«‹æ±‚
3. æª¢æŸ¥ã€Œè³‡æ–™å“è³ªå•é¡Œè¨˜éŒ„è¡¨ã€ç¢ºèªè³‡æ–™æ­£ç¢ºæ€§
4. æŸ¥çœ‹ã€Œå¯è§€æ¸¬æ€§ã€ç« ç¯€äº†è§£ç›£æ§èˆ‡æ—¥èªŒ

**Code Review**:
1. æª¢æŸ¥æ˜¯å¦éµå®ˆã€Œç¨‹å¼ç¢¼è¦ç¯„ã€
2. æª¢æŸ¥æ˜¯å¦ç¬¦åˆã€Œå…¨ç³»çµ±å¥‘ç´„ã€
3. æª¢æŸ¥æ¸¬è©¦è¦†è“‹ç‡æ˜¯å¦é”æ¨™
4. æª¢æŸ¥æ˜¯å¦æœ‰é©ç•¶çš„éŒ¯èª¤è™•ç†

### 10.2 å„æ¨¡çµ„æ–‡ä»¶é—œè¯

```
00-ç¸½ç¶±.md (æœ¬æ–‡ä»¶)
    â”œâ”€â”€ å®šç¾©å…¨ç³»çµ±å¥‘ç´„
    â”œâ”€â”€ è¦ç¯„é–‹ç™¼æº–å‰‡
    â””â”€â”€ èªªæ˜æŠ€è¡“æ¶æ§‹
        â†“
01~13-æ¨¡çµ„æ–‡ä»¶.md
    â”œâ”€â”€ éµå®ˆç¸½ç¶±å¥‘ç´„
    â”œâ”€â”€ å®šç¾©æ¨¡çµ„å°ˆå±¬è¦ç¯„
    â”œâ”€â”€ èªªæ˜æ¨¡çµ„å¯¦ä½œç´°ç¯€
    â””â”€â”€ å®šç¾©æ¨¡çµ„çš„è³‡æ–™è¡¨
        â†“
99-è³‡æ–™åº«è¨­è¨ˆç¸½è¡¨.md
    â””â”€â”€ å½™æ•´æ‰€æœ‰æ¨¡çµ„çš„è³‡æ–™è¡¨è¨­è¨ˆ
```

### 10.3 æ–‡ä»¶ç¶­è­·

**æ›´æ–°é »ç‡**:
- ç¸½ç¶±: æ¶æ§‹æˆ–æ ¸å¿ƒå¥‘ç´„è®Šæ›´æ™‚æ›´æ–°ï¼ˆè¼ƒå°‘ï¼‰
- æ¨¡çµ„æ–‡ä»¶: æ¨¡çµ„åŠŸèƒ½è®Šæ›´æ™‚æ›´æ–°
- ç‰ˆæœ¬ç´€éŒ„: æ¯æ¬¡æ›´æ–°éƒ½å¿…é ˆè¨˜éŒ„

**æ–‡ä»¶å¯©æ ¸**:
- é‡å¤§è®Šæ›´éœ€åœ˜éšŠè¨è«–ä¸¦é”æˆå…±è­˜
- æ›´æ–°å¾Œé€šçŸ¥æ‰€æœ‰é–‹ç™¼æˆå“¡
- ä¿æŒæ–‡ä»¶èˆ‡å¯¦ä½œåŒæ­¥

**æ–‡ä»¶ç‰ˆæœ¬ç®¡ç†**:
- æ–‡ä»¶èˆ‡ç¨‹å¼ç¢¼ä¸€èµ·é€²ç‰ˆæ§
- é‡è¦è®Šæ›´å»ºç«‹æ–°ç‰ˆæœ¬ï¼ˆå¦‚ v1.0 â†’ v1.1ï¼‰
- èˆŠç‰ˆæœ¬æ–‡ä»¶ä¿ç•™æ–¼ Git æ­·å²è¨˜éŒ„

### 10.4 åœ˜éšŠå”ä½œå»ºè­°

**å–®äººé–‹ç™¼**:
- æŒ‰ Phase é€æ­¥å®Œæˆæ¨¡çµ„
- å„ªå…ˆå¯¦ä½œ MVP æ ¸å¿ƒåŠŸèƒ½
- å®šæœŸå›é¡§ä¸¦æ›´æ–°æ–‡ä»¶

**2-3 äººåœ˜éšŠ**:
- åˆ†å·¥ï¼šå¾Œç«¯ Ã— 2ï¼ˆè³‡æ–™å±¤/åˆ†æå±¤ + ä¿¡è™Ÿå±¤/APIå±¤ï¼‰+ å‰ç«¯ Ã— 1
- å®šæœŸåŒæ­¥ï¼ˆæ¯é€±ï¼‰
- å…±åŒåˆ¶å®šä¸¦éµå®ˆè¦ç¯„

**4-5 äººåœ˜éšŠ**:
- åˆ†å·¥ï¼šå¾Œç«¯ Lead Ã— 1 + å¾Œç«¯å·¥ç¨‹å¸« Ã— 2 + å‰ç«¯ Ã— 1 + DevOps/æ¸¬è©¦ Ã— 1
- æ¯æ—¥ Stand-up Meeting
- Code Review åˆ¶åº¦
- æ–‡ä»¶å…±åŒç¶­è­·

---


## æ–‡ä»¶çµæŸ

**æ–‡ä»¶ç·¨è™Ÿ**: DOC-00-MASTER  
**ç‰ˆæœ¬**: v1.0  
**å»ºç«‹æ—¥æœŸ**: 2024-12-22  
**æœ€å¾Œæ›´æ–°**: 2024-12-22  
**æ–‡ä»¶ç‹€æ…‹**: Draft  

---

### æ–‡ä»¶çµ„æˆ

æœ¬ç¸½ç¶±ç”±ä»¥ä¸‹éƒ¨åˆ†çµ„æˆï¼š
1. **00-ç¸½ç¶±.md** - ç¬¬ 1~4 ç« ï¼ˆå°ˆæ¡ˆæ¦‚è¿°ã€åè©å®šç¾©ã€å…¨ç³»çµ±å¥‘ç´„ï¼‰
2. **00-ç¸½ç¶±-çºŒç¯‡.md** - ç¬¬ 5~10 ç« ï¼ˆæŠ€è¡“æ¶æ§‹ã€æ¨¡çµ„ä¾è³´ã€NFRã€é–‹ç™¼æº–å‰‡ï¼‰
3. **æœ¬æ–‡ä»¶** - æ–‡ä»¶çµæŸèˆ‡å¾ŒçºŒæŒ‡å¼•

---

### ä¸‹ä¸€æ­¥è¡Œå‹•

#### éšæ®µ 1: æ–‡ä»¶æº–å‚™ï¼ˆå·²å®Œæˆï¼‰
- âœ… å®Œæˆç¸½ç¶±æ’°å¯«
- âœ… å®šç¾©å…¨ç³»çµ±å¥‘ç´„
- âœ… å»ºç«‹é–‹ç™¼æº–å‰‡

#### éšæ®µ 2: æ¨¡çµ„æ–‡ä»¶æ’°å¯«ï¼ˆå¾…é€²è¡Œï¼‰

**å„ªå…ˆç´šæ’åº**:

**P0 - ç«‹å³é–‹å§‹ï¼ˆMVP æ ¸å¿ƒï¼‰**:
```
1. DOC-01-M06 - è³‡æ–™ç®¡ç†æ¨¡çµ„
   â””â”€â”€ æœ€åŸºç¤çš„æ¨¡çµ„ï¼Œæ‰€æœ‰å…¶ä»–æ¨¡çµ„éƒ½ä¾è³´å®ƒ
   
2. DOC-02-M07 - æŠ€è¡“åˆ†ææ¨¡çµ„ï¼ˆéƒ¨åˆ†ï¼‰
   â””â”€â”€ å…ˆå¯¦ä½œ 5-10 å€‹å¸¸ç”¨æŒ‡æ¨™ï¼ˆMA, EMA, MACD, RSI, KDï¼‰
   
3. DOC-08-M13 - ä¿¡è™Ÿåˆ¤æ–·å¼•æ“ï¼ˆç°¡åŒ–ç‰ˆï¼‰
   â””â”€â”€ å…ˆå¯¦ä½œåŸºæœ¬çš„ä¿¡è™Ÿç”Ÿæˆèˆ‡å„²å­˜
   
4. DOC-10-M15 - è­¦å ±é€šçŸ¥ç³»çµ±ï¼ˆåŸºç¤åŠŸèƒ½ï¼‰
   â””â”€â”€ å…ˆå¯¦ä½œ LINE Notify æˆ– Email é€šçŸ¥
```

**P1 - æ ¸å¿ƒåŠŸèƒ½ï¼ˆç¬¬äºŒéšæ®µï¼‰**:
```
5. DOC-02-M07 - æŠ€è¡“åˆ†ææ¨¡çµ„ï¼ˆå®Œæ•´ 71 å€‹æŒ‡æ¨™ï¼‰
6. DOC-03-M08 - åŸºæœ¬é¢åˆ†ææ¨¡çµ„
7. DOC-04-M09 - ç±Œç¢¼åˆ†ææ¨¡çµ„
8. DOC-09-M14 - é¸è‚¡å¼•æ“
```

**P2 - é€²éšåŠŸèƒ½ï¼ˆç¬¬ä¸‰éšæ®µï¼‰**:
```
9. DOC-05-M10 - æŠ€è¡“å‹æ…‹è¾¨è­˜æ¨¡çµ„
10. DOC-06-M11 - é‡åŒ–ç­–ç•¥æ¨¡çµ„
11. DOC-11-M16 - å›æ¸¬ç³»çµ±
12. DOC-12-M17 - é¢¨éšªç®¡ç†æ¨¡çµ„
13. DOC-13-M18 - æŠ•è³‡çµ„åˆç®¡ç†
```

**P3 - æ“´å±•åŠŸèƒ½ï¼ˆç¬¬å››éšæ®µï¼‰**:
```
14. DOC-07-M12 - ç¸½ç¶“èˆ‡ç”¢æ¥­åˆ†ææ¨¡çµ„
15. å‰ç«¯æ•´åˆ
16. æ•ˆèƒ½å„ªåŒ–èˆ‡ç›£æ§
```

#### éšæ®µ 3: å‚ç›´åˆ‡ç‰‡å¯¦ä½œï¼ˆæ¨è–¦æ–¹å¼ï¼‰

**ä»€éº¼æ˜¯å‚ç›´åˆ‡ç‰‡ï¼Ÿ**
é¸æ“‡ä¸€æ¢å®Œæ•´çš„æ¥­å‹™æµç¨‹ï¼Œå¾è³‡æ–™åº«åˆ° API åˆ°å‰ç«¯å…¨éƒ¨æ‰“é€šï¼Œå…ˆåšä¸€å€‹æœ€å°å¯é‹è¡Œç‰ˆæœ¬ã€‚

**æ¨è–¦çš„ MVP å‚ç›´åˆ‡ç‰‡**:
```
åŠŸèƒ½: æŸ¥è©¢å°ç©é›»(2330)çš„è‚¡åƒ¹èˆ‡ MA æŒ‡æ¨™ï¼Œä¸¦ç”¢ç”Ÿé»ƒé‡‘äº¤å‰ä¿¡è™Ÿ

æ¶‰åŠæ¨¡çµ„:
â”œâ”€â”€ M06 è³‡æ–™ç®¡ç†æ¨¡çµ„
â”‚   â”œâ”€â”€ åŒæ­¥å°ç©é›»è‚¡åƒ¹ï¼ˆæ‰‹å‹•è§¸ç™¼æˆ–å®šæ™‚ï¼‰
â”‚   â””â”€â”€ å„²å­˜åˆ° stock_prices è¡¨
â”‚
â”œâ”€â”€ M07 æŠ€è¡“åˆ†ææ¨¡çµ„
â”‚   â”œâ”€â”€ è¨ˆç®— MA5, MA20
â”‚   â””â”€â”€ å„²å­˜åˆ° technical_indicators è¡¨
â”‚
â”œâ”€â”€ M13 ä¿¡è™Ÿåˆ¤æ–·å¼•æ“
â”‚   â”œâ”€â”€ åµæ¸¬ MA5 ä¸Šç©¿ MA20ï¼ˆé»ƒé‡‘äº¤å‰ï¼‰
â”‚   â””â”€â”€ ç”¢ç”Ÿ BUY ä¿¡è™Ÿåˆ° signals è¡¨
â”‚
â””â”€â”€ M15 è­¦å ±é€šçŸ¥ç³»çµ±
    â””â”€â”€ ç™¼é€ LINE é€šçŸ¥çµ¦ä½¿ç”¨è€…

API è¨­è¨ˆ:
â”œâ”€â”€ GET  /api/stocks/2330
â”œâ”€â”€ GET  /api/stocks/2330/prices?start_date=2024-01-01&end_date=2024-12-22
â”œâ”€â”€ GET  /api/stocks/2330/indicators?indicator=MA5,MA20
â”œâ”€â”€ GET  /api/signals?stock_id=2330&signal_type=BUY
â””â”€â”€ POST /api/jobs/sync-stock-prices (æ‰‹å‹•è§¸ç™¼è³‡æ–™åŒæ­¥)

è³‡æ–™è¡¨:
â”œâ”€â”€ stocks (è‚¡ç¥¨åŸºæœ¬è³‡æ–™)
â”œâ”€â”€ stock_prices (è‚¡åƒ¹æ­·å²)
â”œâ”€â”€ technical_indicators (æŠ€è¡“æŒ‡æ¨™)
â”œâ”€â”€ signals (ä¿¡è™Ÿ)
â”œâ”€â”€ alert_settings (è­¦å ±è¨­å®š)
â”œâ”€â”€ notifications (é€šçŸ¥è¨˜éŒ„)
â””â”€â”€ job_executions (Job åŸ·è¡Œè¨˜éŒ„)
```

**å‚ç›´åˆ‡ç‰‡çš„å¥½è™•**:
- âœ… å¿«é€Ÿé©—è­‰æ¶æ§‹å¯è¡Œæ€§
- âœ… ç›¡æ—©ç™¼ç¾è¨­è¨ˆå•é¡Œ
- âœ… åœ˜éšŠå¯ä»¥çœ‹åˆ°å¯¦éš›æˆæœ
- âœ… ç‚ºå¾ŒçºŒé–‹ç™¼å»ºç«‹æ¨¡æ¿

---

### åœ˜éšŠå”ä½œå»ºè­°

#### 1 äººé–‹ç™¼
```
Week 1-2: å»ºç«‹å°ˆæ¡ˆéª¨æ¶ + è³‡æ–™åº«è¨­è¨ˆ
Week 3-4: M06 è³‡æ–™ç®¡ç†æ¨¡çµ„ + è³‡æ–™åŒæ­¥
Week 5-6: M07 æŠ€è¡“åˆ†ææ¨¡çµ„ï¼ˆéƒ¨åˆ†æŒ‡æ¨™ï¼‰
Week 7-8: M13 ä¿¡è™Ÿåˆ¤æ–·å¼•æ“ï¼ˆç°¡åŒ–ç‰ˆï¼‰
Week 9-10: M15 è­¦å ±é€šçŸ¥ç³»çµ±ï¼ˆLINE Notifyï¼‰
Week 11-12: å‚ç›´åˆ‡ç‰‡æ•´åˆæ¸¬è©¦
```

#### 2-3 äººåœ˜éšŠ
```
æˆå“¡ A (å¾Œç«¯ Lead):
- å°ˆæ¡ˆæ¶æ§‹å»ºç«‹
- M06 è³‡æ–™ç®¡ç†æ¨¡çµ„
- M13 ä¿¡è™Ÿåˆ¤æ–·å¼•æ“
- çµ±ä¸€å¥‘ç´„æŠŠé—œ

æˆå“¡ B (å¾Œç«¯å·¥ç¨‹å¸«):
- M07 æŠ€è¡“åˆ†ææ¨¡çµ„
- M08 åŸºæœ¬é¢åˆ†ææ¨¡çµ„
- M09 ç±Œç¢¼åˆ†ææ¨¡çµ„

æˆå“¡ C (å‰ç«¯/å…¨ç«¯):
- M15 è­¦å ±é€šçŸ¥ç³»çµ±
- API æ•´åˆ
- å‰ç«¯ä»‹é¢é–‹ç™¼
```

#### 4-5 äººåœ˜éšŠ
```
æˆå“¡ A (å¾Œç«¯ Lead):
- æ¶æ§‹è¨­è¨ˆèˆ‡ Code Review
- æ ¸å¿ƒæ¨¡çµ„é–‹ç™¼
- æŠ€è¡“é›£é¡Œæ”»å …

æˆå“¡ B (å¾Œç«¯å·¥ç¨‹å¸« 1):
- M06 è³‡æ–™ç®¡ç†æ¨¡çµ„
- M07 æŠ€è¡“åˆ†ææ¨¡çµ„

æˆå“¡ C (å¾Œç«¯å·¥ç¨‹å¸« 2):
- M08 åŸºæœ¬é¢åˆ†ææ¨¡çµ„
- M09 ç±Œç¢¼åˆ†ææ¨¡çµ„
- M13 ä¿¡è™Ÿåˆ¤æ–·å¼•æ“

æˆå“¡ D (å‰ç«¯å·¥ç¨‹å¸«):
- Web Dashboard é–‹ç™¼
- API æ•´åˆ
- UI/UX è¨­è¨ˆ

æˆå“¡ E (DevOps/æ¸¬è©¦):
- CI/CD å»ºç½®
- Docker å®¹å™¨åŒ–
- æ¸¬è©¦è‡ªå‹•åŒ–
- ç›£æ§èˆ‡å‘Šè­¦è¨­å®š
```

---

### æ–‡ä»¶ç¶­è­·è¦å‰‡

#### æ›´æ–°è§¸ç™¼æ¢ä»¶
1. **æ¶æ§‹è®Šæ›´**: æ–°å¢/ç§»é™¤æ¨¡çµ„ã€æŠ€è¡“æ£§è®Šæ›´
2. **å¥‘ç´„è®Šæ›´**: Signal Contractã€API è¦ç¯„ã€Job æ¨¡å‹è®Šæ›´
3. **é‡å¤§æ±ºç­–**: é¸å‹è®Šæ›´ã€è¨­è¨ˆæ¨¡å¼èª¿æ•´
4. **æ–°å¢åŠŸèƒ½**: æ–°æ¨¡çµ„ã€æ–°ç‰¹æ€§

#### æ›´æ–°æµç¨‹
```
1. æå‡ºè®Šæ›´éœ€æ±‚ï¼ˆIssue/Discussionï¼‰
   â†“
2. åœ˜éšŠè¨è«–ä¸¦é”æˆå…±è­˜
   â†“
3. æ›´æ–°ç›¸é—œæ–‡ä»¶
   â†“
4. æ–‡ä»¶ Code Review
   â†“
5. Merge åˆ° main åˆ†æ”¯
   â†“
6. é€šçŸ¥æ‰€æœ‰åœ˜éšŠæˆå“¡
```

#### ç‰ˆæœ¬ç®¡ç†
- é‡å¤§è®Šæ›´: å‡ç´šå¤§ç‰ˆæœ¬ï¼ˆv1.0 â†’ v2.0ï¼‰
- åŠŸèƒ½æ–°å¢: å‡ç´šå°ç‰ˆæœ¬ï¼ˆv1.0 â†’ v1.1ï¼‰
- æ–‡å­—ä¿®æ­£: å‡ç´šä¿®è¨‚ç‰ˆæœ¬ï¼ˆv1.1.0 â†’ v1.1.1ï¼‰

---

### é–‹ç™¼æª¢æŸ¥æ¸…å–®

#### é–‹å§‹é–‹ç™¼å‰ âœ“
- [ ] é–±è®€å®Œæ•´ç¸½ç¶±
- [ ] ç†è§£å…¨ç³»çµ±å¥‘ç´„ï¼ˆSignal Contractã€API è¦ç¯„ã€Job æ¨¡å‹ï¼‰
- [ ] ç†Ÿæ‚‰æŠ€è¡“æ£§
- [ ] å»ºç«‹é–‹ç™¼ç’°å¢ƒï¼ˆJDK 17, MySQL, Redisï¼‰
- [ ] å»ºç«‹å°ˆæ¡ˆéª¨æ¶

#### é–‹ç™¼æ¨¡çµ„æ™‚ âœ“
- [ ] é–±è®€å°æ‡‰çš„æ¨¡çµ„æ–‡ä»¶
- [ ] éµå®ˆ Signal Contractï¼ˆå¦‚æœç”¢ç”Ÿä¿¡è™Ÿï¼‰
- [ ] éµå®ˆ API çµ±ä¸€è¦ç¯„
- [ ] éµå®ˆè³‡æ–™åº«å‘½åè¦ç¯„
- [ ] æ’°å¯«å–®å…ƒæ¸¬è©¦ï¼ˆè¦†è“‹ç‡ > 70%ï¼‰
- [ ] æ’°å¯« JavaDoc è¨»è§£
- [ ] éµå®ˆ Git Commit è¦ç¯„

#### Code Review æª¢æŸ¥ âœ“
- [ ] ç¨‹å¼ç¢¼ç¬¦åˆè¦ç¯„
- [ ] é‚è¼¯æ­£ç¢ºæ€§
- [ ] éŒ¯èª¤è™•ç†å®Œæ•´
- [ ] æ¸¬è©¦å……åˆ†
- [ ] æ•ˆèƒ½è€ƒé‡
- [ ] å®‰å…¨æ€§æª¢æŸ¥
- [ ] æ–‡æª”æ›´æ–°

#### ä¸Šç·šå‰æª¢æŸ¥ âœ“
- [ ] æ‰€æœ‰æ¸¬è©¦é€šé
- [ ] API æ–‡æª”æ›´æ–°ï¼ˆSwaggerï¼‰
- [ ] è³‡æ–™åº« Migration Script æº–å‚™
- [ ] ç’°å¢ƒè®Šæ•¸é…ç½®å®Œæˆ
- [ ] ç›£æ§èˆ‡å‘Šè­¦è¨­å®š
- [ ] å‚™ä»½èˆ‡å›æ»¾æ–¹æ¡ˆ
- [ ] ä¸Šç·šå…¬å‘Š

---

### é‡è¦æé†’

#### âš ï¸ å¿…é ˆéµå®ˆçš„è¦ç¯„
1. **Signal Contract**: æ‰€æœ‰ä¿¡è™Ÿå¿…é ˆéµå®ˆçµ±ä¸€æ ¼å¼
2. **API Response æ ¼å¼**: æ‰€æœ‰ API å¿…é ˆè¿”å›çµ±ä¸€æ ¼å¼
3. **Job å†ªç­‰æ€§**: æ‰€æœ‰ Job å¿…é ˆå…·å‚™å†ªç­‰æ€§
4. **è³‡æ–™å“è³ªæª¢æ ¸**: è³‡æ–™å…¥åº«å‰å¿…é ˆé©—è­‰
5. **éŒ¯èª¤è™•ç†**: ä½¿ç”¨çµ±ä¸€çš„éŒ¯èª¤ç¢¼èˆ‡éŒ¯èª¤å›æ‡‰

#### ğŸ’¡ æœ€ä½³å¯¦è¸
1. **å…ˆå¯«æ–‡æª”ï¼Œå†å¯«ç¨‹å¼**: ç¢ºä¿è¨­è¨ˆæ¸…æ™°
2. **å°æ­¥å¿«è·‘**: å‚ç›´åˆ‡ç‰‡ï¼Œå¿«é€Ÿé©—è­‰
3. **æŒçºŒé‡æ§‹**: ç™¼ç¾å•é¡ŒåŠæ™‚å„ªåŒ–
4. **Code Review**: äº’ç›¸å­¸ç¿’ï¼Œæå‡å“è³ª
5. **æ–‡æª”åŒæ­¥**: ç¨‹å¼ç¢¼è®Šæ›´ï¼Œæ–‡æª”åŒæ­¥æ›´æ–°

#### ğŸš« å¸¸è¦‹éŒ¯èª¤
1. âŒ è·³éæ–‡æª”ç›´æ¥å¯«ç¨‹å¼
2. âŒ ä¸éµå®ˆ Signal Contract è‡ªè¡Œå®šç¾©æ ¼å¼
3. âŒ å¿˜è¨˜è™•ç† Job å¤±æ•—é‡è©¦
4. âŒ API è¿”å›æ ¼å¼ä¸ä¸€è‡´
5. âŒ æ•æ„Ÿè³‡è¨Šå¯«æ­»åœ¨ç¨‹å¼ç¢¼
6. âŒ æ²’æœ‰å¯«æ¸¬è©¦
7. âŒ Commit Message éš¨æ„å¯«

---

### è¯çµ¡è³‡è¨Š

**å°ˆæ¡ˆè² è²¬äºº**: [å¾…å¡«å¯«]  
**æŠ€è¡“æ¶æ§‹å¸«**: [å¾…å¡«å¯«]  
**å°ˆæ¡ˆ Repository**: [å¾…å¡«å¯«]  
**æ–‡ä»¶ Repository**: [å¾…å¡«å¯«]  
**Slack Channel**: [å¾…å¡«å¯«]  
**Issue Tracker**: [å¾…å¡«å¯«]  

---

### ç›¸é—œæ–‡ä»¶ç´¢å¼•

**ç¸½ç¶±ç³»åˆ—**:
- 00-ç¸½ç¶±_v01.md
- æœ¬æ–‡ä»¶ï¼ˆæ–‡ä»¶çµæŸï¼‰

**æ¨¡çµ„æ–‡ä»¶ç³»åˆ—** (å¾…æ’°å¯«):
- DOC-01-M06 - è³‡æ–™ç®¡ç†æ¨¡çµ„
- DOC-02-M07 - æŠ€è¡“åˆ†ææ¨¡çµ„
- DOC-03-M08 - åŸºæœ¬é¢åˆ†ææ¨¡çµ„
- DOC-04-M09 - ç±Œç¢¼åˆ†ææ¨¡çµ„
- DOC-05-M10 - æŠ€è¡“å‹æ…‹è¾¨è­˜æ¨¡çµ„
- DOC-06-M11 - é‡åŒ–ç­–ç•¥æ¨¡çµ„
- DOC-07-M12 - ç¸½ç¶“èˆ‡ç”¢æ¥­åˆ†ææ¨¡çµ„
- DOC-08-M13 - ä¿¡è™Ÿåˆ¤æ–·å¼•æ“
- DOC-09-M14 - é¸è‚¡å¼•æ“
- DOC-10-M15 - è­¦å ±é€šçŸ¥ç³»çµ±
- DOC-11-M16 - å›æ¸¬ç³»çµ±
- DOC-12-M17 - é¢¨éšªç®¡ç†æ¨¡çµ„
- DOC-13-M18 - æŠ•è³‡çµ„åˆç®¡ç†

**è³‡æ–™åº«æ–‡ä»¶**:
- DOC-99-è³‡æ–™åº«è¨­è¨ˆç¸½è¡¨

**å…¶ä»–æ–‡ä»¶**:
- README.md - å°ˆæ¡ˆèªªæ˜
- CONTRIBUTING.md - è²¢ç»æŒ‡å—
- CHANGELOG.md - è®Šæ›´æ—¥èªŒ
- API.md - API æ–‡æª”ç¸½è¦½

---

### è‡´è¬

æ„Ÿè¬æ‰€æœ‰åƒèˆ‡æœ¬å°ˆæ¡ˆçš„é–‹ç™¼è€…ã€è¨­è¨ˆå¸«ã€æ¸¬è©¦äººå“¡ã€‚

---

### æˆæ¬Šèˆ‡ç‰ˆæ¬Š

æœ¬æ–‡ä»¶ç‚º **[å°ˆæ¡ˆåç¨±]** å…§éƒ¨æ–‡ä»¶ã€‚  
ç‰ˆæ¬Šæ‰€æœ‰ Â© 2025 [å…¬å¸/åœ˜éšŠåç¨±]  
ä¿ç•™æ‰€æœ‰æ¬Šåˆ©ã€‚

---

**ç¥é–‹ç™¼é †åˆ©ï¼ğŸš€**

---

**æœ€å¾Œæ›´æ–°**: 2025-12-24  
**ä¸‹æ¬¡å¯©æ ¸**: 2026-01-22ï¼ˆæ¯æœˆå¯©æ ¸ä¸€æ¬¡ï¼‰  
**æ–‡ä»¶ç‹€æ…‹**: Draft â†’ Review â†’ Approved â†’ Released  
**ç•¶å‰ç‹€æ…‹**: Draft
